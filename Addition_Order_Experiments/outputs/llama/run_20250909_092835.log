2025-09-09 09:28:35,835 [INFO] ======= Logger initialized =======
2025-09-09 09:28:35,835 [INFO] Log file: ./outputs/llama/run_20250909_092835.log
2025-09-09 09:28:35,877 [INFO] Using device: cuda:0
2025-09-09 09:28:35,877 [INFO] Loading model: /root/autodl-tmp/llama ...
2025-09-09 09:28:44,206 [INFO] Model and tokenizer loaded successfully.
2025-09-09 09:28:44,593 [INFO] [Auto] hidden_states length = 33; probing indices = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:28:44,593 [INFO] Final LAYERS_TO_PROBE for llama: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:28:44,593 [INFO] Determining probe input dimension...
2025-09-09 09:28:44,593 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:28:44,593 [INFO] Target: 10 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:28:44,593 [INFO] Generated final dataset with 30 samples.
2025-09-09 09:28:44,593 [INFO] Final label distribution: {0: 10, 1: 10, 2: 10}
2025-09-09 09:28:44,593 [INFO] [PLACEHOLDER] Extracting activations for 30 prompts, layers=[1]
2025-09-09 09:28:45,627 [INFO] [PLACEHOLDER] Finished extracting activations.
2025-09-09 09:28:45,627 [INFO] Determined fixed probe input dimension: 4096
2025-09-09 09:28:45,627 [INFO] ==================== RUN 1/5 (Seed: 42) ====================
2025-09-09 09:28:45,630 [INFO] Using device: cuda:0
2025-09-09 09:28:45,633 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:28:45,633 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:28:45,635 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:28:45,636 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:28:45,636 [INFO] [TRAIN_COMM_3WAY_Run1] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:29:08,507 [INFO] [TRAIN_COMM_3WAY_Run1] Finished extracting activations.
2025-09-09 09:29:08,510 [INFO] Per-layer classification reports -> ./outputs/llama/run_seed_42/probe_3way_comm_llama_seed_42_20250909_092908.txt
2025-09-09 09:29:08,510 [INFO] --- Starting Probe Training Loop for layers 1..32 ---
2025-09-09 09:29:08,510 [INFO] --- Processing Layer 1 ---
2025-09-09 09:29:08,798 [INFO] Layer 1 - Training completed.
2025-09-09 09:29:08,802 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_1/state_dict.pt
2025-09-09 09:29:08,822 [INFO] Layer 1 - Test Acc: 0.3900 | F1(C0,C1,C2): 0.500, 0.417, 0.000
2025-09-09 09:29:08,822 [INFO] --- Processing Layer 2 ---
2025-09-09 09:29:09,081 [INFO] Layer 2 - Training completed.
2025-09-09 09:29:09,083 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_2/state_dict.pt
2025-09-09 09:29:09,097 [INFO] Layer 2 - Test Acc: 0.6567 | F1(C0,C1,C2): 0.682, 0.658, 0.632
2025-09-09 09:29:09,097 [INFO] --- Processing Layer 3 ---
2025-09-09 09:29:09,355 [INFO] Layer 3 - Training completed.
2025-09-09 09:29:09,356 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_3/state_dict.pt
2025-09-09 09:29:09,370 [INFO] Layer 3 - Test Acc: 0.7733 | F1(C0,C1,C2): 0.806, 0.742, 0.765
2025-09-09 09:29:09,370 [INFO] --- Processing Layer 4 ---
2025-09-09 09:29:09,627 [INFO] Layer 4 - Training completed.
2025-09-09 09:29:09,627 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_4/state_dict.pt
2025-09-09 09:29:09,642 [INFO] Layer 4 - Test Acc: 0.9533 | F1(C0,C1,C2): 0.943, 0.936, 0.980
2025-09-09 09:29:09,642 [INFO] --- Processing Layer 5 ---
2025-09-09 09:29:09,900 [INFO] Layer 5 - Training completed.
2025-09-09 09:29:09,901 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_5/state_dict.pt
2025-09-09 09:29:09,915 [INFO] Layer 5 - Test Acc: 0.9700 | F1(C0,C1,C2): 0.975, 0.969, 0.966
2025-09-09 09:29:09,915 [INFO] --- Processing Layer 6 ---
2025-09-09 09:29:10,176 [INFO] Layer 6 - Training completed.
2025-09-09 09:29:10,177 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_6/state_dict.pt
2025-09-09 09:29:10,191 [INFO] Layer 6 - Test Acc: 0.9500 | F1(C0,C1,C2): 0.937, 0.932, 0.980
2025-09-09 09:29:10,191 [INFO] --- Processing Layer 7 ---
2025-09-09 09:29:10,450 [INFO] Layer 7 - Training completed.
2025-09-09 09:29:10,451 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_7/state_dict.pt
2025-09-09 09:29:10,465 [INFO] Layer 7 - Test Acc: 0.9700 | F1(C0,C1,C2): 0.964, 0.961, 0.985
2025-09-09 09:29:10,465 [INFO] --- Processing Layer 8 ---
2025-09-09 09:29:10,727 [INFO] Layer 8 - Training completed.
2025-09-09 09:29:10,729 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_8/state_dict.pt
2025-09-09 09:29:10,748 [INFO] Layer 8 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.990, 0.985, 0.995
2025-09-09 09:29:10,748 [INFO] --- Processing Layer 9 ---
2025-09-09 09:29:11,005 [INFO] Layer 9 - Training completed.
2025-09-09 09:29:11,005 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_9/state_dict.pt
2025-09-09 09:29:11,019 [INFO] Layer 9 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:29:11,020 [INFO] --- Processing Layer 10 ---
2025-09-09 09:29:11,283 [INFO] Layer 10 - Training completed.
2025-09-09 09:29:11,284 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_10/state_dict.pt
2025-09-09 09:29:11,300 [INFO] Layer 10 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.975, 0.975, 1.000
2025-09-09 09:29:11,300 [INFO] --- Processing Layer 11 ---
2025-09-09 09:29:11,557 [INFO] Layer 11 - Training completed.
2025-09-09 09:29:11,558 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_11/state_dict.pt
2025-09-09 09:29:11,572 [INFO] Layer 11 - Test Acc: 0.9767 | F1(C0,C1,C2): 0.964, 0.966, 1.000
2025-09-09 09:29:11,572 [INFO] --- Processing Layer 12 ---
2025-09-09 09:29:11,837 [INFO] Layer 12 - Training completed.
2025-09-09 09:29:11,838 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_12/state_dict.pt
2025-09-09 09:29:11,851 [INFO] Layer 12 - Test Acc: 0.9733 | F1(C0,C1,C2): 0.959, 0.961, 1.000
2025-09-09 09:29:11,852 [INFO] --- Processing Layer 13 ---
2025-09-09 09:29:12,107 [INFO] Layer 13 - Training completed.
2025-09-09 09:29:12,108 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_13/state_dict.pt
2025-09-09 09:29:12,122 [INFO] Layer 13 - Test Acc: 0.9667 | F1(C0,C1,C2): 0.952, 0.948, 1.000
2025-09-09 09:29:12,122 [INFO] --- Processing Layer 14 ---
2025-09-09 09:29:12,382 [INFO] Layer 14 - Training completed.
2025-09-09 09:29:12,383 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_14/state_dict.pt
2025-09-09 09:29:12,397 [INFO] Layer 14 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.995, 0.990, 0.995
2025-09-09 09:29:12,397 [INFO] --- Processing Layer 15 ---
2025-09-09 09:29:12,658 [INFO] Layer 15 - Training completed.
2025-09-09 09:29:12,659 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_15/state_dict.pt
2025-09-09 09:29:12,673 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:29:12,673 [INFO] --- Processing Layer 16 ---
2025-09-09 09:29:12,936 [INFO] Layer 16 - Training completed.
2025-09-09 09:29:12,937 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_16/state_dict.pt
2025-09-09 09:29:12,951 [INFO] Layer 16 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:29:12,951 [INFO] --- Processing Layer 17 ---
2025-09-09 09:29:13,210 [INFO] Layer 17 - Training completed.
2025-09-09 09:29:13,211 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_17/state_dict.pt
2025-09-09 09:29:13,225 [INFO] Layer 17 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:29:13,225 [INFO] --- Processing Layer 18 ---
2025-09-09 09:29:13,482 [INFO] Layer 18 - Training completed.
2025-09-09 09:29:13,482 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_18/state_dict.pt
2025-09-09 09:29:13,496 [INFO] Layer 18 - Test Acc: 0.9800 | F1(C0,C1,C2): 0.971, 0.969, 1.000
2025-09-09 09:29:13,497 [INFO] --- Processing Layer 19 ---
2025-09-09 09:29:13,759 [INFO] Layer 19 - Training completed.
2025-09-09 09:29:13,759 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_19/state_dict.pt
2025-09-09 09:29:13,773 [INFO] Layer 19 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:29:13,773 [INFO] --- Processing Layer 20 ---
2025-09-09 09:29:14,027 [INFO] Layer 20 - Training completed.
2025-09-09 09:29:14,028 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_20/state_dict.pt
2025-09-09 09:29:14,042 [INFO] Layer 20 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.975, 0.975, 1.000
2025-09-09 09:29:14,042 [INFO] --- Processing Layer 21 ---
2025-09-09 09:29:14,331 [INFO] Layer 21 - Training completed.
2025-09-09 09:29:14,333 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_21/state_dict.pt
2025-09-09 09:29:14,347 [INFO] Layer 21 - Test Acc: 0.9667 | F1(C0,C1,C2): 0.951, 0.948, 1.000
2025-09-09 09:29:14,347 [INFO] --- Processing Layer 22 ---
2025-09-09 09:29:14,603 [INFO] Layer 22 - Training completed.
2025-09-09 09:29:14,604 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_22/state_dict.pt
2025-09-09 09:29:14,617 [INFO] Layer 22 - Test Acc: 0.9800 | F1(C0,C1,C2): 0.970, 0.970, 1.000
2025-09-09 09:29:14,618 [INFO] --- Processing Layer 23 ---
2025-09-09 09:29:14,872 [INFO] Layer 23 - Training completed.
2025-09-09 09:29:14,873 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_23/state_dict.pt
2025-09-09 09:29:14,887 [INFO] Layer 23 - Test Acc: 0.9733 | F1(C0,C1,C2): 0.960, 0.960, 1.000
2025-09-09 09:29:14,888 [INFO] --- Processing Layer 24 ---
2025-09-09 09:29:15,142 [INFO] Layer 24 - Training completed.
2025-09-09 09:29:15,143 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_24/state_dict.pt
2025-09-09 09:29:15,157 [INFO] Layer 24 - Test Acc: 0.9667 | F1(C0,C1,C2): 0.950, 0.949, 1.000
2025-09-09 09:29:15,157 [INFO] --- Processing Layer 25 ---
2025-09-09 09:29:15,414 [INFO] Layer 25 - Training completed.
2025-09-09 09:29:15,415 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_25/state_dict.pt
2025-09-09 09:29:15,428 [INFO] Layer 25 - Test Acc: 0.9600 | F1(C0,C1,C2): 0.941, 0.939, 1.000
2025-09-09 09:29:15,429 [INFO] --- Processing Layer 26 ---
2025-09-09 09:29:15,681 [INFO] Layer 26 - Training completed.
2025-09-09 09:29:15,682 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_26/state_dict.pt
2025-09-09 09:29:15,696 [INFO] Layer 26 - Test Acc: 0.9767 | F1(C0,C1,C2): 0.966, 0.964, 1.000
2025-09-09 09:29:15,696 [INFO] --- Processing Layer 27 ---
2025-09-09 09:29:15,953 [INFO] Layer 27 - Training completed.
2025-09-09 09:29:15,954 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_27/state_dict.pt
2025-09-09 09:29:15,968 [INFO] Layer 27 - Test Acc: 0.9567 | F1(C0,C1,C2): 0.937, 0.933, 1.000
2025-09-09 09:29:15,968 [INFO] --- Processing Layer 28 ---
2025-09-09 09:29:16,225 [INFO] Layer 28 - Training completed.
2025-09-09 09:29:16,226 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_28/state_dict.pt
2025-09-09 09:29:16,240 [INFO] Layer 28 - Test Acc: 0.9533 | F1(C0,C1,C2): 0.932, 0.928, 1.000
2025-09-09 09:29:16,240 [INFO] --- Processing Layer 29 ---
2025-09-09 09:29:16,496 [INFO] Layer 29 - Training completed.
2025-09-09 09:29:16,497 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_29/state_dict.pt
2025-09-09 09:29:16,511 [INFO] Layer 29 - Test Acc: 0.9433 | F1(C0,C1,C2): 0.918, 0.912, 1.000
2025-09-09 09:29:16,511 [INFO] --- Processing Layer 30 ---
2025-09-09 09:29:16,765 [INFO] Layer 30 - Training completed.
2025-09-09 09:29:16,766 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_30/state_dict.pt
2025-09-09 09:29:16,780 [INFO] Layer 30 - Test Acc: 0.9300 | F1(C0,C1,C2): 0.900, 0.889, 1.000
2025-09-09 09:29:16,780 [INFO] --- Processing Layer 31 ---
2025-09-09 09:29:17,039 [INFO] Layer 31 - Training completed.
2025-09-09 09:29:17,040 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_31/state_dict.pt
2025-09-09 09:29:17,054 [INFO] Layer 31 - Test Acc: 0.9367 | F1(C0,C1,C2): 0.908, 0.902, 1.000
2025-09-09 09:29:17,054 [INFO] --- Processing Layer 32 ---
2025-09-09 09:29:17,310 [INFO] Layer 32 - Training completed.
2025-09-09 09:29:17,310 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_42/layer_32/state_dict.pt
2025-09-09 09:29:17,326 [INFO] Layer 32 - Test Acc: 0.8733 | F1(C0,C1,C2): 0.839, 0.768, 1.000
2025-09-09 09:29:17,326 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:29:17,326 [INFO] --- Generating OOD Datasets for Run 1 ---
2025-09-09 09:29:17,331 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:29:17,333 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:29:17,375 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:29:21,881 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:29:21,887 [INFO] [OOD 1d] Layer 1: acc=0.3333
2025-09-09 09:29:21,889 [INFO] [OOD 1d] Layer 2: acc=0.3700
2025-09-09 09:29:21,891 [INFO] [OOD 1d] Layer 3: acc=0.3333
2025-09-09 09:29:21,893 [INFO] [OOD 1d] Layer 4: acc=0.5467
2025-09-09 09:29:21,894 [INFO] [OOD 1d] Layer 5: acc=0.3600
2025-09-09 09:29:21,896 [INFO] [OOD 1d] Layer 6: acc=0.6233
2025-09-09 09:29:21,898 [INFO] [OOD 1d] Layer 7: acc=0.5267
2025-09-09 09:29:21,899 [INFO] [OOD 1d] Layer 8: acc=0.9600
2025-09-09 09:29:21,901 [INFO] [OOD 1d] Layer 9: acc=0.9167
2025-09-09 09:29:21,902 [INFO] [OOD 1d] Layer 10: acc=0.8900
2025-09-09 09:29:21,904 [INFO] [OOD 1d] Layer 11: acc=0.7867
2025-09-09 09:29:21,906 [INFO] [OOD 1d] Layer 12: acc=0.8400
2025-09-09 09:29:21,907 [INFO] [OOD 1d] Layer 13: acc=0.9533
2025-09-09 09:29:21,909 [INFO] [OOD 1d] Layer 14: acc=1.0000
2025-09-09 09:29:21,911 [INFO] [OOD 1d] Layer 15: acc=1.0000
2025-09-09 09:29:21,912 [INFO] [OOD 1d] Layer 16: acc=0.9633
2025-09-09 09:29:21,914 [INFO] [OOD 1d] Layer 17: acc=1.0000
2025-09-09 09:29:21,915 [INFO] [OOD 1d] Layer 18: acc=0.8767
2025-09-09 09:29:21,917 [INFO] [OOD 1d] Layer 19: acc=0.8400
2025-09-09 09:29:21,919 [INFO] [OOD 1d] Layer 20: acc=0.9000
2025-09-09 09:29:21,920 [INFO] [OOD 1d] Layer 21: acc=0.9333
2025-09-09 09:29:21,922 [INFO] [OOD 1d] Layer 22: acc=0.9433
2025-09-09 09:29:21,923 [INFO] [OOD 1d] Layer 23: acc=0.9633
2025-09-09 09:29:21,925 [INFO] [OOD 1d] Layer 24: acc=0.9600
2025-09-09 09:29:21,926 [INFO] [OOD 1d] Layer 25: acc=0.9567
2025-09-09 09:29:21,928 [INFO] [OOD 1d] Layer 26: acc=0.8867
2025-09-09 09:29:21,930 [INFO] [OOD 1d] Layer 27: acc=0.9133
2025-09-09 09:29:21,931 [INFO] [OOD 1d] Layer 28: acc=0.9033
2025-09-09 09:29:21,933 [INFO] [OOD 1d] Layer 29: acc=0.9033
2025-09-09 09:29:21,935 [INFO] [OOD 1d] Layer 30: acc=0.9067
2025-09-09 09:29:21,936 [INFO] [OOD 1d] Layer 31: acc=0.9067
2025-09-09 09:29:21,938 [INFO] [OOD 1d] Layer 32: acc=0.7733
2025-09-09 09:29:21,938 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:29:25,052 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:29:25,055 [INFO] [OOD 2d] Layer 1: acc=0.6550
2025-09-09 09:29:25,056 [INFO] [OOD 2d] Layer 2: acc=0.7100
2025-09-09 09:29:25,057 [INFO] [OOD 2d] Layer 3: acc=0.7800
2025-09-09 09:29:25,059 [INFO] [OOD 2d] Layer 4: acc=0.9450
2025-09-09 09:29:25,060 [INFO] [OOD 2d] Layer 5: acc=0.9600
2025-09-09 09:29:25,061 [INFO] [OOD 2d] Layer 6: acc=0.9400
2025-09-09 09:29:25,062 [INFO] [OOD 2d] Layer 7: acc=0.9400
2025-09-09 09:29:25,063 [INFO] [OOD 2d] Layer 8: acc=0.9850
2025-09-09 09:29:25,065 [INFO] [OOD 2d] Layer 9: acc=0.9850
2025-09-09 09:29:25,066 [INFO] [OOD 2d] Layer 10: acc=0.9900
2025-09-09 09:29:25,067 [INFO] [OOD 2d] Layer 11: acc=0.9650
2025-09-09 09:29:25,069 [INFO] [OOD 2d] Layer 12: acc=0.9750
2025-09-09 09:29:25,070 [INFO] [OOD 2d] Layer 13: acc=0.9600
2025-09-09 09:29:25,071 [INFO] [OOD 2d] Layer 14: acc=1.0000
2025-09-09 09:29:25,073 [INFO] [OOD 2d] Layer 15: acc=1.0000
2025-09-09 09:29:25,074 [INFO] [OOD 2d] Layer 16: acc=0.9950
2025-09-09 09:29:25,075 [INFO] [OOD 2d] Layer 17: acc=0.9900
2025-09-09 09:29:25,076 [INFO] [OOD 2d] Layer 18: acc=0.9900
2025-09-09 09:29:25,078 [INFO] [OOD 2d] Layer 19: acc=0.9850
2025-09-09 09:29:25,079 [INFO] [OOD 2d] Layer 20: acc=0.9850
2025-09-09 09:29:25,080 [INFO] [OOD 2d] Layer 21: acc=0.9850
2025-09-09 09:29:25,081 [INFO] [OOD 2d] Layer 22: acc=0.9800
2025-09-09 09:29:25,082 [INFO] [OOD 2d] Layer 23: acc=0.9700
2025-09-09 09:29:25,084 [INFO] [OOD 2d] Layer 24: acc=0.9850
2025-09-09 09:29:25,085 [INFO] [OOD 2d] Layer 25: acc=0.9750
2025-09-09 09:29:25,086 [INFO] [OOD 2d] Layer 26: acc=0.9850
2025-09-09 09:29:25,087 [INFO] [OOD 2d] Layer 27: acc=0.9700
2025-09-09 09:29:25,089 [INFO] [OOD 2d] Layer 28: acc=0.9650
2025-09-09 09:29:25,090 [INFO] [OOD 2d] Layer 29: acc=0.9550
2025-09-09 09:29:25,091 [INFO] [OOD 2d] Layer 30: acc=0.9550
2025-09-09 09:29:25,093 [INFO] [OOD 2d] Layer 31: acc=0.9550
2025-09-09 09:29:25,094 [INFO] [OOD 2d] Layer 32: acc=0.8650
2025-09-09 09:29:25,094 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:29:29,616 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:29:29,619 [INFO] [OOD 3d] Layer 1: acc=0.3333
2025-09-09 09:29:29,620 [INFO] [OOD 3d] Layer 2: acc=0.4700
2025-09-09 09:29:29,622 [INFO] [OOD 3d] Layer 3: acc=0.6033
2025-09-09 09:29:29,623 [INFO] [OOD 3d] Layer 4: acc=0.6867
2025-09-09 09:29:29,625 [INFO] [OOD 3d] Layer 5: acc=0.6667
2025-09-09 09:29:29,627 [INFO] [OOD 3d] Layer 6: acc=0.7267
2025-09-09 09:29:29,628 [INFO] [OOD 3d] Layer 7: acc=0.9033
2025-09-09 09:29:29,630 [INFO] [OOD 3d] Layer 8: acc=0.8033
2025-09-09 09:29:29,631 [INFO] [OOD 3d] Layer 9: acc=0.9333
2025-09-09 09:29:29,633 [INFO] [OOD 3d] Layer 10: acc=0.9367
2025-09-09 09:29:29,635 [INFO] [OOD 3d] Layer 11: acc=0.9300
2025-09-09 09:29:29,637 [INFO] [OOD 3d] Layer 12: acc=0.9533
2025-09-09 09:29:29,638 [INFO] [OOD 3d] Layer 13: acc=0.8633
2025-09-09 09:29:29,639 [INFO] [OOD 3d] Layer 14: acc=0.9967
2025-09-09 09:29:29,641 [INFO] [OOD 3d] Layer 15: acc=1.0000
2025-09-09 09:29:29,643 [INFO] [OOD 3d] Layer 16: acc=0.9333
2025-09-09 09:29:29,645 [INFO] [OOD 3d] Layer 17: acc=0.8200
2025-09-09 09:29:29,646 [INFO] [OOD 3d] Layer 18: acc=0.7933
2025-09-09 09:29:29,648 [INFO] [OOD 3d] Layer 19: acc=0.8500
2025-09-09 09:29:29,649 [INFO] [OOD 3d] Layer 20: acc=0.8300
2025-09-09 09:29:29,651 [INFO] [OOD 3d] Layer 21: acc=0.7700
2025-09-09 09:29:29,653 [INFO] [OOD 3d] Layer 22: acc=0.7567
2025-09-09 09:29:29,654 [INFO] [OOD 3d] Layer 23: acc=0.7633
2025-09-09 09:29:29,655 [INFO] [OOD 3d] Layer 24: acc=0.7333
2025-09-09 09:29:29,657 [INFO] [OOD 3d] Layer 25: acc=0.7833
2025-09-09 09:29:29,659 [INFO] [OOD 3d] Layer 26: acc=0.7933
2025-09-09 09:29:29,661 [INFO] [OOD 3d] Layer 27: acc=0.7733
2025-09-09 09:29:29,662 [INFO] [OOD 3d] Layer 28: acc=0.8300
2025-09-09 09:29:29,664 [INFO] [OOD 3d] Layer 29: acc=0.8100
2025-09-09 09:29:29,665 [INFO] [OOD 3d] Layer 30: acc=0.8033
2025-09-09 09:29:29,667 [INFO] [OOD 3d] Layer 31: acc=0.7700
2025-09-09 09:29:29,669 [INFO] [OOD 3d] Layer 32: acc=0.6367
2025-09-09 09:29:29,669 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:29:35,234 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:29:35,237 [INFO] [OOD 4d] Layer 1: acc=0.3667
2025-09-09 09:29:35,239 [INFO] [OOD 4d] Layer 2: acc=0.3433
2025-09-09 09:29:35,240 [INFO] [OOD 4d] Layer 3: acc=0.4867
2025-09-09 09:29:35,242 [INFO] [OOD 4d] Layer 4: acc=0.6700
2025-09-09 09:29:35,243 [INFO] [OOD 4d] Layer 5: acc=0.6667
2025-09-09 09:29:35,245 [INFO] [OOD 4d] Layer 6: acc=0.6667
2025-09-09 09:29:35,247 [INFO] [OOD 4d] Layer 7: acc=0.8033
2025-09-09 09:29:35,249 [INFO] [OOD 4d] Layer 8: acc=0.6800
2025-09-09 09:29:35,250 [INFO] [OOD 4d] Layer 9: acc=0.8233
2025-09-09 09:29:35,252 [INFO] [OOD 4d] Layer 10: acc=0.6533
2025-09-09 09:29:35,253 [INFO] [OOD 4d] Layer 11: acc=0.8167
2025-09-09 09:29:35,255 [INFO] [OOD 4d] Layer 12: acc=0.9533
2025-09-09 09:29:35,256 [INFO] [OOD 4d] Layer 13: acc=0.9367
2025-09-09 09:29:35,258 [INFO] [OOD 4d] Layer 14: acc=0.9933
2025-09-09 09:29:35,259 [INFO] [OOD 4d] Layer 15: acc=0.9433
2025-09-09 09:29:35,261 [INFO] [OOD 4d] Layer 16: acc=0.8900
2025-09-09 09:29:35,263 [INFO] [OOD 4d] Layer 17: acc=0.8133
2025-09-09 09:29:35,264 [INFO] [OOD 4d] Layer 18: acc=0.8000
2025-09-09 09:29:35,266 [INFO] [OOD 4d] Layer 19: acc=0.8467
2025-09-09 09:29:35,267 [INFO] [OOD 4d] Layer 20: acc=0.8333
2025-09-09 09:29:35,269 [INFO] [OOD 4d] Layer 21: acc=0.8133
2025-09-09 09:29:35,270 [INFO] [OOD 4d] Layer 22: acc=0.7567
2025-09-09 09:29:35,272 [INFO] [OOD 4d] Layer 23: acc=0.7267
2025-09-09 09:29:35,274 [INFO] [OOD 4d] Layer 24: acc=0.6900
2025-09-09 09:29:35,275 [INFO] [OOD 4d] Layer 25: acc=0.6733
2025-09-09 09:29:35,277 [INFO] [OOD 4d] Layer 26: acc=0.6833
2025-09-09 09:29:35,278 [INFO] [OOD 4d] Layer 27: acc=0.6867
2025-09-09 09:29:35,280 [INFO] [OOD 4d] Layer 28: acc=0.6900
2025-09-09 09:29:35,282 [INFO] [OOD 4d] Layer 29: acc=0.6767
2025-09-09 09:29:35,283 [INFO] [OOD 4d] Layer 30: acc=0.7133
2025-09-09 09:29:35,285 [INFO] [OOD 4d] Layer 31: acc=0.6900
2025-09-09 09:29:35,287 [INFO] [OOD 4d] Layer 32: acc=0.5133
2025-09-09 09:29:35,287 [INFO] ==================== RUN 2/5 (Seed: 43) ====================
2025-09-09 09:29:35,288 [INFO] Using device: cuda:0
2025-09-09 09:29:35,291 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:29:35,291 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:29:35,294 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:29:35,294 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:29:35,295 [INFO] [TRAIN_COMM_3WAY_Run2] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:29:58,005 [INFO] [TRAIN_COMM_3WAY_Run2] Finished extracting activations.
2025-09-09 09:29:58,007 [INFO] Per-layer classification reports -> ./outputs/llama/run_seed_43/probe_3way_comm_llama_seed_43_20250909_092958.txt
2025-09-09 09:29:58,007 [INFO] --- Starting Probe Training Loop for layers 1..32 ---
2025-09-09 09:29:58,008 [INFO] --- Processing Layer 1 ---
2025-09-09 09:29:58,274 [INFO] Layer 1 - Training completed.
2025-09-09 09:29:58,276 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_1/state_dict.pt
2025-09-09 09:29:58,290 [INFO] Layer 1 - Test Acc: 0.3267 | F1(C0,C1,C2): 0.138, 0.000, 0.471
2025-09-09 09:29:58,290 [INFO] --- Processing Layer 2 ---
2025-09-09 09:29:58,551 [INFO] Layer 2 - Training completed.
2025-09-09 09:29:58,551 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_2/state_dict.pt
2025-09-09 09:29:58,565 [INFO] Layer 2 - Test Acc: 0.5767 | F1(C0,C1,C2): 0.667, 0.651, 0.268
2025-09-09 09:29:58,565 [INFO] --- Processing Layer 3 ---
2025-09-09 09:29:58,824 [INFO] Layer 3 - Training completed.
2025-09-09 09:29:58,825 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_3/state_dict.pt
2025-09-09 09:29:58,839 [INFO] Layer 3 - Test Acc: 0.8800 | F1(C0,C1,C2): 0.877, 0.879, 0.884
2025-09-09 09:29:58,839 [INFO] --- Processing Layer 4 ---
2025-09-09 09:29:59,099 [INFO] Layer 4 - Training completed.
2025-09-09 09:29:59,100 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_4/state_dict.pt
2025-09-09 09:29:59,113 [INFO] Layer 4 - Test Acc: 0.9567 | F1(C0,C1,C2): 0.940, 0.939, 0.990
2025-09-09 09:29:59,114 [INFO] --- Processing Layer 5 ---
2025-09-09 09:29:59,383 [INFO] Layer 5 - Training completed.
2025-09-09 09:29:59,385 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_5/state_dict.pt
2025-09-09 09:29:59,398 [INFO] Layer 5 - Test Acc: 0.9800 | F1(C0,C1,C2): 0.970, 0.980, 0.990
2025-09-09 09:29:59,399 [INFO] --- Processing Layer 6 ---
2025-09-09 09:29:59,656 [INFO] Layer 6 - Training completed.
2025-09-09 09:29:59,657 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_6/state_dict.pt
2025-09-09 09:29:59,671 [INFO] Layer 6 - Test Acc: 0.9433 | F1(C0,C1,C2): 0.907, 0.926, 0.995
2025-09-09 09:29:59,671 [INFO] --- Processing Layer 7 ---
2025-09-09 09:29:59,927 [INFO] Layer 7 - Training completed.
2025-09-09 09:29:59,928 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_7/state_dict.pt
2025-09-09 09:29:59,942 [INFO] Layer 7 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.975, 0.985, 0.990
2025-09-09 09:29:59,942 [INFO] --- Processing Layer 8 ---
2025-09-09 09:30:00,201 [INFO] Layer 8 - Training completed.
2025-09-09 09:30:00,202 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_8/state_dict.pt
2025-09-09 09:30:00,215 [INFO] Layer 8 - Test Acc: 0.9700 | F1(C0,C1,C2): 0.953, 0.962, 0.995
2025-09-09 09:30:00,216 [INFO] --- Processing Layer 9 ---
2025-09-09 09:30:00,473 [INFO] Layer 9 - Training completed.
2025-09-09 09:30:00,474 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_9/state_dict.pt
2025-09-09 09:30:00,488 [INFO] Layer 9 - Test Acc: 0.9667 | F1(C0,C1,C2): 0.947, 0.957, 0.995
2025-09-09 09:30:00,488 [INFO] --- Processing Layer 10 ---
2025-09-09 09:30:00,743 [INFO] Layer 10 - Training completed.
2025-09-09 09:30:00,744 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_10/state_dict.pt
2025-09-09 09:30:00,758 [INFO] Layer 10 - Test Acc: 0.9800 | F1(C0,C1,C2): 0.971, 0.969, 1.000
2025-09-09 09:30:00,758 [INFO] --- Processing Layer 11 ---
2025-09-09 09:30:01,023 [INFO] Layer 11 - Training completed.
2025-09-09 09:30:01,024 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_11/state_dict.pt
2025-09-09 09:30:01,039 [INFO] Layer 11 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.980, 1.000
2025-09-09 09:30:01,039 [INFO] --- Processing Layer 12 ---
2025-09-09 09:30:01,298 [INFO] Layer 12 - Training completed.
2025-09-09 09:30:01,299 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_12/state_dict.pt
2025-09-09 09:30:01,313 [INFO] Layer 12 - Test Acc: 0.9767 | F1(C0,C1,C2): 0.964, 0.966, 1.000
2025-09-09 09:30:01,313 [INFO] --- Processing Layer 13 ---
2025-09-09 09:30:01,572 [INFO] Layer 13 - Training completed.
2025-09-09 09:30:01,573 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_13/state_dict.pt
2025-09-09 09:30:01,587 [INFO] Layer 13 - Test Acc: 0.9800 | F1(C0,C1,C2): 0.969, 0.971, 1.000
2025-09-09 09:30:01,587 [INFO] --- Processing Layer 14 ---
2025-09-09 09:30:01,846 [INFO] Layer 14 - Training completed.
2025-09-09 09:30:01,847 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_14/state_dict.pt
2025-09-09 09:30:01,861 [INFO] Layer 14 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:30:01,861 [INFO] --- Processing Layer 15 ---
2025-09-09 09:30:02,140 [INFO] Layer 15 - Training completed.
2025-09-09 09:30:02,141 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_15/state_dict.pt
2025-09-09 09:30:02,155 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:30:02,155 [INFO] --- Processing Layer 16 ---
2025-09-09 09:30:02,414 [INFO] Layer 16 - Training completed.
2025-09-09 09:30:02,415 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_16/state_dict.pt
2025-09-09 09:30:02,429 [INFO] Layer 16 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:30:02,429 [INFO] --- Processing Layer 17 ---
2025-09-09 09:30:02,687 [INFO] Layer 17 - Training completed.
2025-09-09 09:30:02,689 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_17/state_dict.pt
2025-09-09 09:30:02,703 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:30:02,703 [INFO] --- Processing Layer 18 ---
2025-09-09 09:30:02,962 [INFO] Layer 18 - Training completed.
2025-09-09 09:30:02,963 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_18/state_dict.pt
2025-09-09 09:30:02,977 [INFO] Layer 18 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:30:02,977 [INFO] --- Processing Layer 19 ---
2025-09-09 09:30:03,236 [INFO] Layer 19 - Training completed.
2025-09-09 09:30:03,237 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_19/state_dict.pt
2025-09-09 09:30:03,251 [INFO] Layer 19 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:30:03,251 [INFO] --- Processing Layer 20 ---
2025-09-09 09:30:03,507 [INFO] Layer 20 - Training completed.
2025-09-09 09:30:03,508 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_20/state_dict.pt
2025-09-09 09:30:03,522 [INFO] Layer 20 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:30:03,522 [INFO] --- Processing Layer 21 ---
2025-09-09 09:30:03,778 [INFO] Layer 21 - Training completed.
2025-09-09 09:30:03,779 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_21/state_dict.pt
2025-09-09 09:30:03,793 [INFO] Layer 21 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:30:03,793 [INFO] --- Processing Layer 22 ---
2025-09-09 09:30:04,051 [INFO] Layer 22 - Training completed.
2025-09-09 09:30:04,052 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_22/state_dict.pt
2025-09-09 09:30:04,066 [INFO] Layer 22 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.980, 1.000
2025-09-09 09:30:04,066 [INFO] --- Processing Layer 23 ---
2025-09-09 09:30:04,325 [INFO] Layer 23 - Training completed.
2025-09-09 09:30:04,326 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_23/state_dict.pt
2025-09-09 09:30:04,339 [INFO] Layer 23 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:30:04,339 [INFO] --- Processing Layer 24 ---
2025-09-09 09:30:04,597 [INFO] Layer 24 - Training completed.
2025-09-09 09:30:04,598 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_24/state_dict.pt
2025-09-09 09:30:04,611 [INFO] Layer 24 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.980, 1.000
2025-09-09 09:30:04,612 [INFO] --- Processing Layer 25 ---
2025-09-09 09:30:04,914 [INFO] Layer 25 - Training completed.
2025-09-09 09:30:04,914 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_25/state_dict.pt
2025-09-09 09:30:04,928 [INFO] Layer 25 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.975, 0.975, 1.000
2025-09-09 09:30:04,929 [INFO] --- Processing Layer 26 ---
2025-09-09 09:30:05,193 [INFO] Layer 26 - Training completed.
2025-09-09 09:30:05,194 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_26/state_dict.pt
2025-09-09 09:30:05,207 [INFO] Layer 26 - Test Acc: 0.9800 | F1(C0,C1,C2): 0.969, 0.971, 1.000
2025-09-09 09:30:05,207 [INFO] --- Processing Layer 27 ---
2025-09-09 09:30:05,466 [INFO] Layer 27 - Training completed.
2025-09-09 09:30:05,467 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_27/state_dict.pt
2025-09-09 09:30:05,481 [INFO] Layer 27 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.980, 1.000
2025-09-09 09:30:05,481 [INFO] --- Processing Layer 28 ---
2025-09-09 09:30:05,739 [INFO] Layer 28 - Training completed.
2025-09-09 09:30:05,740 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_28/state_dict.pt
2025-09-09 09:30:05,754 [INFO] Layer 28 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.975, 0.975, 1.000
2025-09-09 09:30:05,754 [INFO] --- Processing Layer 29 ---
2025-09-09 09:30:06,010 [INFO] Layer 29 - Training completed.
2025-09-09 09:30:06,011 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_29/state_dict.pt
2025-09-09 09:30:06,025 [INFO] Layer 29 - Test Acc: 0.9733 | F1(C0,C1,C2): 0.960, 0.960, 1.000
2025-09-09 09:30:06,025 [INFO] --- Processing Layer 30 ---
2025-09-09 09:30:06,286 [INFO] Layer 30 - Training completed.
2025-09-09 09:30:06,287 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_30/state_dict.pt
2025-09-09 09:30:06,301 [INFO] Layer 30 - Test Acc: 0.9533 | F1(C0,C1,C2): 0.926, 0.934, 1.000
2025-09-09 09:30:06,301 [INFO] --- Processing Layer 31 ---
2025-09-09 09:30:06,559 [INFO] Layer 31 - Training completed.
2025-09-09 09:30:06,560 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_31/state_dict.pt
2025-09-09 09:30:06,573 [INFO] Layer 31 - Test Acc: 0.9633 | F1(C0,C1,C2): 0.944, 0.946, 1.000
2025-09-09 09:30:06,574 [INFO] --- Processing Layer 32 ---
2025-09-09 09:30:06,832 [INFO] Layer 32 - Training completed.
2025-09-09 09:30:06,833 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_43/layer_32/state_dict.pt
2025-09-09 09:30:06,847 [INFO] Layer 32 - Test Acc: 0.9500 | F1(C0,C1,C2): 0.925, 0.925, 1.000
2025-09-09 09:30:06,847 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:30:06,847 [INFO] --- Generating OOD Datasets for Run 2 ---
2025-09-09 09:30:06,853 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:30:06,854 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:30:06,895 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:30:11,411 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:30:11,414 [INFO] [OOD 1d] Layer 1: acc=0.3333
2025-09-09 09:30:11,415 [INFO] [OOD 1d] Layer 2: acc=0.3700
2025-09-09 09:30:11,417 [INFO] [OOD 1d] Layer 3: acc=0.5700
2025-09-09 09:30:11,419 [INFO] [OOD 1d] Layer 4: acc=0.6167
2025-09-09 09:30:11,420 [INFO] [OOD 1d] Layer 5: acc=0.5500
2025-09-09 09:30:11,422 [INFO] [OOD 1d] Layer 6: acc=0.7567
2025-09-09 09:30:11,423 [INFO] [OOD 1d] Layer 7: acc=0.7300
2025-09-09 09:30:11,425 [INFO] [OOD 1d] Layer 8: acc=0.9533
2025-09-09 09:30:11,427 [INFO] [OOD 1d] Layer 9: acc=0.9433
2025-09-09 09:30:11,428 [INFO] [OOD 1d] Layer 10: acc=0.9867
2025-09-09 09:30:11,430 [INFO] [OOD 1d] Layer 11: acc=0.8633
2025-09-09 09:30:11,431 [INFO] [OOD 1d] Layer 12: acc=0.8500
2025-09-09 09:30:11,433 [INFO] [OOD 1d] Layer 13: acc=0.9333
2025-09-09 09:30:11,435 [INFO] [OOD 1d] Layer 14: acc=1.0000
2025-09-09 09:30:11,436 [INFO] [OOD 1d] Layer 15: acc=1.0000
2025-09-09 09:30:11,438 [INFO] [OOD 1d] Layer 16: acc=0.9900
2025-09-09 09:30:11,439 [INFO] [OOD 1d] Layer 17: acc=1.0000
2025-09-09 09:30:11,441 [INFO] [OOD 1d] Layer 18: acc=0.8800
2025-09-09 09:30:11,443 [INFO] [OOD 1d] Layer 19: acc=0.9700
2025-09-09 09:30:11,445 [INFO] [OOD 1d] Layer 20: acc=0.9467
2025-09-09 09:30:11,446 [INFO] [OOD 1d] Layer 21: acc=0.8767
2025-09-09 09:30:11,447 [INFO] [OOD 1d] Layer 22: acc=0.9300
2025-09-09 09:30:11,449 [INFO] [OOD 1d] Layer 23: acc=0.9233
2025-09-09 09:30:11,451 [INFO] [OOD 1d] Layer 24: acc=0.9467
2025-09-09 09:30:11,452 [INFO] [OOD 1d] Layer 25: acc=0.9733
2025-09-09 09:30:11,454 [INFO] [OOD 1d] Layer 26: acc=0.8567
2025-09-09 09:30:11,455 [INFO] [OOD 1d] Layer 27: acc=0.7600
2025-09-09 09:30:11,457 [INFO] [OOD 1d] Layer 28: acc=0.9133
2025-09-09 09:30:11,459 [INFO] [OOD 1d] Layer 29: acc=0.9000
2025-09-09 09:30:11,461 [INFO] [OOD 1d] Layer 30: acc=0.7567
2025-09-09 09:30:11,462 [INFO] [OOD 1d] Layer 31: acc=0.7633
2025-09-09 09:30:11,463 [INFO] [OOD 1d] Layer 32: acc=0.8267
2025-09-09 09:30:11,464 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:30:14,583 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:30:14,586 [INFO] [OOD 2d] Layer 1: acc=0.0550
2025-09-09 09:30:14,587 [INFO] [OOD 2d] Layer 2: acc=0.8250
2025-09-09 09:30:14,588 [INFO] [OOD 2d] Layer 3: acc=0.9300
2025-09-09 09:30:14,590 [INFO] [OOD 2d] Layer 4: acc=0.9650
2025-09-09 09:30:14,591 [INFO] [OOD 2d] Layer 5: acc=0.9800
2025-09-09 09:30:14,592 [INFO] [OOD 2d] Layer 6: acc=0.9500
2025-09-09 09:30:14,594 [INFO] [OOD 2d] Layer 7: acc=0.9950
2025-09-09 09:30:14,595 [INFO] [OOD 2d] Layer 8: acc=0.9800
2025-09-09 09:30:14,596 [INFO] [OOD 2d] Layer 9: acc=0.9800
2025-09-09 09:30:14,597 [INFO] [OOD 2d] Layer 10: acc=0.9800
2025-09-09 09:30:14,598 [INFO] [OOD 2d] Layer 11: acc=0.9950
2025-09-09 09:30:14,600 [INFO] [OOD 2d] Layer 12: acc=0.9850
2025-09-09 09:30:14,601 [INFO] [OOD 2d] Layer 13: acc=0.9900
2025-09-09 09:30:14,602 [INFO] [OOD 2d] Layer 14: acc=1.0000
2025-09-09 09:30:14,603 [INFO] [OOD 2d] Layer 15: acc=1.0000
2025-09-09 09:30:14,605 [INFO] [OOD 2d] Layer 16: acc=0.9850
2025-09-09 09:30:14,606 [INFO] [OOD 2d] Layer 17: acc=0.9950
2025-09-09 09:30:14,607 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:30:14,609 [INFO] [OOD 2d] Layer 19: acc=0.9950
2025-09-09 09:30:14,610 [INFO] [OOD 2d] Layer 20: acc=0.9950
2025-09-09 09:30:14,611 [INFO] [OOD 2d] Layer 21: acc=0.9900
2025-09-09 09:30:14,613 [INFO] [OOD 2d] Layer 22: acc=0.9850
2025-09-09 09:30:14,614 [INFO] [OOD 2d] Layer 23: acc=0.9850
2025-09-09 09:30:14,615 [INFO] [OOD 2d] Layer 24: acc=0.9850
2025-09-09 09:30:14,616 [INFO] [OOD 2d] Layer 25: acc=0.9900
2025-09-09 09:30:14,617 [INFO] [OOD 2d] Layer 26: acc=0.9850
2025-09-09 09:30:14,619 [INFO] [OOD 2d] Layer 27: acc=0.9900
2025-09-09 09:30:14,620 [INFO] [OOD 2d] Layer 28: acc=0.9850
2025-09-09 09:30:14,621 [INFO] [OOD 2d] Layer 29: acc=0.9850
2025-09-09 09:30:14,622 [INFO] [OOD 2d] Layer 30: acc=0.9800
2025-09-09 09:30:14,624 [INFO] [OOD 2d] Layer 31: acc=0.9800
2025-09-09 09:30:14,625 [INFO] [OOD 2d] Layer 32: acc=0.9600
2025-09-09 09:30:14,625 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:30:19,113 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:30:19,116 [INFO] [OOD 3d] Layer 1: acc=0.3000
2025-09-09 09:30:19,117 [INFO] [OOD 3d] Layer 2: acc=0.4867
2025-09-09 09:30:19,119 [INFO] [OOD 3d] Layer 3: acc=0.7533
2025-09-09 09:30:19,121 [INFO] [OOD 3d] Layer 4: acc=0.6667
2025-09-09 09:30:19,122 [INFO] [OOD 3d] Layer 5: acc=0.6700
2025-09-09 09:30:19,124 [INFO] [OOD 3d] Layer 6: acc=0.7567
2025-09-09 09:30:19,125 [INFO] [OOD 3d] Layer 7: acc=0.7333
2025-09-09 09:30:19,127 [INFO] [OOD 3d] Layer 8: acc=0.9033
2025-09-09 09:30:19,129 [INFO] [OOD 3d] Layer 9: acc=0.9233
2025-09-09 09:30:19,130 [INFO] [OOD 3d] Layer 10: acc=0.9333
2025-09-09 09:30:19,132 [INFO] [OOD 3d] Layer 11: acc=0.9400
2025-09-09 09:30:19,133 [INFO] [OOD 3d] Layer 12: acc=0.9233
2025-09-09 09:30:19,135 [INFO] [OOD 3d] Layer 13: acc=0.9467
2025-09-09 09:30:19,137 [INFO] [OOD 3d] Layer 14: acc=0.9967
2025-09-09 09:30:19,138 [INFO] [OOD 3d] Layer 15: acc=0.9967
2025-09-09 09:30:19,140 [INFO] [OOD 3d] Layer 16: acc=0.9233
2025-09-09 09:30:19,142 [INFO] [OOD 3d] Layer 17: acc=0.8133
2025-09-09 09:30:19,143 [INFO] [OOD 3d] Layer 18: acc=0.8200
2025-09-09 09:30:19,145 [INFO] [OOD 3d] Layer 19: acc=0.8133
2025-09-09 09:30:19,146 [INFO] [OOD 3d] Layer 20: acc=0.8267
2025-09-09 09:30:19,148 [INFO] [OOD 3d] Layer 21: acc=0.7767
2025-09-09 09:30:19,150 [INFO] [OOD 3d] Layer 22: acc=0.7467
2025-09-09 09:30:19,151 [INFO] [OOD 3d] Layer 23: acc=0.7533
2025-09-09 09:30:19,153 [INFO] [OOD 3d] Layer 24: acc=0.7333
2025-09-09 09:30:19,154 [INFO] [OOD 3d] Layer 25: acc=0.7500
2025-09-09 09:30:19,156 [INFO] [OOD 3d] Layer 26: acc=0.7500
2025-09-09 09:30:19,157 [INFO] [OOD 3d] Layer 27: acc=0.7733
2025-09-09 09:30:19,159 [INFO] [OOD 3d] Layer 28: acc=0.7933
2025-09-09 09:30:19,161 [INFO] [OOD 3d] Layer 29: acc=0.7867
2025-09-09 09:30:19,162 [INFO] [OOD 3d] Layer 30: acc=0.7733
2025-09-09 09:30:19,164 [INFO] [OOD 3d] Layer 31: acc=0.7267
2025-09-09 09:30:19,165 [INFO] [OOD 3d] Layer 32: acc=0.6667
2025-09-09 09:30:19,166 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:30:24,676 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:30:24,679 [INFO] [OOD 4d] Layer 1: acc=0.3133
2025-09-09 09:30:24,681 [INFO] [OOD 4d] Layer 2: acc=0.3567
2025-09-09 09:30:24,682 [INFO] [OOD 4d] Layer 3: acc=0.5533
2025-09-09 09:30:24,684 [INFO] [OOD 4d] Layer 4: acc=0.6700
2025-09-09 09:30:24,685 [INFO] [OOD 4d] Layer 5: acc=0.6667
2025-09-09 09:30:24,687 [INFO] [OOD 4d] Layer 6: acc=0.6800
2025-09-09 09:30:24,689 [INFO] [OOD 4d] Layer 7: acc=0.6867
2025-09-09 09:30:24,690 [INFO] [OOD 4d] Layer 8: acc=0.7467
2025-09-09 09:30:24,692 [INFO] [OOD 4d] Layer 9: acc=0.8300
2025-09-09 09:30:24,693 [INFO] [OOD 4d] Layer 10: acc=0.4433
2025-09-09 09:30:24,695 [INFO] [OOD 4d] Layer 11: acc=0.6633
2025-09-09 09:30:24,697 [INFO] [OOD 4d] Layer 12: acc=0.8233
2025-09-09 09:30:24,698 [INFO] [OOD 4d] Layer 13: acc=0.7000
2025-09-09 09:30:24,700 [INFO] [OOD 4d] Layer 14: acc=1.0000
2025-09-09 09:30:24,701 [INFO] [OOD 4d] Layer 15: acc=0.9500
2025-09-09 09:30:24,703 [INFO] [OOD 4d] Layer 16: acc=0.9367
2025-09-09 09:30:24,705 [INFO] [OOD 4d] Layer 17: acc=0.8333
2025-09-09 09:30:24,706 [INFO] [OOD 4d] Layer 18: acc=0.8233
2025-09-09 09:30:24,708 [INFO] [OOD 4d] Layer 19: acc=0.8733
2025-09-09 09:30:24,709 [INFO] [OOD 4d] Layer 20: acc=0.8300
2025-09-09 09:30:24,711 [INFO] [OOD 4d] Layer 21: acc=0.8000
2025-09-09 09:30:24,713 [INFO] [OOD 4d] Layer 22: acc=0.7433
2025-09-09 09:30:24,714 [INFO] [OOD 4d] Layer 23: acc=0.7633
2025-09-09 09:30:24,716 [INFO] [OOD 4d] Layer 24: acc=0.7067
2025-09-09 09:30:24,717 [INFO] [OOD 4d] Layer 25: acc=0.7200
2025-09-09 09:30:24,719 [INFO] [OOD 4d] Layer 26: acc=0.6967
2025-09-09 09:30:24,721 [INFO] [OOD 4d] Layer 27: acc=0.7267
2025-09-09 09:30:24,722 [INFO] [OOD 4d] Layer 28: acc=0.7000
2025-09-09 09:30:24,724 [INFO] [OOD 4d] Layer 29: acc=0.7267
2025-09-09 09:30:24,725 [INFO] [OOD 4d] Layer 30: acc=0.6967
2025-09-09 09:30:24,727 [INFO] [OOD 4d] Layer 31: acc=0.7367
2025-09-09 09:30:24,729 [INFO] [OOD 4d] Layer 32: acc=0.5133
2025-09-09 09:30:24,729 [INFO] ==================== RUN 3/5 (Seed: 44) ====================
2025-09-09 09:30:24,730 [INFO] Using device: cuda:0
2025-09-09 09:30:24,733 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:30:24,733 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:30:24,735 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:30:24,736 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:30:24,737 [INFO] [TRAIN_COMM_3WAY_Run3] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:30:47,277 [INFO] [TRAIN_COMM_3WAY_Run3] Finished extracting activations.
2025-09-09 09:30:47,308 [INFO] Per-layer classification reports -> ./outputs/llama/run_seed_44/probe_3way_comm_llama_seed_44_20250909_093047.txt
2025-09-09 09:30:47,309 [INFO] --- Starting Probe Training Loop for layers 1..32 ---
2025-09-09 09:30:47,309 [INFO] --- Processing Layer 1 ---
2025-09-09 09:30:47,621 [INFO] Layer 1 - Training completed.
2025-09-09 09:30:47,623 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_1/state_dict.pt
2025-09-09 09:30:47,637 [INFO] Layer 1 - Test Acc: 0.3333 | F1(C0,C1,C2): 0.000, 0.500, 0.000
2025-09-09 09:30:47,637 [INFO] --- Processing Layer 2 ---
2025-09-09 09:30:47,917 [INFO] Layer 2 - Training completed.
2025-09-09 09:30:47,918 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_2/state_dict.pt
2025-09-09 09:30:47,931 [INFO] Layer 2 - Test Acc: 0.5867 | F1(C0,C1,C2): 0.629, 0.664, 0.405
2025-09-09 09:30:47,931 [INFO] --- Processing Layer 3 ---
2025-09-09 09:30:48,206 [INFO] Layer 3 - Training completed.
2025-09-09 09:30:48,207 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_3/state_dict.pt
2025-09-09 09:30:48,221 [INFO] Layer 3 - Test Acc: 0.6467 | F1(C0,C1,C2): 0.763, 0.711, 0.274
2025-09-09 09:30:48,222 [INFO] --- Processing Layer 4 ---
2025-09-09 09:30:48,493 [INFO] Layer 4 - Training completed.
2025-09-09 09:30:48,494 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_4/state_dict.pt
2025-09-09 09:30:48,508 [INFO] Layer 4 - Test Acc: 0.9400 | F1(C0,C1,C2): 0.919, 0.915, 0.985
2025-09-09 09:30:48,508 [INFO] --- Processing Layer 5 ---
2025-09-09 09:30:48,788 [INFO] Layer 5 - Training completed.
2025-09-09 09:30:48,789 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_5/state_dict.pt
2025-09-09 09:30:48,803 [INFO] Layer 5 - Test Acc: 0.9400 | F1(C0,C1,C2): 0.913, 0.916, 0.990
2025-09-09 09:30:48,803 [INFO] --- Processing Layer 6 ---
2025-09-09 09:30:49,069 [INFO] Layer 6 - Training completed.
2025-09-09 09:30:49,070 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_6/state_dict.pt
2025-09-09 09:30:49,084 [INFO] Layer 6 - Test Acc: 0.9500 | F1(C0,C1,C2): 0.942, 0.921, 0.985
2025-09-09 09:30:49,084 [INFO] --- Processing Layer 7 ---
2025-09-09 09:30:49,362 [INFO] Layer 7 - Training completed.
2025-09-09 09:30:49,363 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_7/state_dict.pt
2025-09-09 09:30:49,377 [INFO] Layer 7 - Test Acc: 0.9633 | F1(C0,C1,C2): 0.964, 0.946, 0.980
2025-09-09 09:30:49,377 [INFO] --- Processing Layer 8 ---
2025-09-09 09:30:49,637 [INFO] Layer 8 - Training completed.
2025-09-09 09:30:49,638 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_8/state_dict.pt
2025-09-09 09:30:49,651 [INFO] Layer 8 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.985, 0.975, 0.990
2025-09-09 09:30:49,652 [INFO] --- Processing Layer 9 ---
2025-09-09 09:30:49,920 [INFO] Layer 9 - Training completed.
2025-09-09 09:30:49,921 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_9/state_dict.pt
2025-09-09 09:30:49,934 [INFO] Layer 9 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.974, 0.976, 1.000
2025-09-09 09:30:49,935 [INFO] --- Processing Layer 10 ---
2025-09-09 09:30:50,209 [INFO] Layer 10 - Training completed.
2025-09-09 09:30:50,210 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_10/state_dict.pt
2025-09-09 09:30:50,224 [INFO] Layer 10 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:30:50,224 [INFO] --- Processing Layer 11 ---
2025-09-09 09:30:50,497 [INFO] Layer 11 - Training completed.
2025-09-09 09:30:50,498 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_11/state_dict.pt
2025-09-09 09:30:50,511 [INFO] Layer 11 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.974, 0.976, 1.000
2025-09-09 09:30:50,511 [INFO] --- Processing Layer 12 ---
2025-09-09 09:30:50,783 [INFO] Layer 12 - Training completed.
2025-09-09 09:30:50,784 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_12/state_dict.pt
2025-09-09 09:30:50,798 [INFO] Layer 12 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:30:50,798 [INFO] --- Processing Layer 13 ---
2025-09-09 09:30:51,066 [INFO] Layer 13 - Training completed.
2025-09-09 09:30:51,067 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_13/state_dict.pt
2025-09-09 09:30:51,080 [INFO] Layer 13 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.974, 0.976, 1.000
2025-09-09 09:30:51,080 [INFO] --- Processing Layer 14 ---
2025-09-09 09:30:51,341 [INFO] Layer 14 - Training completed.
2025-09-09 09:30:51,342 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_14/state_dict.pt
2025-09-09 09:30:51,356 [INFO] Layer 14 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:30:51,356 [INFO] --- Processing Layer 15 ---
2025-09-09 09:30:51,624 [INFO] Layer 15 - Training completed.
2025-09-09 09:30:51,626 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_15/state_dict.pt
2025-09-09 09:30:51,639 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:30:51,640 [INFO] --- Processing Layer 16 ---
2025-09-09 09:30:51,904 [INFO] Layer 16 - Training completed.
2025-09-09 09:30:51,905 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_16/state_dict.pt
2025-09-09 09:30:51,920 [INFO] Layer 16 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:30:51,920 [INFO] --- Processing Layer 17 ---
2025-09-09 09:30:52,180 [INFO] Layer 17 - Training completed.
2025-09-09 09:30:52,181 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_17/state_dict.pt
2025-09-09 09:30:52,195 [INFO] Layer 17 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:30:52,196 [INFO] --- Processing Layer 18 ---
2025-09-09 09:30:52,455 [INFO] Layer 18 - Training completed.
2025-09-09 09:30:52,456 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_18/state_dict.pt
2025-09-09 09:30:52,470 [INFO] Layer 18 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:30:52,470 [INFO] --- Processing Layer 19 ---
2025-09-09 09:30:52,730 [INFO] Layer 19 - Training completed.
2025-09-09 09:30:52,731 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_19/state_dict.pt
2025-09-09 09:30:52,745 [INFO] Layer 19 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:30:52,745 [INFO] --- Processing Layer 20 ---
2025-09-09 09:30:53,004 [INFO] Layer 20 - Training completed.
2025-09-09 09:30:53,005 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_20/state_dict.pt
2025-09-09 09:30:53,019 [INFO] Layer 20 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.976, 0.974, 1.000
2025-09-09 09:30:53,019 [INFO] --- Processing Layer 21 ---
2025-09-09 09:30:53,276 [INFO] Layer 21 - Training completed.
2025-09-09 09:30:53,277 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_21/state_dict.pt
2025-09-09 09:30:53,291 [INFO] Layer 21 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:30:53,291 [INFO] --- Processing Layer 22 ---
2025-09-09 09:30:53,550 [INFO] Layer 22 - Training completed.
2025-09-09 09:30:53,551 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_22/state_dict.pt
2025-09-09 09:30:53,565 [INFO] Layer 22 - Test Acc: 0.9733 | F1(C0,C1,C2): 0.959, 0.961, 1.000
2025-09-09 09:30:53,565 [INFO] --- Processing Layer 23 ---
2025-09-09 09:30:53,827 [INFO] Layer 23 - Training completed.
2025-09-09 09:30:53,828 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_23/state_dict.pt
2025-09-09 09:30:53,842 [INFO] Layer 23 - Test Acc: 0.9733 | F1(C0,C1,C2): 0.960, 0.960, 1.000
2025-09-09 09:30:53,842 [INFO] --- Processing Layer 24 ---
2025-09-09 09:30:54,101 [INFO] Layer 24 - Training completed.
2025-09-09 09:30:54,102 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_24/state_dict.pt
2025-09-09 09:30:54,115 [INFO] Layer 24 - Test Acc: 0.9700 | F1(C0,C1,C2): 0.953, 0.957, 1.000
2025-09-09 09:30:54,116 [INFO] --- Processing Layer 25 ---
2025-09-09 09:30:54,374 [INFO] Layer 25 - Training completed.
2025-09-09 09:30:54,375 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_25/state_dict.pt
2025-09-09 09:30:54,388 [INFO] Layer 25 - Test Acc: 0.9600 | F1(C0,C1,C2): 0.939, 0.941, 1.000
2025-09-09 09:30:54,389 [INFO] --- Processing Layer 26 ---
2025-09-09 09:30:54,647 [INFO] Layer 26 - Training completed.
2025-09-09 09:30:54,649 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_26/state_dict.pt
2025-09-09 09:30:54,662 [INFO] Layer 26 - Test Acc: 0.9633 | F1(C0,C1,C2): 0.945, 0.945, 1.000
2025-09-09 09:30:54,662 [INFO] --- Processing Layer 27 ---
2025-09-09 09:30:54,920 [INFO] Layer 27 - Training completed.
2025-09-09 09:30:54,921 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_27/state_dict.pt
2025-09-09 09:30:54,935 [INFO] Layer 27 - Test Acc: 0.9533 | F1(C0,C1,C2): 0.929, 0.931, 1.000
2025-09-09 09:30:54,935 [INFO] --- Processing Layer 28 ---
2025-09-09 09:30:55,194 [INFO] Layer 28 - Training completed.
2025-09-09 09:30:55,195 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_28/state_dict.pt
2025-09-09 09:30:55,209 [INFO] Layer 28 - Test Acc: 0.9367 | F1(C0,C1,C2): 0.910, 0.899, 1.000
2025-09-09 09:30:55,209 [INFO] --- Processing Layer 29 ---
2025-09-09 09:30:55,469 [INFO] Layer 29 - Training completed.
2025-09-09 09:30:55,470 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_29/state_dict.pt
2025-09-09 09:30:55,483 [INFO] Layer 29 - Test Acc: 0.9467 | F1(C0,C1,C2): 0.919, 0.921, 1.000
2025-09-09 09:30:55,483 [INFO] --- Processing Layer 30 ---
2025-09-09 09:30:55,740 [INFO] Layer 30 - Training completed.
2025-09-09 09:30:55,741 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_30/state_dict.pt
2025-09-09 09:30:55,754 [INFO] Layer 30 - Test Acc: 0.9333 | F1(C0,C1,C2): 0.898, 0.902, 1.000
2025-09-09 09:30:55,755 [INFO] --- Processing Layer 31 ---
2025-09-09 09:30:56,014 [INFO] Layer 31 - Training completed.
2025-09-09 09:30:56,015 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_31/state_dict.pt
2025-09-09 09:30:56,030 [INFO] Layer 31 - Test Acc: 0.9067 | F1(C0,C1,C2): 0.869, 0.849, 1.000
2025-09-09 09:30:56,030 [INFO] --- Processing Layer 32 ---
2025-09-09 09:30:56,290 [INFO] Layer 32 - Training completed.
2025-09-09 09:30:56,291 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_44/layer_32/state_dict.pt
2025-09-09 09:30:56,304 [INFO] Layer 32 - Test Acc: 0.9033 | F1(C0,C1,C2): 0.868, 0.840, 1.000
2025-09-09 09:30:56,305 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:30:56,305 [INFO] --- Generating OOD Datasets for Run 3 ---
2025-09-09 09:30:56,310 [WARNING] [WARN] OOD Class-2 (2-digit): Got 1/100
2025-09-09 09:30:56,312 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:30:56,352 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:31:00,875 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:31:00,878 [INFO] [OOD 1d] Layer 1: acc=0.3967
2025-09-09 09:31:00,880 [INFO] [OOD 1d] Layer 2: acc=0.4933
2025-09-09 09:31:00,882 [INFO] [OOD 1d] Layer 3: acc=0.4433
2025-09-09 09:31:00,883 [INFO] [OOD 1d] Layer 4: acc=0.6533
2025-09-09 09:31:00,885 [INFO] [OOD 1d] Layer 5: acc=0.6133
2025-09-09 09:31:00,887 [INFO] [OOD 1d] Layer 6: acc=0.8900
2025-09-09 09:31:00,889 [INFO] [OOD 1d] Layer 7: acc=0.6200
2025-09-09 09:31:00,890 [INFO] [OOD 1d] Layer 8: acc=0.9533
2025-09-09 09:31:00,891 [INFO] [OOD 1d] Layer 9: acc=0.9267
2025-09-09 09:31:00,893 [INFO] [OOD 1d] Layer 10: acc=0.8800
2025-09-09 09:31:00,895 [INFO] [OOD 1d] Layer 11: acc=0.7833
2025-09-09 09:31:00,897 [INFO] [OOD 1d] Layer 12: acc=0.8700
2025-09-09 09:31:00,898 [INFO] [OOD 1d] Layer 13: acc=0.8500
2025-09-09 09:31:00,900 [INFO] [OOD 1d] Layer 14: acc=1.0000
2025-09-09 09:31:00,901 [INFO] [OOD 1d] Layer 15: acc=1.0000
2025-09-09 09:31:00,903 [INFO] [OOD 1d] Layer 16: acc=0.9900
2025-09-09 09:31:00,905 [INFO] [OOD 1d] Layer 17: acc=1.0000
2025-09-09 09:31:00,906 [INFO] [OOD 1d] Layer 18: acc=0.9233
2025-09-09 09:31:00,908 [INFO] [OOD 1d] Layer 19: acc=0.9533
2025-09-09 09:31:00,910 [INFO] [OOD 1d] Layer 20: acc=1.0000
2025-09-09 09:31:00,911 [INFO] [OOD 1d] Layer 21: acc=0.9767
2025-09-09 09:31:00,913 [INFO] [OOD 1d] Layer 22: acc=0.9867
2025-09-09 09:31:00,915 [INFO] [OOD 1d] Layer 23: acc=0.9767
2025-09-09 09:31:00,916 [INFO] [OOD 1d] Layer 24: acc=0.9200
2025-09-09 09:31:00,918 [INFO] [OOD 1d] Layer 25: acc=0.9533
2025-09-09 09:31:00,920 [INFO] [OOD 1d] Layer 26: acc=0.9167
2025-09-09 09:31:00,922 [INFO] [OOD 1d] Layer 27: acc=0.8167
2025-09-09 09:31:00,924 [INFO] [OOD 1d] Layer 28: acc=0.9367
2025-09-09 09:31:00,926 [INFO] [OOD 1d] Layer 29: acc=0.8933
2025-09-09 09:31:00,927 [INFO] [OOD 1d] Layer 30: acc=0.8867
2025-09-09 09:31:00,929 [INFO] [OOD 1d] Layer 31: acc=0.9267
2025-09-09 09:31:00,930 [INFO] [OOD 1d] Layer 32: acc=0.8833
2025-09-09 09:31:00,931 [INFO] [OOD_2d_ALL] Extracting activations for 201 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:31:04,042 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:31:04,044 [INFO] [OOD 2d] Layer 1: acc=0.4975
2025-09-09 09:31:04,045 [INFO] [OOD 2d] Layer 2: acc=0.7363
2025-09-09 09:31:04,046 [INFO] [OOD 2d] Layer 3: acc=0.9104
2025-09-09 09:31:04,048 [INFO] [OOD 2d] Layer 4: acc=0.9353
2025-09-09 09:31:04,049 [INFO] [OOD 2d] Layer 5: acc=0.9353
2025-09-09 09:31:04,050 [INFO] [OOD 2d] Layer 6: acc=0.9751
2025-09-09 09:31:04,051 [INFO] [OOD 2d] Layer 7: acc=0.9801
2025-09-09 09:31:04,053 [INFO] [OOD 2d] Layer 8: acc=0.9950
2025-09-09 09:31:04,054 [INFO] [OOD 2d] Layer 9: acc=0.9751
2025-09-09 09:31:04,055 [INFO] [OOD 2d] Layer 10: acc=0.9701
2025-09-09 09:31:04,057 [INFO] [OOD 2d] Layer 11: acc=0.9602
2025-09-09 09:31:04,058 [INFO] [OOD 2d] Layer 12: acc=0.9652
2025-09-09 09:31:04,059 [INFO] [OOD 2d] Layer 13: acc=0.9602
2025-09-09 09:31:04,061 [INFO] [OOD 2d] Layer 14: acc=0.9950
2025-09-09 09:31:04,062 [INFO] [OOD 2d] Layer 15: acc=0.9950
2025-09-09 09:31:04,063 [INFO] [OOD 2d] Layer 16: acc=1.0000
2025-09-09 09:31:04,064 [INFO] [OOD 2d] Layer 17: acc=0.9950
2025-09-09 09:31:04,066 [INFO] [OOD 2d] Layer 18: acc=0.9950
2025-09-09 09:31:04,067 [INFO] [OOD 2d] Layer 19: acc=0.9950
2025-09-09 09:31:04,068 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:31:04,069 [INFO] [OOD 2d] Layer 21: acc=1.0000
2025-09-09 09:31:04,070 [INFO] [OOD 2d] Layer 22: acc=0.9950
2025-09-09 09:31:04,072 [INFO] [OOD 2d] Layer 23: acc=0.9950
2025-09-09 09:31:04,073 [INFO] [OOD 2d] Layer 24: acc=0.9851
2025-09-09 09:31:04,074 [INFO] [OOD 2d] Layer 25: acc=0.9851
2025-09-09 09:31:04,075 [INFO] [OOD 2d] Layer 26: acc=0.9950
2025-09-09 09:31:04,077 [INFO] [OOD 2d] Layer 27: acc=0.9851
2025-09-09 09:31:04,078 [INFO] [OOD 2d] Layer 28: acc=0.9801
2025-09-09 09:31:04,079 [INFO] [OOD 2d] Layer 29: acc=0.9751
2025-09-09 09:31:04,081 [INFO] [OOD 2d] Layer 30: acc=0.9701
2025-09-09 09:31:04,082 [INFO] [OOD 2d] Layer 31: acc=0.9801
2025-09-09 09:31:04,083 [INFO] [OOD 2d] Layer 32: acc=0.9254
2025-09-09 09:31:04,083 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:31:08,563 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:31:08,566 [INFO] [OOD 3d] Layer 1: acc=0.3333
2025-09-09 09:31:08,568 [INFO] [OOD 3d] Layer 2: acc=0.4600
2025-09-09 09:31:08,570 [INFO] [OOD 3d] Layer 3: acc=0.5367
2025-09-09 09:31:08,571 [INFO] [OOD 3d] Layer 4: acc=0.7733
2025-09-09 09:31:08,573 [INFO] [OOD 3d] Layer 5: acc=0.7233
2025-09-09 09:31:08,575 [INFO] [OOD 3d] Layer 6: acc=0.6700
2025-09-09 09:31:08,576 [INFO] [OOD 3d] Layer 7: acc=0.9267
2025-09-09 09:31:08,578 [INFO] [OOD 3d] Layer 8: acc=0.8500
2025-09-09 09:31:08,579 [INFO] [OOD 3d] Layer 9: acc=0.9200
2025-09-09 09:31:08,581 [INFO] [OOD 3d] Layer 10: acc=0.8933
2025-09-09 09:31:08,583 [INFO] [OOD 3d] Layer 11: acc=0.9433
2025-09-09 09:31:08,585 [INFO] [OOD 3d] Layer 12: acc=0.9233
2025-09-09 09:31:08,586 [INFO] [OOD 3d] Layer 13: acc=0.9433
2025-09-09 09:31:08,588 [INFO] [OOD 3d] Layer 14: acc=1.0000
2025-09-09 09:31:08,589 [INFO] [OOD 3d] Layer 15: acc=0.9967
2025-09-09 09:31:08,591 [INFO] [OOD 3d] Layer 16: acc=0.9167
2025-09-09 09:31:08,593 [INFO] [OOD 3d] Layer 17: acc=0.8533
2025-09-09 09:31:08,594 [INFO] [OOD 3d] Layer 18: acc=0.8067
2025-09-09 09:31:08,596 [INFO] [OOD 3d] Layer 19: acc=0.8567
2025-09-09 09:31:08,598 [INFO] [OOD 3d] Layer 20: acc=0.8200
2025-09-09 09:31:08,599 [INFO] [OOD 3d] Layer 21: acc=0.7500
2025-09-09 09:31:08,601 [INFO] [OOD 3d] Layer 22: acc=0.7433
2025-09-09 09:31:08,602 [INFO] [OOD 3d] Layer 23: acc=0.7433
2025-09-09 09:31:08,604 [INFO] [OOD 3d] Layer 24: acc=0.7433
2025-09-09 09:31:08,605 [INFO] [OOD 3d] Layer 25: acc=0.7633
2025-09-09 09:31:08,607 [INFO] [OOD 3d] Layer 26: acc=0.7467
2025-09-09 09:31:08,609 [INFO] [OOD 3d] Layer 27: acc=0.7800
2025-09-09 09:31:08,610 [INFO] [OOD 3d] Layer 28: acc=0.7800
2025-09-09 09:31:08,612 [INFO] [OOD 3d] Layer 29: acc=0.7967
2025-09-09 09:31:08,613 [INFO] [OOD 3d] Layer 30: acc=0.7867
2025-09-09 09:31:08,615 [INFO] [OOD 3d] Layer 31: acc=0.7400
2025-09-09 09:31:08,617 [INFO] [OOD 3d] Layer 32: acc=0.6667
2025-09-09 09:31:08,617 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:31:14,129 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:31:14,131 [INFO] [OOD 4d] Layer 1: acc=0.3333
2025-09-09 09:31:14,133 [INFO] [OOD 4d] Layer 2: acc=0.3767
2025-09-09 09:31:14,135 [INFO] [OOD 4d] Layer 3: acc=0.3833
2025-09-09 09:31:14,137 [INFO] [OOD 4d] Layer 4: acc=0.7233
2025-09-09 09:31:14,138 [INFO] [OOD 4d] Layer 5: acc=0.6967
2025-09-09 09:31:14,140 [INFO] [OOD 4d] Layer 6: acc=0.6667
2025-09-09 09:31:14,141 [INFO] [OOD 4d] Layer 7: acc=0.7933
2025-09-09 09:31:14,143 [INFO] [OOD 4d] Layer 8: acc=0.6767
2025-09-09 09:31:14,145 [INFO] [OOD 4d] Layer 9: acc=0.8700
2025-09-09 09:31:14,146 [INFO] [OOD 4d] Layer 10: acc=0.6267
2025-09-09 09:31:14,148 [INFO] [OOD 4d] Layer 11: acc=0.8467
2025-09-09 09:31:14,149 [INFO] [OOD 4d] Layer 12: acc=0.9500
2025-09-09 09:31:14,151 [INFO] [OOD 4d] Layer 13: acc=0.8033
2025-09-09 09:31:14,153 [INFO] [OOD 4d] Layer 14: acc=0.9967
2025-09-09 09:31:14,154 [INFO] [OOD 4d] Layer 15: acc=0.9600
2025-09-09 09:31:14,155 [INFO] [OOD 4d] Layer 16: acc=0.9133
2025-09-09 09:31:14,157 [INFO] [OOD 4d] Layer 17: acc=0.8333
2025-09-09 09:31:14,159 [INFO] [OOD 4d] Layer 18: acc=0.7967
2025-09-09 09:31:14,161 [INFO] [OOD 4d] Layer 19: acc=0.8400
2025-09-09 09:31:14,162 [INFO] [OOD 4d] Layer 20: acc=0.8067
2025-09-09 09:31:14,164 [INFO] [OOD 4d] Layer 21: acc=0.7500
2025-09-09 09:31:14,165 [INFO] [OOD 4d] Layer 22: acc=0.7367
2025-09-09 09:31:14,167 [INFO] [OOD 4d] Layer 23: acc=0.6900
2025-09-09 09:31:14,169 [INFO] [OOD 4d] Layer 24: acc=0.6833
2025-09-09 09:31:14,170 [INFO] [OOD 4d] Layer 25: acc=0.6867
2025-09-09 09:31:14,172 [INFO] [OOD 4d] Layer 26: acc=0.6400
2025-09-09 09:31:14,173 [INFO] [OOD 4d] Layer 27: acc=0.6767
2025-09-09 09:31:14,175 [INFO] [OOD 4d] Layer 28: acc=0.6700
2025-09-09 09:31:14,177 [INFO] [OOD 4d] Layer 29: acc=0.6533
2025-09-09 09:31:14,178 [INFO] [OOD 4d] Layer 30: acc=0.6633
2025-09-09 09:31:14,180 [INFO] [OOD 4d] Layer 31: acc=0.6800
2025-09-09 09:31:14,181 [INFO] [OOD 4d] Layer 32: acc=0.5533
2025-09-09 09:31:14,182 [INFO] ==================== RUN 4/5 (Seed: 45) ====================
2025-09-09 09:31:14,183 [INFO] Using device: cuda:0
2025-09-09 09:31:14,186 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:31:14,186 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:31:14,189 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:31:14,189 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:31:14,190 [INFO] [TRAIN_COMM_3WAY_Run4] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:31:36,846 [INFO] [TRAIN_COMM_3WAY_Run4] Finished extracting activations.
2025-09-09 09:31:36,849 [INFO] Per-layer classification reports -> ./outputs/llama/run_seed_45/probe_3way_comm_llama_seed_45_20250909_093136.txt
2025-09-09 09:31:36,849 [INFO] --- Starting Probe Training Loop for layers 1..32 ---
2025-09-09 09:31:36,849 [INFO] --- Processing Layer 1 ---
2025-09-09 09:31:37,107 [INFO] Layer 1 - Training completed.
2025-09-09 09:31:37,109 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_1/state_dict.pt
2025-09-09 09:31:37,123 [INFO] Layer 1 - Test Acc: 0.3333 | F1(C0,C1,C2): 0.500, 0.000, 0.000
2025-09-09 09:31:37,123 [INFO] --- Processing Layer 2 ---
2025-09-09 09:31:37,378 [INFO] Layer 2 - Training completed.
2025-09-09 09:31:37,379 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_2/state_dict.pt
2025-09-09 09:31:37,393 [INFO] Layer 2 - Test Acc: 0.6267 | F1(C0,C1,C2): 0.721, 0.640, 0.497
2025-09-09 09:31:37,393 [INFO] --- Processing Layer 3 ---
2025-09-09 09:31:37,649 [INFO] Layer 3 - Training completed.
2025-09-09 09:31:37,650 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_3/state_dict.pt
2025-09-09 09:31:37,664 [INFO] Layer 3 - Test Acc: 0.7567 | F1(C0,C1,C2): 0.866, 0.601, 0.750
2025-09-09 09:31:37,664 [INFO] --- Processing Layer 4 ---
2025-09-09 09:31:37,919 [INFO] Layer 4 - Training completed.
2025-09-09 09:31:37,920 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_4/state_dict.pt
2025-09-09 09:31:37,934 [INFO] Layer 4 - Test Acc: 0.9533 | F1(C0,C1,C2): 0.930, 0.934, 0.995
2025-09-09 09:31:37,934 [INFO] --- Processing Layer 5 ---
2025-09-09 09:31:38,187 [INFO] Layer 5 - Training completed.
2025-09-09 09:31:38,188 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_5/state_dict.pt
2025-09-09 09:31:38,202 [INFO] Layer 5 - Test Acc: 0.9767 | F1(C0,C1,C2): 0.965, 0.975, 0.990
2025-09-09 09:31:38,202 [INFO] --- Processing Layer 6 ---
2025-09-09 09:31:38,456 [INFO] Layer 6 - Training completed.
2025-09-09 09:31:38,457 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_6/state_dict.pt
2025-09-09 09:31:38,470 [INFO] Layer 6 - Test Acc: 0.9633 | F1(C0,C1,C2): 0.946, 0.944, 1.000
2025-09-09 09:31:38,470 [INFO] --- Processing Layer 7 ---
2025-09-09 09:31:38,729 [INFO] Layer 7 - Training completed.
2025-09-09 09:31:38,730 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_7/state_dict.pt
2025-09-09 09:31:38,743 [INFO] Layer 7 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.985, 0.995
2025-09-09 09:31:38,744 [INFO] --- Processing Layer 8 ---
2025-09-09 09:31:39,001 [INFO] Layer 8 - Training completed.
2025-09-09 09:31:39,002 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_8/state_dict.pt
2025-09-09 09:31:39,015 [INFO] Layer 8 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.980, 1.000
2025-09-09 09:31:39,016 [INFO] --- Processing Layer 9 ---
2025-09-09 09:31:39,273 [INFO] Layer 9 - Training completed.
2025-09-09 09:31:39,274 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_9/state_dict.pt
2025-09-09 09:31:39,288 [INFO] Layer 9 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:31:39,288 [INFO] --- Processing Layer 10 ---
2025-09-09 09:31:39,545 [INFO] Layer 10 - Training completed.
2025-09-09 09:31:39,546 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_10/state_dict.pt
2025-09-09 09:31:39,560 [INFO] Layer 10 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:31:39,560 [INFO] --- Processing Layer 11 ---
2025-09-09 09:31:39,821 [INFO] Layer 11 - Training completed.
2025-09-09 09:31:39,822 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_11/state_dict.pt
2025-09-09 09:31:39,836 [INFO] Layer 11 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:31:39,837 [INFO] --- Processing Layer 12 ---
2025-09-09 09:31:40,099 [INFO] Layer 12 - Training completed.
2025-09-09 09:31:40,100 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_12/state_dict.pt
2025-09-09 09:31:40,114 [INFO] Layer 12 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:31:40,115 [INFO] --- Processing Layer 13 ---
2025-09-09 09:31:40,374 [INFO] Layer 13 - Training completed.
2025-09-09 09:31:40,375 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_13/state_dict.pt
2025-09-09 09:31:40,389 [INFO] Layer 13 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:31:40,389 [INFO] --- Processing Layer 14 ---
2025-09-09 09:31:40,650 [INFO] Layer 14 - Training completed.
2025-09-09 09:31:40,651 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_14/state_dict.pt
2025-09-09 09:31:40,665 [INFO] Layer 14 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:31:40,665 [INFO] --- Processing Layer 15 ---
2025-09-09 09:31:40,926 [INFO] Layer 15 - Training completed.
2025-09-09 09:31:40,927 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_15/state_dict.pt
2025-09-09 09:31:40,941 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:31:40,941 [INFO] --- Processing Layer 16 ---
2025-09-09 09:31:41,206 [INFO] Layer 16 - Training completed.
2025-09-09 09:31:41,207 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_16/state_dict.pt
2025-09-09 09:31:41,221 [INFO] Layer 16 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:31:41,221 [INFO] --- Processing Layer 17 ---
2025-09-09 09:31:41,491 [INFO] Layer 17 - Training completed.
2025-09-09 09:31:41,493 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_17/state_dict.pt
2025-09-09 09:31:41,506 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:31:41,506 [INFO] --- Processing Layer 18 ---
2025-09-09 09:31:41,773 [INFO] Layer 18 - Training completed.
2025-09-09 09:31:41,774 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_18/state_dict.pt
2025-09-09 09:31:41,787 [INFO] Layer 18 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:31:41,787 [INFO] --- Processing Layer 19 ---
2025-09-09 09:31:42,063 [INFO] Layer 19 - Training completed.
2025-09-09 09:31:42,064 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_19/state_dict.pt
2025-09-09 09:31:42,079 [INFO] Layer 19 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:31:42,079 [INFO] --- Processing Layer 20 ---
2025-09-09 09:31:42,357 [INFO] Layer 20 - Training completed.
2025-09-09 09:31:42,358 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_20/state_dict.pt
2025-09-09 09:31:42,372 [INFO] Layer 20 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:31:42,372 [INFO] --- Processing Layer 21 ---
2025-09-09 09:31:42,637 [INFO] Layer 21 - Training completed.
2025-09-09 09:31:42,638 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_21/state_dict.pt
2025-09-09 09:31:42,651 [INFO] Layer 21 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:31:42,652 [INFO] --- Processing Layer 22 ---
2025-09-09 09:31:42,914 [INFO] Layer 22 - Training completed.
2025-09-09 09:31:42,914 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_22/state_dict.pt
2025-09-09 09:31:42,928 [INFO] Layer 22 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:31:42,928 [INFO] --- Processing Layer 23 ---
2025-09-09 09:31:43,188 [INFO] Layer 23 - Training completed.
2025-09-09 09:31:43,189 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_23/state_dict.pt
2025-09-09 09:31:43,202 [INFO] Layer 23 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:31:43,203 [INFO] --- Processing Layer 24 ---
2025-09-09 09:31:43,463 [INFO] Layer 24 - Training completed.
2025-09-09 09:31:43,464 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_24/state_dict.pt
2025-09-09 09:31:43,477 [INFO] Layer 24 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:31:43,478 [INFO] --- Processing Layer 25 ---
2025-09-09 09:31:43,738 [INFO] Layer 25 - Training completed.
2025-09-09 09:31:43,739 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_25/state_dict.pt
2025-09-09 09:31:43,753 [INFO] Layer 25 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.975, 0.975, 1.000
2025-09-09 09:31:43,753 [INFO] --- Processing Layer 26 ---
2025-09-09 09:31:44,013 [INFO] Layer 26 - Training completed.
2025-09-09 09:31:44,014 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_26/state_dict.pt
2025-09-09 09:31:44,027 [INFO] Layer 26 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:31:44,027 [INFO] --- Processing Layer 27 ---
2025-09-09 09:31:44,284 [INFO] Layer 27 - Training completed.
2025-09-09 09:31:44,285 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_27/state_dict.pt
2025-09-09 09:31:44,298 [INFO] Layer 27 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:31:44,299 [INFO] --- Processing Layer 28 ---
2025-09-09 09:31:44,555 [INFO] Layer 28 - Training completed.
2025-09-09 09:31:44,556 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_28/state_dict.pt
2025-09-09 09:31:44,570 [INFO] Layer 28 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.980, 1.000
2025-09-09 09:31:44,570 [INFO] --- Processing Layer 29 ---
2025-09-09 09:31:44,827 [INFO] Layer 29 - Training completed.
2025-09-09 09:31:44,828 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_29/state_dict.pt
2025-09-09 09:31:44,842 [INFO] Layer 29 - Test Acc: 0.9767 | F1(C0,C1,C2): 0.964, 0.966, 1.000
2025-09-09 09:31:44,842 [INFO] --- Processing Layer 30 ---
2025-09-09 09:31:45,101 [INFO] Layer 30 - Training completed.
2025-09-09 09:31:45,102 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_30/state_dict.pt
2025-09-09 09:31:45,119 [INFO] Layer 30 - Test Acc: 0.9800 | F1(C0,C1,C2): 0.970, 0.970, 1.000
2025-09-09 09:31:45,119 [INFO] --- Processing Layer 31 ---
2025-09-09 09:31:45,410 [INFO] Layer 31 - Training completed.
2025-09-09 09:31:45,411 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_31/state_dict.pt
2025-09-09 09:31:45,425 [INFO] Layer 31 - Test Acc: 0.9667 | F1(C0,C1,C2): 0.952, 0.948, 1.000
2025-09-09 09:31:45,425 [INFO] --- Processing Layer 32 ---
2025-09-09 09:31:45,690 [INFO] Layer 32 - Training completed.
2025-09-09 09:31:45,691 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_45/layer_32/state_dict.pt
2025-09-09 09:31:45,705 [INFO] Layer 32 - Test Acc: 0.9667 | F1(C0,C1,C2): 0.950, 0.949, 1.000
2025-09-09 09:31:45,705 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:31:45,705 [INFO] --- Generating OOD Datasets for Run 4 ---
2025-09-09 09:31:45,711 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:31:45,713 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:31:45,754 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:31:50,254 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:31:50,256 [INFO] [OOD 1d] Layer 1: acc=0.3333
2025-09-09 09:31:50,258 [INFO] [OOD 1d] Layer 2: acc=0.4367
2025-09-09 09:31:50,259 [INFO] [OOD 1d] Layer 3: acc=0.5467
2025-09-09 09:31:50,261 [INFO] [OOD 1d] Layer 4: acc=0.6500
2025-09-09 09:31:50,263 [INFO] [OOD 1d] Layer 5: acc=0.5367
2025-09-09 09:31:50,265 [INFO] [OOD 1d] Layer 6: acc=0.8933
2025-09-09 09:31:50,266 [INFO] [OOD 1d] Layer 7: acc=0.6333
2025-09-09 09:31:50,268 [INFO] [OOD 1d] Layer 8: acc=0.9767
2025-09-09 09:31:50,269 [INFO] [OOD 1d] Layer 9: acc=0.9567
2025-09-09 09:31:50,271 [INFO] [OOD 1d] Layer 10: acc=0.8667
2025-09-09 09:31:50,273 [INFO] [OOD 1d] Layer 11: acc=0.6633
2025-09-09 09:31:50,274 [INFO] [OOD 1d] Layer 12: acc=0.8367
2025-09-09 09:31:50,276 [INFO] [OOD 1d] Layer 13: acc=0.8467
2025-09-09 09:31:50,277 [INFO] [OOD 1d] Layer 14: acc=1.0000
2025-09-09 09:31:50,279 [INFO] [OOD 1d] Layer 15: acc=1.0000
2025-09-09 09:31:50,281 [INFO] [OOD 1d] Layer 16: acc=0.9900
2025-09-09 09:31:50,282 [INFO] [OOD 1d] Layer 17: acc=1.0000
2025-09-09 09:31:50,284 [INFO] [OOD 1d] Layer 18: acc=0.8700
2025-09-09 09:31:50,285 [INFO] [OOD 1d] Layer 19: acc=0.9467
2025-09-09 09:31:50,287 [INFO] [OOD 1d] Layer 20: acc=0.9233
2025-09-09 09:31:50,289 [INFO] [OOD 1d] Layer 21: acc=0.8967
2025-09-09 09:31:50,290 [INFO] [OOD 1d] Layer 22: acc=0.8833
2025-09-09 09:31:50,292 [INFO] [OOD 1d] Layer 23: acc=0.8967
2025-09-09 09:31:50,294 [INFO] [OOD 1d] Layer 24: acc=0.9133
2025-09-09 09:31:50,295 [INFO] [OOD 1d] Layer 25: acc=0.8433
2025-09-09 09:31:50,297 [INFO] [OOD 1d] Layer 26: acc=0.8800
2025-09-09 09:31:50,298 [INFO] [OOD 1d] Layer 27: acc=0.8067
2025-09-09 09:31:50,300 [INFO] [OOD 1d] Layer 28: acc=0.9200
2025-09-09 09:31:50,302 [INFO] [OOD 1d] Layer 29: acc=0.8033
2025-09-09 09:31:50,303 [INFO] [OOD 1d] Layer 30: acc=0.8367
2025-09-09 09:31:50,305 [INFO] [OOD 1d] Layer 31: acc=0.8800
2025-09-09 09:31:50,307 [INFO] [OOD 1d] Layer 32: acc=0.8733
2025-09-09 09:31:50,307 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:31:53,409 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:31:53,411 [INFO] [OOD 2d] Layer 1: acc=0.5000
2025-09-09 09:31:53,413 [INFO] [OOD 2d] Layer 2: acc=0.6650
2025-09-09 09:31:53,414 [INFO] [OOD 2d] Layer 3: acc=0.7100
2025-09-09 09:31:53,415 [INFO] [OOD 2d] Layer 4: acc=0.9350
2025-09-09 09:31:53,417 [INFO] [OOD 2d] Layer 5: acc=0.9550
2025-09-09 09:31:53,418 [INFO] [OOD 2d] Layer 6: acc=0.9900
2025-09-09 09:31:53,419 [INFO] [OOD 2d] Layer 7: acc=0.9700
2025-09-09 09:31:53,420 [INFO] [OOD 2d] Layer 8: acc=0.9850
2025-09-09 09:31:53,422 [INFO] [OOD 2d] Layer 9: acc=0.9750
2025-09-09 09:31:53,423 [INFO] [OOD 2d] Layer 10: acc=0.9800
2025-09-09 09:31:53,424 [INFO] [OOD 2d] Layer 11: acc=0.9700
2025-09-09 09:31:53,426 [INFO] [OOD 2d] Layer 12: acc=0.9800
2025-09-09 09:31:53,427 [INFO] [OOD 2d] Layer 13: acc=0.9600
2025-09-09 09:31:53,428 [INFO] [OOD 2d] Layer 14: acc=1.0000
2025-09-09 09:31:53,429 [INFO] [OOD 2d] Layer 15: acc=0.9950
2025-09-09 09:31:53,430 [INFO] [OOD 2d] Layer 16: acc=0.9950
2025-09-09 09:31:53,432 [INFO] [OOD 2d] Layer 17: acc=0.9900
2025-09-09 09:31:53,433 [INFO] [OOD 2d] Layer 18: acc=0.9900
2025-09-09 09:31:53,434 [INFO] [OOD 2d] Layer 19: acc=0.9900
2025-09-09 09:31:53,435 [INFO] [OOD 2d] Layer 20: acc=0.9900
2025-09-09 09:31:53,437 [INFO] [OOD 2d] Layer 21: acc=0.9900
2025-09-09 09:31:53,438 [INFO] [OOD 2d] Layer 22: acc=0.9850
2025-09-09 09:31:53,439 [INFO] [OOD 2d] Layer 23: acc=0.9800
2025-09-09 09:31:53,441 [INFO] [OOD 2d] Layer 24: acc=0.9800
2025-09-09 09:31:53,442 [INFO] [OOD 2d] Layer 25: acc=0.9750
2025-09-09 09:31:53,443 [INFO] [OOD 2d] Layer 26: acc=0.9850
2025-09-09 09:31:53,445 [INFO] [OOD 2d] Layer 27: acc=0.9750
2025-09-09 09:31:53,446 [INFO] [OOD 2d] Layer 28: acc=0.9550
2025-09-09 09:31:53,447 [INFO] [OOD 2d] Layer 29: acc=0.9750
2025-09-09 09:31:53,448 [INFO] [OOD 2d] Layer 30: acc=0.9650
2025-09-09 09:31:53,450 [INFO] [OOD 2d] Layer 31: acc=0.9450
2025-09-09 09:31:53,451 [INFO] [OOD 2d] Layer 32: acc=0.9450
2025-09-09 09:31:53,451 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:31:57,939 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:31:57,942 [INFO] [OOD 3d] Layer 1: acc=0.2767
2025-09-09 09:31:57,944 [INFO] [OOD 3d] Layer 2: acc=0.3867
2025-09-09 09:31:57,945 [INFO] [OOD 3d] Layer 3: acc=0.5633
2025-09-09 09:31:57,947 [INFO] [OOD 3d] Layer 4: acc=0.7200
2025-09-09 09:31:57,949 [INFO] [OOD 3d] Layer 5: acc=0.6733
2025-09-09 09:31:57,950 [INFO] [OOD 3d] Layer 6: acc=0.6733
2025-09-09 09:31:57,952 [INFO] [OOD 3d] Layer 7: acc=0.7933
2025-09-09 09:31:57,954 [INFO] [OOD 3d] Layer 8: acc=0.8100
2025-09-09 09:31:57,955 [INFO] [OOD 3d] Layer 9: acc=0.9267
2025-09-09 09:31:57,957 [INFO] [OOD 3d] Layer 10: acc=0.9233
2025-09-09 09:31:57,958 [INFO] [OOD 3d] Layer 11: acc=0.9200
2025-09-09 09:31:57,960 [INFO] [OOD 3d] Layer 12: acc=0.9333
2025-09-09 09:31:57,962 [INFO] [OOD 3d] Layer 13: acc=0.9433
2025-09-09 09:31:57,963 [INFO] [OOD 3d] Layer 14: acc=0.9933
2025-09-09 09:31:57,965 [INFO] [OOD 3d] Layer 15: acc=0.9967
2025-09-09 09:31:57,966 [INFO] [OOD 3d] Layer 16: acc=0.9400
2025-09-09 09:31:57,968 [INFO] [OOD 3d] Layer 17: acc=0.8133
2025-09-09 09:31:57,970 [INFO] [OOD 3d] Layer 18: acc=0.7867
2025-09-09 09:31:57,971 [INFO] [OOD 3d] Layer 19: acc=0.8267
2025-09-09 09:31:57,973 [INFO] [OOD 3d] Layer 20: acc=0.8333
2025-09-09 09:31:57,975 [INFO] [OOD 3d] Layer 21: acc=0.8033
2025-09-09 09:31:57,977 [INFO] [OOD 3d] Layer 22: acc=0.7933
2025-09-09 09:31:57,978 [INFO] [OOD 3d] Layer 23: acc=0.7933
2025-09-09 09:31:57,980 [INFO] [OOD 3d] Layer 24: acc=0.7800
2025-09-09 09:31:57,981 [INFO] [OOD 3d] Layer 25: acc=0.7667
2025-09-09 09:31:57,983 [INFO] [OOD 3d] Layer 26: acc=0.7700
2025-09-09 09:31:57,984 [INFO] [OOD 3d] Layer 27: acc=0.7333
2025-09-09 09:31:57,986 [INFO] [OOD 3d] Layer 28: acc=0.7367
2025-09-09 09:31:57,987 [INFO] [OOD 3d] Layer 29: acc=0.7567
2025-09-09 09:31:57,989 [INFO] [OOD 3d] Layer 30: acc=0.7500
2025-09-09 09:31:57,991 [INFO] [OOD 3d] Layer 31: acc=0.7333
2025-09-09 09:31:57,993 [INFO] [OOD 3d] Layer 32: acc=0.7100
2025-09-09 09:31:57,993 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:32:03,480 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:32:03,483 [INFO] [OOD 4d] Layer 1: acc=0.3333
2025-09-09 09:32:03,485 [INFO] [OOD 4d] Layer 2: acc=0.3333
2025-09-09 09:32:03,486 [INFO] [OOD 4d] Layer 3: acc=0.6033
2025-09-09 09:32:03,488 [INFO] [OOD 4d] Layer 4: acc=0.6900
2025-09-09 09:32:03,490 [INFO] [OOD 4d] Layer 5: acc=0.6667
2025-09-09 09:32:03,491 [INFO] [OOD 4d] Layer 6: acc=0.6667
2025-09-09 09:32:03,493 [INFO] [OOD 4d] Layer 7: acc=0.6933
2025-09-09 09:32:03,494 [INFO] [OOD 4d] Layer 8: acc=0.6733
2025-09-09 09:32:03,496 [INFO] [OOD 4d] Layer 9: acc=0.7467
2025-09-09 09:32:03,498 [INFO] [OOD 4d] Layer 10: acc=0.6000
2025-09-09 09:32:03,499 [INFO] [OOD 4d] Layer 11: acc=0.7867
2025-09-09 09:32:03,501 [INFO] [OOD 4d] Layer 12: acc=0.9433
2025-09-09 09:32:03,503 [INFO] [OOD 4d] Layer 13: acc=0.8367
2025-09-09 09:32:03,504 [INFO] [OOD 4d] Layer 14: acc=0.9933
2025-09-09 09:32:03,506 [INFO] [OOD 4d] Layer 15: acc=0.9667
2025-09-09 09:32:03,507 [INFO] [OOD 4d] Layer 16: acc=0.9200
2025-09-09 09:32:03,509 [INFO] [OOD 4d] Layer 17: acc=0.8200
2025-09-09 09:32:03,511 [INFO] [OOD 4d] Layer 18: acc=0.8100
2025-09-09 09:32:03,512 [INFO] [OOD 4d] Layer 19: acc=0.8300
2025-09-09 09:32:03,514 [INFO] [OOD 4d] Layer 20: acc=0.8233
2025-09-09 09:32:03,515 [INFO] [OOD 4d] Layer 21: acc=0.7600
2025-09-09 09:32:03,517 [INFO] [OOD 4d] Layer 22: acc=0.7367
2025-09-09 09:32:03,519 [INFO] [OOD 4d] Layer 23: acc=0.7167
2025-09-09 09:32:03,520 [INFO] [OOD 4d] Layer 24: acc=0.7167
2025-09-09 09:32:03,522 [INFO] [OOD 4d] Layer 25: acc=0.7367
2025-09-09 09:32:03,524 [INFO] [OOD 4d] Layer 26: acc=0.6800
2025-09-09 09:32:03,525 [INFO] [OOD 4d] Layer 27: acc=0.7000
2025-09-09 09:32:03,527 [INFO] [OOD 4d] Layer 28: acc=0.7067
2025-09-09 09:32:03,529 [INFO] [OOD 4d] Layer 29: acc=0.7200
2025-09-09 09:32:03,530 [INFO] [OOD 4d] Layer 30: acc=0.6767
2025-09-09 09:32:03,531 [INFO] [OOD 4d] Layer 31: acc=0.6733
2025-09-09 09:32:03,533 [INFO] [OOD 4d] Layer 32: acc=0.5267
2025-09-09 09:32:03,534 [INFO] ==================== RUN 5/5 (Seed: 46) ====================
2025-09-09 09:32:03,534 [INFO] Using device: cuda:0
2025-09-09 09:32:03,537 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:32:03,537 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:32:03,539 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:32:03,540 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:32:03,540 [INFO] [TRAIN_COMM_3WAY_Run5] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:32:25,791 [INFO] [TRAIN_COMM_3WAY_Run5] Finished extracting activations.
2025-09-09 09:32:25,793 [INFO] Per-layer classification reports -> ./outputs/llama/run_seed_46/probe_3way_comm_llama_seed_46_20250909_093225.txt
2025-09-09 09:32:25,794 [INFO] --- Starting Probe Training Loop for layers 1..32 ---
2025-09-09 09:32:25,794 [INFO] --- Processing Layer 1 ---
2025-09-09 09:32:26,061 [INFO] Layer 1 - Training completed.
2025-09-09 09:32:26,062 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_1/state_dict.pt
2025-09-09 09:32:26,077 [INFO] Layer 1 - Test Acc: 0.3900 | F1(C0,C1,C2): 0.283, 0.531, 0.000
2025-09-09 09:32:26,077 [INFO] --- Processing Layer 2 ---
2025-09-09 09:32:26,337 [INFO] Layer 2 - Training completed.
2025-09-09 09:32:26,338 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_2/state_dict.pt
2025-09-09 09:32:26,351 [INFO] Layer 2 - Test Acc: 0.5433 | F1(C0,C1,C2): 0.623, 0.606, 0.262
2025-09-09 09:32:26,351 [INFO] --- Processing Layer 3 ---
2025-09-09 09:32:26,614 [INFO] Layer 3 - Training completed.
2025-09-09 09:32:26,615 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_3/state_dict.pt
2025-09-09 09:32:26,629 [INFO] Layer 3 - Test Acc: 0.7833 | F1(C0,C1,C2): 0.828, 0.718, 0.786
2025-09-09 09:32:26,629 [INFO] --- Processing Layer 4 ---
2025-09-09 09:32:26,891 [INFO] Layer 4 - Training completed.
2025-09-09 09:32:26,893 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_4/state_dict.pt
2025-09-09 09:32:26,906 [INFO] Layer 4 - Test Acc: 0.9633 | F1(C0,C1,C2): 0.943, 0.966, 0.980
2025-09-09 09:32:26,907 [INFO] --- Processing Layer 5 ---
2025-09-09 09:32:27,168 [INFO] Layer 5 - Training completed.
2025-09-09 09:32:27,169 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_5/state_dict.pt
2025-09-09 09:32:27,182 [INFO] Layer 5 - Test Acc: 0.9767 | F1(C0,C1,C2): 0.964, 0.980, 0.985
2025-09-09 09:32:27,182 [INFO] --- Processing Layer 6 ---
2025-09-09 09:32:27,439 [INFO] Layer 6 - Training completed.
2025-09-09 09:32:27,439 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_6/state_dict.pt
2025-09-09 09:32:27,453 [INFO] Layer 6 - Test Acc: 0.9467 | F1(C0,C1,C2): 0.913, 0.935, 0.990
2025-09-09 09:32:27,453 [INFO] --- Processing Layer 7 ---
2025-09-09 09:32:27,714 [INFO] Layer 7 - Training completed.
2025-09-09 09:32:27,715 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_7/state_dict.pt
2025-09-09 09:32:27,728 [INFO] Layer 7 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.990, 0.990
2025-09-09 09:32:27,729 [INFO] --- Processing Layer 8 ---
2025-09-09 09:32:27,986 [INFO] Layer 8 - Training completed.
2025-09-09 09:32:27,987 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_8/state_dict.pt
2025-09-09 09:32:28,001 [INFO] Layer 8 - Test Acc: 0.9567 | F1(C0,C1,C2): 0.930, 0.948, 0.990
2025-09-09 09:32:28,001 [INFO] --- Processing Layer 9 ---
2025-09-09 09:32:28,258 [INFO] Layer 9 - Training completed.
2025-09-09 09:32:28,259 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_9/state_dict.pt
2025-09-09 09:32:28,273 [INFO] Layer 9 - Test Acc: 0.9767 | F1(C0,C1,C2): 0.965, 0.975, 0.990
2025-09-09 09:32:28,273 [INFO] --- Processing Layer 10 ---
2025-09-09 09:32:28,529 [INFO] Layer 10 - Training completed.
2025-09-09 09:32:28,530 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_10/state_dict.pt
2025-09-09 09:32:28,543 [INFO] Layer 10 - Test Acc: 0.9767 | F1(C0,C1,C2): 0.966, 0.964, 1.000
2025-09-09 09:32:28,544 [INFO] --- Processing Layer 11 ---
2025-09-09 09:32:28,800 [INFO] Layer 11 - Training completed.
2025-09-09 09:32:28,801 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_11/state_dict.pt
2025-09-09 09:32:28,814 [INFO] Layer 11 - Test Acc: 0.9500 | F1(C0,C1,C2): 0.919, 0.930, 1.000
2025-09-09 09:32:28,815 [INFO] --- Processing Layer 12 ---
2025-09-09 09:32:29,070 [INFO] Layer 12 - Training completed.
2025-09-09 09:32:29,071 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_12/state_dict.pt
2025-09-09 09:32:29,085 [INFO] Layer 12 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.975, 0.975, 1.000
2025-09-09 09:32:29,085 [INFO] --- Processing Layer 13 ---
2025-09-09 09:32:29,342 [INFO] Layer 13 - Training completed.
2025-09-09 09:32:29,343 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_13/state_dict.pt
2025-09-09 09:32:29,357 [INFO] Layer 13 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.975, 0.975, 1.000
2025-09-09 09:32:29,357 [INFO] --- Processing Layer 14 ---
2025-09-09 09:32:29,614 [INFO] Layer 14 - Training completed.
2025-09-09 09:32:29,614 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_14/state_dict.pt
2025-09-09 09:32:29,628 [INFO] Layer 14 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:32:29,628 [INFO] --- Processing Layer 15 ---
2025-09-09 09:32:29,883 [INFO] Layer 15 - Training completed.
2025-09-09 09:32:29,885 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_15/state_dict.pt
2025-09-09 09:32:29,898 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:32:29,898 [INFO] --- Processing Layer 16 ---
2025-09-09 09:32:30,154 [INFO] Layer 16 - Training completed.
2025-09-09 09:32:30,155 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_16/state_dict.pt
2025-09-09 09:32:30,169 [INFO] Layer 16 - Test Acc: 0.9767 | F1(C0,C1,C2): 0.964, 0.966, 1.000
2025-09-09 09:32:30,169 [INFO] --- Processing Layer 17 ---
2025-09-09 09:32:30,425 [INFO] Layer 17 - Training completed.
2025-09-09 09:32:30,426 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_17/state_dict.pt
2025-09-09 09:32:30,440 [INFO] Layer 17 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:32:30,440 [INFO] --- Processing Layer 18 ---
2025-09-09 09:32:30,699 [INFO] Layer 18 - Training completed.
2025-09-09 09:32:30,700 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_18/state_dict.pt
2025-09-09 09:32:30,714 [INFO] Layer 18 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.974, 0.976, 1.000
2025-09-09 09:32:30,714 [INFO] --- Processing Layer 19 ---
2025-09-09 09:32:30,975 [INFO] Layer 19 - Training completed.
2025-09-09 09:32:30,976 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_19/state_dict.pt
2025-09-09 09:32:30,990 [INFO] Layer 19 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:32:30,990 [INFO] --- Processing Layer 20 ---
2025-09-09 09:32:31,248 [INFO] Layer 20 - Training completed.
2025-09-09 09:32:31,249 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_20/state_dict.pt
2025-09-09 09:32:31,263 [INFO] Layer 20 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:32:31,263 [INFO] --- Processing Layer 21 ---
2025-09-09 09:32:31,526 [INFO] Layer 21 - Training completed.
2025-09-09 09:32:31,527 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_21/state_dict.pt
2025-09-09 09:32:31,541 [INFO] Layer 21 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.974, 0.976, 1.000
2025-09-09 09:32:31,541 [INFO] --- Processing Layer 22 ---
2025-09-09 09:32:31,796 [INFO] Layer 22 - Training completed.
2025-09-09 09:32:31,797 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_22/state_dict.pt
2025-09-09 09:32:31,810 [INFO] Layer 22 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:32:31,810 [INFO] --- Processing Layer 23 ---
2025-09-09 09:32:32,065 [INFO] Layer 23 - Training completed.
2025-09-09 09:32:32,066 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_23/state_dict.pt
2025-09-09 09:32:32,080 [INFO] Layer 23 - Test Acc: 0.9800 | F1(C0,C1,C2): 0.969, 0.971, 1.000
2025-09-09 09:32:32,080 [INFO] --- Processing Layer 24 ---
2025-09-09 09:32:32,335 [INFO] Layer 24 - Training completed.
2025-09-09 09:32:32,337 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_24/state_dict.pt
2025-09-09 09:32:32,350 [INFO] Layer 24 - Test Acc: 0.9767 | F1(C0,C1,C2): 0.964, 0.966, 1.000
2025-09-09 09:32:32,350 [INFO] --- Processing Layer 25 ---
2025-09-09 09:32:32,607 [INFO] Layer 25 - Training completed.
2025-09-09 09:32:32,608 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_25/state_dict.pt
2025-09-09 09:32:32,622 [INFO] Layer 25 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.980, 1.000
2025-09-09 09:32:32,622 [INFO] --- Processing Layer 26 ---
2025-09-09 09:32:32,875 [INFO] Layer 26 - Training completed.
2025-09-09 09:32:32,877 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_26/state_dict.pt
2025-09-09 09:32:32,890 [INFO] Layer 26 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.974, 0.976, 1.000
2025-09-09 09:32:32,890 [INFO] --- Processing Layer 27 ---
2025-09-09 09:32:33,146 [INFO] Layer 27 - Training completed.
2025-09-09 09:32:33,147 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_27/state_dict.pt
2025-09-09 09:32:33,160 [INFO] Layer 27 - Test Acc: 0.9700 | F1(C0,C1,C2): 0.953, 0.957, 1.000
2025-09-09 09:32:33,161 [INFO] --- Processing Layer 28 ---
2025-09-09 09:32:33,417 [INFO] Layer 28 - Training completed.
2025-09-09 09:32:33,418 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_28/state_dict.pt
2025-09-09 09:32:33,433 [INFO] Layer 28 - Test Acc: 0.9733 | F1(C0,C1,C2): 0.958, 0.962, 1.000
2025-09-09 09:32:33,434 [INFO] --- Processing Layer 29 ---
2025-09-09 09:32:33,695 [INFO] Layer 29 - Training completed.
2025-09-09 09:32:33,697 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_29/state_dict.pt
2025-09-09 09:32:33,710 [INFO] Layer 29 - Test Acc: 0.9733 | F1(C0,C1,C2): 0.959, 0.961, 1.000
2025-09-09 09:32:33,710 [INFO] --- Processing Layer 30 ---
2025-09-09 09:32:33,969 [INFO] Layer 30 - Training completed.
2025-09-09 09:32:33,970 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_30/state_dict.pt
2025-09-09 09:32:33,983 [INFO] Layer 30 - Test Acc: 0.9600 | F1(C0,C1,C2): 0.939, 0.941, 1.000
2025-09-09 09:32:33,984 [INFO] --- Processing Layer 31 ---
2025-09-09 09:32:34,244 [INFO] Layer 31 - Training completed.
2025-09-09 09:32:34,245 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_31/state_dict.pt
2025-09-09 09:32:34,259 [INFO] Layer 31 - Test Acc: 0.9600 | F1(C0,C1,C2): 0.939, 0.941, 1.000
2025-09-09 09:32:34,259 [INFO] --- Processing Layer 32 ---
2025-09-09 09:32:34,523 [INFO] Layer 32 - Training completed.
2025-09-09 09:32:34,524 [INFO] Saved probe state_dict -> ./outputs/llama/run_seed_46/layer_32/state_dict.pt
2025-09-09 09:32:34,538 [INFO] Layer 32 - Test Acc: 0.9533 | F1(C0,C1,C2): 0.930, 0.930, 1.000
2025-09-09 09:32:34,538 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:32:34,538 [INFO] --- Generating OOD Datasets for Run 5 ---
2025-09-09 09:32:34,544 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:32:34,546 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:32:34,587 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:32:39,157 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:32:39,160 [INFO] [OOD 1d] Layer 1: acc=0.3333
2025-09-09 09:32:39,162 [INFO] [OOD 1d] Layer 2: acc=0.3900
2025-09-09 09:32:39,163 [INFO] [OOD 1d] Layer 3: acc=0.6067
2025-09-09 09:32:39,165 [INFO] [OOD 1d] Layer 4: acc=0.6033
2025-09-09 09:32:39,167 [INFO] [OOD 1d] Layer 5: acc=0.6267
2025-09-09 09:32:39,169 [INFO] [OOD 1d] Layer 6: acc=0.7533
2025-09-09 09:32:39,170 [INFO] [OOD 1d] Layer 7: acc=0.6900
2025-09-09 09:32:39,172 [INFO] [OOD 1d] Layer 8: acc=0.9733
2025-09-09 09:32:39,173 [INFO] [OOD 1d] Layer 9: acc=0.9667
2025-09-09 09:32:39,175 [INFO] [OOD 1d] Layer 10: acc=0.9367
2025-09-09 09:32:39,177 [INFO] [OOD 1d] Layer 11: acc=0.6400
2025-09-09 09:32:39,178 [INFO] [OOD 1d] Layer 12: acc=0.7967
2025-09-09 09:32:39,180 [INFO] [OOD 1d] Layer 13: acc=0.8967
2025-09-09 09:32:39,181 [INFO] [OOD 1d] Layer 14: acc=1.0000
2025-09-09 09:32:39,183 [INFO] [OOD 1d] Layer 15: acc=1.0000
2025-09-09 09:32:39,185 [INFO] [OOD 1d] Layer 16: acc=0.9667
2025-09-09 09:32:39,186 [INFO] [OOD 1d] Layer 17: acc=1.0000
2025-09-09 09:32:39,188 [INFO] [OOD 1d] Layer 18: acc=0.7600
2025-09-09 09:32:39,189 [INFO] [OOD 1d] Layer 19: acc=0.9433
2025-09-09 09:32:39,191 [INFO] [OOD 1d] Layer 20: acc=0.9500
2025-09-09 09:32:39,193 [INFO] [OOD 1d] Layer 21: acc=0.8733
2025-09-09 09:32:39,194 [INFO] [OOD 1d] Layer 22: acc=0.9567
2025-09-09 09:32:39,195 [INFO] [OOD 1d] Layer 23: acc=0.9433
2025-09-09 09:32:39,197 [INFO] [OOD 1d] Layer 24: acc=0.9333
2025-09-09 09:32:39,199 [INFO] [OOD 1d] Layer 25: acc=0.9567
2025-09-09 09:32:39,201 [INFO] [OOD 1d] Layer 26: acc=0.8267
2025-09-09 09:32:39,202 [INFO] [OOD 1d] Layer 27: acc=0.7967
2025-09-09 09:32:39,204 [INFO] [OOD 1d] Layer 28: acc=0.8733
2025-09-09 09:32:39,205 [INFO] [OOD 1d] Layer 29: acc=0.8933
2025-09-09 09:32:39,207 [INFO] [OOD 1d] Layer 30: acc=0.7867
2025-09-09 09:32:39,209 [INFO] [OOD 1d] Layer 31: acc=0.7167
2025-09-09 09:32:39,210 [INFO] [OOD 1d] Layer 32: acc=0.8433
2025-09-09 09:32:39,210 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:32:42,339 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:32:42,342 [INFO] [OOD 2d] Layer 1: acc=0.6150
2025-09-09 09:32:42,343 [INFO] [OOD 2d] Layer 2: acc=0.7600
2025-09-09 09:32:42,345 [INFO] [OOD 2d] Layer 3: acc=0.7400
2025-09-09 09:32:42,346 [INFO] [OOD 2d] Layer 4: acc=0.9050
2025-09-09 09:32:42,348 [INFO] [OOD 2d] Layer 5: acc=0.9700
2025-09-09 09:32:42,349 [INFO] [OOD 2d] Layer 6: acc=0.9150
2025-09-09 09:32:42,350 [INFO] [OOD 2d] Layer 7: acc=0.9700
2025-09-09 09:32:42,351 [INFO] [OOD 2d] Layer 8: acc=0.9650
2025-09-09 09:32:42,353 [INFO] [OOD 2d] Layer 9: acc=0.9750
2025-09-09 09:32:42,354 [INFO] [OOD 2d] Layer 10: acc=0.9600
2025-09-09 09:32:42,355 [INFO] [OOD 2d] Layer 11: acc=0.9050
2025-09-09 09:32:42,357 [INFO] [OOD 2d] Layer 12: acc=0.9450
2025-09-09 09:32:42,358 [INFO] [OOD 2d] Layer 13: acc=0.9650
2025-09-09 09:32:42,359 [INFO] [OOD 2d] Layer 14: acc=1.0000
2025-09-09 09:32:42,361 [INFO] [OOD 2d] Layer 15: acc=1.0000
2025-09-09 09:32:42,362 [INFO] [OOD 2d] Layer 16: acc=0.9750
2025-09-09 09:32:42,363 [INFO] [OOD 2d] Layer 17: acc=0.9850
2025-09-09 09:32:42,365 [INFO] [OOD 2d] Layer 18: acc=0.9700
2025-09-09 09:32:42,366 [INFO] [OOD 2d] Layer 19: acc=0.9800
2025-09-09 09:32:42,367 [INFO] [OOD 2d] Layer 20: acc=0.9900
2025-09-09 09:32:42,368 [INFO] [OOD 2d] Layer 21: acc=0.9900
2025-09-09 09:32:42,370 [INFO] [OOD 2d] Layer 22: acc=0.9650
2025-09-09 09:32:42,371 [INFO] [OOD 2d] Layer 23: acc=0.9700
2025-09-09 09:32:42,372 [INFO] [OOD 2d] Layer 24: acc=0.9650
2025-09-09 09:32:42,374 [INFO] [OOD 2d] Layer 25: acc=0.9750
2025-09-09 09:32:42,375 [INFO] [OOD 2d] Layer 26: acc=0.9850
2025-09-09 09:32:42,376 [INFO] [OOD 2d] Layer 27: acc=0.9800
2025-09-09 09:32:42,377 [INFO] [OOD 2d] Layer 28: acc=0.9650
2025-09-09 09:32:42,378 [INFO] [OOD 2d] Layer 29: acc=0.9900
2025-09-09 09:32:42,380 [INFO] [OOD 2d] Layer 30: acc=0.9550
2025-09-09 09:32:42,381 [INFO] [OOD 2d] Layer 31: acc=0.9550
2025-09-09 09:32:42,382 [INFO] [OOD 2d] Layer 32: acc=0.9550
2025-09-09 09:32:42,382 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:32:46,904 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:32:46,907 [INFO] [OOD 3d] Layer 1: acc=0.3333
2025-09-09 09:32:46,908 [INFO] [OOD 3d] Layer 2: acc=0.4633
2025-09-09 09:32:46,910 [INFO] [OOD 3d] Layer 3: acc=0.5733
2025-09-09 09:32:46,911 [INFO] [OOD 3d] Layer 4: acc=0.6667
2025-09-09 09:32:46,913 [INFO] [OOD 3d] Layer 5: acc=0.6667
2025-09-09 09:32:46,915 [INFO] [OOD 3d] Layer 6: acc=0.7000
2025-09-09 09:32:46,916 [INFO] [OOD 3d] Layer 7: acc=0.7500
2025-09-09 09:32:46,918 [INFO] [OOD 3d] Layer 8: acc=0.9000
2025-09-09 09:32:46,919 [INFO] [OOD 3d] Layer 9: acc=0.8933
2025-09-09 09:32:46,921 [INFO] [OOD 3d] Layer 10: acc=0.8833
2025-09-09 09:32:46,923 [INFO] [OOD 3d] Layer 11: acc=0.8333
2025-09-09 09:32:46,924 [INFO] [OOD 3d] Layer 12: acc=0.9000
2025-09-09 09:32:46,926 [INFO] [OOD 3d] Layer 13: acc=0.9400
2025-09-09 09:32:46,927 [INFO] [OOD 3d] Layer 14: acc=0.9967
2025-09-09 09:32:46,929 [INFO] [OOD 3d] Layer 15: acc=0.9967
2025-09-09 09:32:46,931 [INFO] [OOD 3d] Layer 16: acc=0.9533
2025-09-09 09:32:46,932 [INFO] [OOD 3d] Layer 17: acc=0.8300
2025-09-09 09:32:46,934 [INFO] [OOD 3d] Layer 18: acc=0.8267
2025-09-09 09:32:46,935 [INFO] [OOD 3d] Layer 19: acc=0.8333
2025-09-09 09:32:46,937 [INFO] [OOD 3d] Layer 20: acc=0.8367
2025-09-09 09:32:46,939 [INFO] [OOD 3d] Layer 21: acc=0.7767
2025-09-09 09:32:46,941 [INFO] [OOD 3d] Layer 22: acc=0.7500
2025-09-09 09:32:46,942 [INFO] [OOD 3d] Layer 23: acc=0.7500
2025-09-09 09:32:46,944 [INFO] [OOD 3d] Layer 24: acc=0.7633
2025-09-09 09:32:46,945 [INFO] [OOD 3d] Layer 25: acc=0.7500
2025-09-09 09:32:46,947 [INFO] [OOD 3d] Layer 26: acc=0.7667
2025-09-09 09:32:46,949 [INFO] [OOD 3d] Layer 27: acc=0.7667
2025-09-09 09:32:46,950 [INFO] [OOD 3d] Layer 28: acc=0.8100
2025-09-09 09:32:46,952 [INFO] [OOD 3d] Layer 29: acc=0.7900
2025-09-09 09:32:46,953 [INFO] [OOD 3d] Layer 30: acc=0.7800
2025-09-09 09:32:46,955 [INFO] [OOD 3d] Layer 31: acc=0.7600
2025-09-09 09:32:46,956 [INFO] [OOD 3d] Layer 32: acc=0.6933
2025-09-09 09:32:46,957 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:32:52,487 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:32:52,490 [INFO] [OOD 4d] Layer 1: acc=0.3333
2025-09-09 09:32:52,491 [INFO] [OOD 4d] Layer 2: acc=0.3900
2025-09-09 09:32:52,493 [INFO] [OOD 4d] Layer 3: acc=0.4900
2025-09-09 09:32:52,495 [INFO] [OOD 4d] Layer 4: acc=0.6733
2025-09-09 09:32:52,497 [INFO] [OOD 4d] Layer 5: acc=0.6667
2025-09-09 09:32:52,498 [INFO] [OOD 4d] Layer 6: acc=0.6667
2025-09-09 09:32:52,500 [INFO] [OOD 4d] Layer 7: acc=0.6800
2025-09-09 09:32:52,501 [INFO] [OOD 4d] Layer 8: acc=0.7100
2025-09-09 09:32:52,503 [INFO] [OOD 4d] Layer 9: acc=0.7300
2025-09-09 09:32:52,505 [INFO] [OOD 4d] Layer 10: acc=0.5667
2025-09-09 09:32:52,506 [INFO] [OOD 4d] Layer 11: acc=0.7300
2025-09-09 09:32:52,508 [INFO] [OOD 4d] Layer 12: acc=0.9367
2025-09-09 09:32:52,509 [INFO] [OOD 4d] Layer 13: acc=0.8433
2025-09-09 09:32:52,511 [INFO] [OOD 4d] Layer 14: acc=0.9933
2025-09-09 09:32:52,513 [INFO] [OOD 4d] Layer 15: acc=0.9467
2025-09-09 09:32:52,515 [INFO] [OOD 4d] Layer 16: acc=0.9400
2025-09-09 09:32:52,517 [INFO] [OOD 4d] Layer 17: acc=0.8067
2025-09-09 09:32:52,518 [INFO] [OOD 4d] Layer 18: acc=0.8000
2025-09-09 09:32:52,519 [INFO] [OOD 4d] Layer 19: acc=0.8333
2025-09-09 09:32:52,521 [INFO] [OOD 4d] Layer 20: acc=0.8133
2025-09-09 09:32:52,523 [INFO] [OOD 4d] Layer 21: acc=0.7700
2025-09-09 09:32:52,524 [INFO] [OOD 4d] Layer 22: acc=0.7467
2025-09-09 09:32:52,526 [INFO] [OOD 4d] Layer 23: acc=0.7500
2025-09-09 09:32:52,527 [INFO] [OOD 4d] Layer 24: acc=0.7633
2025-09-09 09:32:52,529 [INFO] [OOD 4d] Layer 25: acc=0.6867
2025-09-09 09:32:52,530 [INFO] [OOD 4d] Layer 26: acc=0.7167
2025-09-09 09:32:52,532 [INFO] [OOD 4d] Layer 27: acc=0.7000
2025-09-09 09:32:52,534 [INFO] [OOD 4d] Layer 28: acc=0.7233
2025-09-09 09:32:52,535 [INFO] [OOD 4d] Layer 29: acc=0.7233
2025-09-09 09:32:52,537 [INFO] [OOD 4d] Layer 30: acc=0.7300
2025-09-09 09:32:52,538 [INFO] [OOD 4d] Layer 31: acc=0.7133
2025-09-09 09:32:52,540 [INFO] [OOD 4d] Layer 32: acc=0.5000
2025-09-09 09:32:52,541 [INFO] --- Generating Final Aggregated Plots (with CI) ---
2025-09-09 09:32:53,413 [INFO] Saved aggregated per-layer line chart (PDF) -> ./outputs/llama/AGG_probe_comm_generalisation_line_llama_20250909_093252.pdf
2025-09-09 09:32:53,619 [INFO] Saved aggregated mean-accuracy bar chart (PDF) -> ./outputs/llama/AGG_probe_comm_generalisation_bar_llama_20250909_093252.pdf
2025-09-09 09:32:53,619 [INFO] --- All Runs and Aggregated Plotting Finished (this model) ---
2025-09-09 09:32:53,619 [INFO] Unified output dir (this model): ./outputs/llama
