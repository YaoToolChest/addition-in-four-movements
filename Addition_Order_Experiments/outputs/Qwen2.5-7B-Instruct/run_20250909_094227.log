2025-09-09 09:42:27,734 [INFO] ======= Logger initialized =======
2025-09-09 09:42:27,734 [INFO] Log file: ./outputs/Qwen2.5-7B-Instruct/run_20250909_094227.log
2025-09-09 09:42:27,735 [INFO] Using device: cuda:0
2025-09-09 09:42:27,735 [INFO] Loading model: /root/autodl-tmp/Qwen2.5-7B-Instruct ...
2025-09-09 09:42:34,398 [INFO] Model and tokenizer loaded successfully.
2025-09-09 09:42:34,439 [INFO] [Auto] hidden_states length = 29; probing indices = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:42:34,439 [INFO] Final LAYERS_TO_PROBE for Qwen2.5-7B-Instruct: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:42:34,439 [INFO] Determining probe input dimension...
2025-09-09 09:42:34,439 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:42:34,439 [INFO] Target: 10 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:42:34,439 [INFO] Generated final dataset with 30 samples.
2025-09-09 09:42:34,439 [INFO] Final label distribution: {0: 10, 1: 10, 2: 10}
2025-09-09 09:42:34,439 [INFO] [PLACEHOLDER] Extracting activations for 30 prompts, layers=[1]
2025-09-09 09:42:35,226 [INFO] [PLACEHOLDER] Finished extracting activations.
2025-09-09 09:42:35,227 [INFO] Determined fixed probe input dimension: 3584
2025-09-09 09:42:35,227 [INFO] ==================== RUN 1/5 (Seed: 42) ====================
2025-09-09 09:42:35,227 [INFO] Using device: cuda:0
2025-09-09 09:42:35,231 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:42:35,231 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:42:35,233 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:42:35,234 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:42:35,234 [INFO] [TRAIN_COMM_3WAY_Run1] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:42:59,089 [INFO] [TRAIN_COMM_3WAY_Run1] Finished extracting activations.
2025-09-09 09:42:59,092 [INFO] Per-layer classification reports -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/probe_3way_comm_Qwen2.5-7B-Instruct_seed_42_20250909_094259.txt
2025-09-09 09:42:59,092 [INFO] --- Starting Probe Training Loop for layers 1..28 ---
2025-09-09 09:42:59,093 [INFO] --- Processing Layer 1 ---
2025-09-09 09:42:59,366 [INFO] Layer 1 - Training completed.
2025-09-09 09:42:59,367 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_1/state_dict.pt
2025-09-09 09:42:59,382 [INFO] Layer 1 - Test Acc: 0.4433 | F1(C0,C1,C2): 0.511, 0.559, 0.037
2025-09-09 09:42:59,382 [INFO] --- Processing Layer 2 ---
2025-09-09 09:42:59,648 [INFO] Layer 2 - Training completed.
2025-09-09 09:42:59,650 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_2/state_dict.pt
2025-09-09 09:42:59,663 [INFO] Layer 2 - Test Acc: 0.7267 | F1(C0,C1,C2): 0.758, 0.772, 0.641
2025-09-09 09:42:59,663 [INFO] --- Processing Layer 3 ---
2025-09-09 09:42:59,931 [INFO] Layer 3 - Training completed.
2025-09-09 09:42:59,933 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_3/state_dict.pt
2025-09-09 09:42:59,946 [INFO] Layer 3 - Test Acc: 0.6467 | F1(C0,C1,C2): 0.827, 0.683, 0.267
2025-09-09 09:42:59,946 [INFO] --- Processing Layer 4 ---
2025-09-09 09:43:00,215 [INFO] Layer 4 - Training completed.
2025-09-09 09:43:00,216 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_4/state_dict.pt
2025-09-09 09:43:00,230 [INFO] Layer 4 - Test Acc: 0.9400 | F1(C0,C1,C2): 0.946, 0.914, 0.957
2025-09-09 09:43:00,230 [INFO] --- Processing Layer 5 ---
2025-09-09 09:43:00,500 [INFO] Layer 5 - Training completed.
2025-09-09 09:43:00,501 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_5/state_dict.pt
2025-09-09 09:43:00,515 [INFO] Layer 5 - Test Acc: 0.9500 | F1(C0,C1,C2): 0.919, 0.930, 1.000
2025-09-09 09:43:00,515 [INFO] --- Processing Layer 6 ---
2025-09-09 09:43:00,782 [INFO] Layer 6 - Training completed.
2025-09-09 09:43:00,783 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_6/state_dict.pt
2025-09-09 09:43:00,797 [INFO] Layer 6 - Test Acc: 0.9667 | F1(C0,C1,C2): 0.947, 0.952, 1.000
2025-09-09 09:43:00,797 [INFO] --- Processing Layer 7 ---
2025-09-09 09:43:01,074 [INFO] Layer 7 - Training completed.
2025-09-09 09:43:01,075 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_7/state_dict.pt
2025-09-09 09:43:01,089 [INFO] Layer 7 - Test Acc: 0.9533 | F1(C0,C1,C2): 0.934, 0.926, 1.000
2025-09-09 09:43:01,089 [INFO] --- Processing Layer 8 ---
2025-09-09 09:43:01,353 [INFO] Layer 8 - Training completed.
2025-09-09 09:43:01,353 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_8/state_dict.pt
2025-09-09 09:43:01,367 [INFO] Layer 8 - Test Acc: 0.9600 | F1(C0,C1,C2): 0.943, 0.937, 1.000
2025-09-09 09:43:01,367 [INFO] --- Processing Layer 9 ---
2025-09-09 09:43:01,636 [INFO] Layer 9 - Training completed.
2025-09-09 09:43:01,637 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_9/state_dict.pt
2025-09-09 09:43:01,650 [INFO] Layer 9 - Test Acc: 0.9467 | F1(C0,C1,C2): 0.913, 0.926, 1.000
2025-09-09 09:43:01,651 [INFO] --- Processing Layer 10 ---
2025-09-09 09:43:01,917 [INFO] Layer 10 - Training completed.
2025-09-09 09:43:01,918 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_10/state_dict.pt
2025-09-09 09:43:01,932 [INFO] Layer 10 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:43:01,933 [INFO] --- Processing Layer 11 ---
2025-09-09 09:43:02,201 [INFO] Layer 11 - Training completed.
2025-09-09 09:43:02,202 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_11/state_dict.pt
2025-09-09 09:43:02,216 [INFO] Layer 11 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:43:02,216 [INFO] --- Processing Layer 12 ---
2025-09-09 09:43:02,487 [INFO] Layer 12 - Training completed.
2025-09-09 09:43:02,488 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_12/state_dict.pt
2025-09-09 09:43:02,502 [INFO] Layer 12 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:43:02,502 [INFO] --- Processing Layer 13 ---
2025-09-09 09:43:02,770 [INFO] Layer 13 - Training completed.
2025-09-09 09:43:02,771 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_13/state_dict.pt
2025-09-09 09:43:02,785 [INFO] Layer 13 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:43:02,786 [INFO] --- Processing Layer 14 ---
2025-09-09 09:43:03,057 [INFO] Layer 14 - Training completed.
2025-09-09 09:43:03,058 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_14/state_dict.pt
2025-09-09 09:43:03,071 [INFO] Layer 14 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:03,071 [INFO] --- Processing Layer 15 ---
2025-09-09 09:43:03,338 [INFO] Layer 15 - Training completed.
2025-09-09 09:43:03,339 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_15/state_dict.pt
2025-09-09 09:43:03,353 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:03,353 [INFO] --- Processing Layer 16 ---
2025-09-09 09:43:03,622 [INFO] Layer 16 - Training completed.
2025-09-09 09:43:03,623 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_16/state_dict.pt
2025-09-09 09:43:03,637 [INFO] Layer 16 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:03,637 [INFO] --- Processing Layer 17 ---
2025-09-09 09:43:03,903 [INFO] Layer 17 - Training completed.
2025-09-09 09:43:03,905 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_17/state_dict.pt
2025-09-09 09:43:03,918 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:03,919 [INFO] --- Processing Layer 18 ---
2025-09-09 09:43:04,203 [INFO] Layer 18 - Training completed.
2025-09-09 09:43:04,204 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_18/state_dict.pt
2025-09-09 09:43:04,218 [INFO] Layer 18 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:43:04,218 [INFO] --- Processing Layer 19 ---
2025-09-09 09:43:04,485 [INFO] Layer 19 - Training completed.
2025-09-09 09:43:04,486 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_19/state_dict.pt
2025-09-09 09:43:04,500 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:04,500 [INFO] --- Processing Layer 20 ---
2025-09-09 09:43:04,767 [INFO] Layer 20 - Training completed.
2025-09-09 09:43:04,768 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_20/state_dict.pt
2025-09-09 09:43:04,782 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:04,782 [INFO] --- Processing Layer 21 ---
2025-09-09 09:43:05,054 [INFO] Layer 21 - Training completed.
2025-09-09 09:43:05,055 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_21/state_dict.pt
2025-09-09 09:43:05,069 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:05,069 [INFO] --- Processing Layer 22 ---
2025-09-09 09:43:05,337 [INFO] Layer 22 - Training completed.
2025-09-09 09:43:05,338 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_22/state_dict.pt
2025-09-09 09:43:05,352 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:05,352 [INFO] --- Processing Layer 23 ---
2025-09-09 09:43:05,619 [INFO] Layer 23 - Training completed.
2025-09-09 09:43:05,619 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_23/state_dict.pt
2025-09-09 09:43:05,633 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:05,633 [INFO] --- Processing Layer 24 ---
2025-09-09 09:43:05,900 [INFO] Layer 24 - Training completed.
2025-09-09 09:43:05,901 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_24/state_dict.pt
2025-09-09 09:43:05,914 [INFO] Layer 24 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:05,915 [INFO] --- Processing Layer 25 ---
2025-09-09 09:43:06,201 [INFO] Layer 25 - Training completed.
2025-09-09 09:43:06,202 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_25/state_dict.pt
2025-09-09 09:43:06,215 [INFO] Layer 25 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:06,215 [INFO] --- Processing Layer 26 ---
2025-09-09 09:43:06,489 [INFO] Layer 26 - Training completed.
2025-09-09 09:43:06,490 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_26/state_dict.pt
2025-09-09 09:43:06,504 [INFO] Layer 26 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:06,504 [INFO] --- Processing Layer 27 ---
2025-09-09 09:43:06,779 [INFO] Layer 27 - Training completed.
2025-09-09 09:43:06,780 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_27/state_dict.pt
2025-09-09 09:43:06,793 [INFO] Layer 27 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:06,794 [INFO] --- Processing Layer 28 ---
2025-09-09 09:43:07,059 [INFO] Layer 28 - Training completed.
2025-09-09 09:43:07,061 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_42/layer_28/state_dict.pt
2025-09-09 09:43:07,074 [INFO] Layer 28 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:43:07,074 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:43:07,075 [INFO] --- Generating OOD Datasets for Run 1 ---
2025-09-09 09:43:07,080 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:43:07,082 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:43:07,119 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:43:11,153 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:43:11,155 [INFO] [OOD 1d] Layer 1: acc=0.5067
2025-09-09 09:43:11,157 [INFO] [OOD 1d] Layer 2: acc=0.4000
2025-09-09 09:43:11,158 [INFO] [OOD 1d] Layer 3: acc=0.4067
2025-09-09 09:43:11,159 [INFO] [OOD 1d] Layer 4: acc=0.3333
2025-09-09 09:43:11,161 [INFO] [OOD 1d] Layer 5: acc=0.8967
2025-09-09 09:43:11,163 [INFO] [OOD 1d] Layer 6: acc=0.8133
2025-09-09 09:43:11,164 [INFO] [OOD 1d] Layer 7: acc=0.9467
2025-09-09 09:43:11,166 [INFO] [OOD 1d] Layer 8: acc=0.6667
2025-09-09 09:43:11,167 [INFO] [OOD 1d] Layer 9: acc=0.7700
2025-09-09 09:43:11,169 [INFO] [OOD 1d] Layer 10: acc=0.8267
2025-09-09 09:43:11,170 [INFO] [OOD 1d] Layer 11: acc=0.8867
2025-09-09 09:43:11,171 [INFO] [OOD 1d] Layer 12: acc=0.9267
2025-09-09 09:43:11,173 [INFO] [OOD 1d] Layer 13: acc=0.9267
2025-09-09 09:43:11,175 [INFO] [OOD 1d] Layer 14: acc=0.9833
2025-09-09 09:43:11,176 [INFO] [OOD 1d] Layer 15: acc=0.8933
2025-09-09 09:43:11,178 [INFO] [OOD 1d] Layer 16: acc=0.8433
2025-09-09 09:43:11,179 [INFO] [OOD 1d] Layer 17: acc=0.8967
2025-09-09 09:43:11,181 [INFO] [OOD 1d] Layer 18: acc=0.8867
2025-09-09 09:43:11,182 [INFO] [OOD 1d] Layer 19: acc=0.8467
2025-09-09 09:43:11,184 [INFO] [OOD 1d] Layer 20: acc=0.9633
2025-09-09 09:43:11,185 [INFO] [OOD 1d] Layer 21: acc=0.9333
2025-09-09 09:43:11,187 [INFO] [OOD 1d] Layer 22: acc=1.0000
2025-09-09 09:43:11,188 [INFO] [OOD 1d] Layer 23: acc=0.9900
2025-09-09 09:43:11,190 [INFO] [OOD 1d] Layer 24: acc=0.9700
2025-09-09 09:43:11,191 [INFO] [OOD 1d] Layer 25: acc=0.9867
2025-09-09 09:43:11,193 [INFO] [OOD 1d] Layer 26: acc=0.8900
2025-09-09 09:43:11,194 [INFO] [OOD 1d] Layer 27: acc=0.7567
2025-09-09 09:43:11,196 [INFO] [OOD 1d] Layer 28: acc=1.0000
2025-09-09 09:43:11,196 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:43:14,471 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:43:14,473 [INFO] [OOD 2d] Layer 1: acc=0.7400
2025-09-09 09:43:14,474 [INFO] [OOD 2d] Layer 2: acc=0.8250
2025-09-09 09:43:14,475 [INFO] [OOD 2d] Layer 3: acc=0.8950
2025-09-09 09:43:14,477 [INFO] [OOD 2d] Layer 4: acc=0.9100
2025-09-09 09:43:14,478 [INFO] [OOD 2d] Layer 5: acc=0.9050
2025-09-09 09:43:14,479 [INFO] [OOD 2d] Layer 6: acc=0.9350
2025-09-09 09:43:14,480 [INFO] [OOD 2d] Layer 7: acc=0.9650
2025-09-09 09:43:14,482 [INFO] [OOD 2d] Layer 8: acc=0.9550
2025-09-09 09:43:14,483 [INFO] [OOD 2d] Layer 9: acc=0.9150
2025-09-09 09:43:14,484 [INFO] [OOD 2d] Layer 10: acc=1.0000
2025-09-09 09:43:14,485 [INFO] [OOD 2d] Layer 11: acc=1.0000
2025-09-09 09:43:14,486 [INFO] [OOD 2d] Layer 12: acc=1.0000
2025-09-09 09:43:14,487 [INFO] [OOD 2d] Layer 13: acc=1.0000
2025-09-09 09:43:14,489 [INFO] [OOD 2d] Layer 14: acc=1.0000
2025-09-09 09:43:14,490 [INFO] [OOD 2d] Layer 15: acc=1.0000
2025-09-09 09:43:14,491 [INFO] [OOD 2d] Layer 16: acc=1.0000
2025-09-09 09:43:14,493 [INFO] [OOD 2d] Layer 17: acc=1.0000
2025-09-09 09:43:14,494 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:43:14,495 [INFO] [OOD 2d] Layer 19: acc=1.0000
2025-09-09 09:43:14,496 [INFO] [OOD 2d] Layer 20: acc=0.9950
2025-09-09 09:43:14,497 [INFO] [OOD 2d] Layer 21: acc=0.9900
2025-09-09 09:43:14,498 [INFO] [OOD 2d] Layer 22: acc=0.9950
2025-09-09 09:43:14,499 [INFO] [OOD 2d] Layer 23: acc=0.9950
2025-09-09 09:43:14,501 [INFO] [OOD 2d] Layer 24: acc=1.0000
2025-09-09 09:43:14,502 [INFO] [OOD 2d] Layer 25: acc=1.0000
2025-09-09 09:43:14,503 [INFO] [OOD 2d] Layer 26: acc=1.0000
2025-09-09 09:43:14,504 [INFO] [OOD 2d] Layer 27: acc=1.0000
2025-09-09 09:43:14,505 [INFO] [OOD 2d] Layer 28: acc=1.0000
2025-09-09 09:43:14,505 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:43:20,369 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:43:20,372 [INFO] [OOD 3d] Layer 1: acc=0.3933
2025-09-09 09:43:20,373 [INFO] [OOD 3d] Layer 2: acc=0.4433
2025-09-09 09:43:20,375 [INFO] [OOD 3d] Layer 3: acc=0.4633
2025-09-09 09:43:20,377 [INFO] [OOD 3d] Layer 4: acc=0.4000
2025-09-09 09:43:20,378 [INFO] [OOD 3d] Layer 5: acc=0.7300
2025-09-09 09:43:20,380 [INFO] [OOD 3d] Layer 6: acc=0.7500
2025-09-09 09:43:20,381 [INFO] [OOD 3d] Layer 7: acc=0.7733
2025-09-09 09:43:20,383 [INFO] [OOD 3d] Layer 8: acc=0.8967
2025-09-09 09:43:20,384 [INFO] [OOD 3d] Layer 9: acc=0.7900
2025-09-09 09:43:20,386 [INFO] [OOD 3d] Layer 10: acc=0.9767
2025-09-09 09:43:20,387 [INFO] [OOD 3d] Layer 11: acc=0.9333
2025-09-09 09:43:20,389 [INFO] [OOD 3d] Layer 12: acc=0.9700
2025-09-09 09:43:20,390 [INFO] [OOD 3d] Layer 13: acc=0.9567
2025-09-09 09:43:20,392 [INFO] [OOD 3d] Layer 14: acc=0.9767
2025-09-09 09:43:20,394 [INFO] [OOD 3d] Layer 15: acc=0.9600
2025-09-09 09:43:20,395 [INFO] [OOD 3d] Layer 16: acc=0.9867
2025-09-09 09:43:20,397 [INFO] [OOD 3d] Layer 17: acc=0.9533
2025-09-09 09:43:20,398 [INFO] [OOD 3d] Layer 18: acc=0.9733
2025-09-09 09:43:20,400 [INFO] [OOD 3d] Layer 19: acc=1.0000
2025-09-09 09:43:20,401 [INFO] [OOD 3d] Layer 20: acc=0.9933
2025-09-09 09:43:20,403 [INFO] [OOD 3d] Layer 21: acc=0.9800
2025-09-09 09:43:20,405 [INFO] [OOD 3d] Layer 22: acc=0.9867
2025-09-09 09:43:20,406 [INFO] [OOD 3d] Layer 23: acc=0.9800
2025-09-09 09:43:20,407 [INFO] [OOD 3d] Layer 24: acc=0.9867
2025-09-09 09:43:20,409 [INFO] [OOD 3d] Layer 25: acc=0.9800
2025-09-09 09:43:20,410 [INFO] [OOD 3d] Layer 26: acc=0.9867
2025-09-09 09:43:20,412 [INFO] [OOD 3d] Layer 27: acc=0.9767
2025-09-09 09:43:20,413 [INFO] [OOD 3d] Layer 28: acc=0.9867
2025-09-09 09:43:20,414 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:43:26,844 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:43:26,846 [INFO] [OOD 4d] Layer 1: acc=0.3500
2025-09-09 09:43:26,848 [INFO] [OOD 4d] Layer 2: acc=0.4033
2025-09-09 09:43:26,850 [INFO] [OOD 4d] Layer 3: acc=0.3867
2025-09-09 09:43:26,851 [INFO] [OOD 4d] Layer 4: acc=0.3667
2025-09-09 09:43:26,853 [INFO] [OOD 4d] Layer 5: acc=0.7200
2025-09-09 09:43:26,854 [INFO] [OOD 4d] Layer 6: acc=0.7767
2025-09-09 09:43:26,856 [INFO] [OOD 4d] Layer 7: acc=0.7033
2025-09-09 09:43:26,857 [INFO] [OOD 4d] Layer 8: acc=0.8233
2025-09-09 09:43:26,859 [INFO] [OOD 4d] Layer 9: acc=0.6667
2025-09-09 09:43:26,860 [INFO] [OOD 4d] Layer 10: acc=0.7600
2025-09-09 09:43:26,862 [INFO] [OOD 4d] Layer 11: acc=0.8833
2025-09-09 09:43:26,863 [INFO] [OOD 4d] Layer 12: acc=0.7500
2025-09-09 09:43:26,865 [INFO] [OOD 4d] Layer 13: acc=0.8467
2025-09-09 09:43:26,866 [INFO] [OOD 4d] Layer 14: acc=0.9033
2025-09-09 09:43:26,868 [INFO] [OOD 4d] Layer 15: acc=0.8967
2025-09-09 09:43:26,870 [INFO] [OOD 4d] Layer 16: acc=0.8767
2025-09-09 09:43:26,871 [INFO] [OOD 4d] Layer 17: acc=0.8067
2025-09-09 09:43:26,873 [INFO] [OOD 4d] Layer 18: acc=0.9700
2025-09-09 09:43:26,874 [INFO] [OOD 4d] Layer 19: acc=0.9567
2025-09-09 09:43:26,875 [INFO] [OOD 4d] Layer 20: acc=0.9333
2025-09-09 09:43:26,877 [INFO] [OOD 4d] Layer 21: acc=0.9567
2025-09-09 09:43:26,879 [INFO] [OOD 4d] Layer 22: acc=0.9733
2025-09-09 09:43:26,880 [INFO] [OOD 4d] Layer 23: acc=0.9633
2025-09-09 09:43:26,882 [INFO] [OOD 4d] Layer 24: acc=0.9867
2025-09-09 09:43:26,883 [INFO] [OOD 4d] Layer 25: acc=0.9733
2025-09-09 09:43:26,885 [INFO] [OOD 4d] Layer 26: acc=0.9733
2025-09-09 09:43:26,886 [INFO] [OOD 4d] Layer 27: acc=0.9567
2025-09-09 09:43:26,887 [INFO] [OOD 4d] Layer 28: acc=0.9533
2025-09-09 09:43:26,888 [INFO] ==================== RUN 2/5 (Seed: 43) ====================
2025-09-09 09:43:26,889 [INFO] Using device: cuda:0
2025-09-09 09:43:26,892 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:43:26,892 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:43:26,895 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:43:26,895 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:43:26,896 [INFO] [TRAIN_COMM_3WAY_Run2] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:43:50,681 [INFO] [TRAIN_COMM_3WAY_Run2] Finished extracting activations.
2025-09-09 09:43:50,684 [INFO] Per-layer classification reports -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/probe_3way_comm_Qwen2.5-7B-Instruct_seed_43_20250909_094350.txt
2025-09-09 09:43:50,684 [INFO] --- Starting Probe Training Loop for layers 1..28 ---
2025-09-09 09:43:50,685 [INFO] --- Processing Layer 1 ---
2025-09-09 09:43:50,962 [INFO] Layer 1 - Training completed.
2025-09-09 09:43:50,963 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_1/state_dict.pt
2025-09-09 09:43:50,978 [INFO] Layer 1 - Test Acc: 0.4200 | F1(C0,C1,C2): 0.000, 0.549, 0.470
2025-09-09 09:43:50,978 [INFO] --- Processing Layer 2 ---
2025-09-09 09:43:51,241 [INFO] Layer 2 - Training completed.
2025-09-09 09:43:51,241 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_2/state_dict.pt
2025-09-09 09:43:51,255 [INFO] Layer 2 - Test Acc: 0.5900 | F1(C0,C1,C2): 0.717, 0.691, 0.039
2025-09-09 09:43:51,255 [INFO] --- Processing Layer 3 ---
2025-09-09 09:43:51,517 [INFO] Layer 3 - Training completed.
2025-09-09 09:43:51,518 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_3/state_dict.pt
2025-09-09 09:43:51,531 [INFO] Layer 3 - Test Acc: 0.6633 | F1(C0,C1,C2): 0.687, 0.738, 0.560
2025-09-09 09:43:51,531 [INFO] --- Processing Layer 4 ---
2025-09-09 09:43:51,791 [INFO] Layer 4 - Training completed.
2025-09-09 09:43:51,793 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_4/state_dict.pt
2025-09-09 09:43:51,806 [INFO] Layer 4 - Test Acc: 0.9100 | F1(C0,C1,C2): 0.904, 0.859, 0.962
2025-09-09 09:43:51,806 [INFO] --- Processing Layer 5 ---
2025-09-09 09:43:52,068 [INFO] Layer 5 - Training completed.
2025-09-09 09:43:52,069 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_5/state_dict.pt
2025-09-09 09:43:52,082 [INFO] Layer 5 - Test Acc: 0.9600 | F1(C0,C1,C2): 0.937, 0.943, 1.000
2025-09-09 09:43:52,083 [INFO] --- Processing Layer 6 ---
2025-09-09 09:43:52,345 [INFO] Layer 6 - Training completed.
2025-09-09 09:43:52,347 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_6/state_dict.pt
2025-09-09 09:43:52,360 [INFO] Layer 6 - Test Acc: 0.9567 | F1(C0,C1,C2): 0.933, 0.937, 1.000
2025-09-09 09:43:52,361 [INFO] --- Processing Layer 7 ---
2025-09-09 09:43:52,626 [INFO] Layer 7 - Training completed.
2025-09-09 09:43:52,627 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_7/state_dict.pt
2025-09-09 09:43:52,641 [INFO] Layer 7 - Test Acc: 0.9700 | F1(C0,C1,C2): 0.954, 0.956, 1.000
2025-09-09 09:43:52,641 [INFO] --- Processing Layer 8 ---
2025-09-09 09:43:52,902 [INFO] Layer 8 - Training completed.
2025-09-09 09:43:52,903 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_8/state_dict.pt
2025-09-09 09:43:52,916 [INFO] Layer 8 - Test Acc: 0.9533 | F1(C0,C1,C2): 0.933, 0.927, 1.000
2025-09-09 09:43:52,917 [INFO] --- Processing Layer 9 ---
2025-09-09 09:43:53,179 [INFO] Layer 9 - Training completed.
2025-09-09 09:43:53,181 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_9/state_dict.pt
2025-09-09 09:43:53,194 [INFO] Layer 9 - Test Acc: 0.9533 | F1(C0,C1,C2): 0.926, 0.934, 1.000
2025-09-09 09:43:53,194 [INFO] --- Processing Layer 10 ---
2025-09-09 09:43:53,462 [INFO] Layer 10 - Training completed.
2025-09-09 09:43:53,463 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_10/state_dict.pt
2025-09-09 09:43:53,477 [INFO] Layer 10 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.976, 0.974, 1.000
2025-09-09 09:43:53,477 [INFO] --- Processing Layer 11 ---
2025-09-09 09:43:53,749 [INFO] Layer 11 - Training completed.
2025-09-09 09:43:53,751 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_11/state_dict.pt
2025-09-09 09:43:53,765 [INFO] Layer 11 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.980, 1.000
2025-09-09 09:43:53,765 [INFO] --- Processing Layer 12 ---
2025-09-09 09:43:54,063 [INFO] Layer 12 - Training completed.
2025-09-09 09:43:54,064 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_12/state_dict.pt
2025-09-09 09:43:54,078 [INFO] Layer 12 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:43:54,078 [INFO] --- Processing Layer 13 ---
2025-09-09 09:43:54,344 [INFO] Layer 13 - Training completed.
2025-09-09 09:43:54,345 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_13/state_dict.pt
2025-09-09 09:43:54,359 [INFO] Layer 13 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:43:54,359 [INFO] --- Processing Layer 14 ---
2025-09-09 09:43:54,626 [INFO] Layer 14 - Training completed.
2025-09-09 09:43:54,627 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_14/state_dict.pt
2025-09-09 09:43:54,641 [INFO] Layer 14 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:43:54,642 [INFO] --- Processing Layer 15 ---
2025-09-09 09:43:54,907 [INFO] Layer 15 - Training completed.
2025-09-09 09:43:54,909 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_15/state_dict.pt
2025-09-09 09:43:54,922 [INFO] Layer 15 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:43:54,923 [INFO] --- Processing Layer 16 ---
2025-09-09 09:43:55,185 [INFO] Layer 16 - Training completed.
2025-09-09 09:43:55,186 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_16/state_dict.pt
2025-09-09 09:43:55,199 [INFO] Layer 16 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:43:55,200 [INFO] --- Processing Layer 17 ---
2025-09-09 09:43:55,464 [INFO] Layer 17 - Training completed.
2025-09-09 09:43:55,465 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_17/state_dict.pt
2025-09-09 09:43:55,479 [INFO] Layer 17 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:43:55,479 [INFO] --- Processing Layer 18 ---
2025-09-09 09:43:55,744 [INFO] Layer 18 - Training completed.
2025-09-09 09:43:55,745 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_18/state_dict.pt
2025-09-09 09:43:55,759 [INFO] Layer 18 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:55,759 [INFO] --- Processing Layer 19 ---
2025-09-09 09:43:56,043 [INFO] Layer 19 - Training completed.
2025-09-09 09:43:56,045 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_19/state_dict.pt
2025-09-09 09:43:56,061 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:56,061 [INFO] --- Processing Layer 20 ---
2025-09-09 09:43:56,338 [INFO] Layer 20 - Training completed.
2025-09-09 09:43:56,339 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_20/state_dict.pt
2025-09-09 09:43:56,353 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:56,353 [INFO] --- Processing Layer 21 ---
2025-09-09 09:43:56,625 [INFO] Layer 21 - Training completed.
2025-09-09 09:43:56,626 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_21/state_dict.pt
2025-09-09 09:43:56,640 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:56,640 [INFO] --- Processing Layer 22 ---
2025-09-09 09:43:56,904 [INFO] Layer 22 - Training completed.
2025-09-09 09:43:56,905 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_22/state_dict.pt
2025-09-09 09:43:56,918 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:56,919 [INFO] --- Processing Layer 23 ---
2025-09-09 09:43:57,185 [INFO] Layer 23 - Training completed.
2025-09-09 09:43:57,186 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_23/state_dict.pt
2025-09-09 09:43:57,199 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:57,199 [INFO] --- Processing Layer 24 ---
2025-09-09 09:43:57,463 [INFO] Layer 24 - Training completed.
2025-09-09 09:43:57,464 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_24/state_dict.pt
2025-09-09 09:43:57,478 [INFO] Layer 24 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:57,478 [INFO] --- Processing Layer 25 ---
2025-09-09 09:43:57,742 [INFO] Layer 25 - Training completed.
2025-09-09 09:43:57,744 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_25/state_dict.pt
2025-09-09 09:43:57,758 [INFO] Layer 25 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:57,758 [INFO] --- Processing Layer 26 ---
2025-09-09 09:43:58,019 [INFO] Layer 26 - Training completed.
2025-09-09 09:43:58,020 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_26/state_dict.pt
2025-09-09 09:43:58,034 [INFO] Layer 26 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:58,034 [INFO] --- Processing Layer 27 ---
2025-09-09 09:43:58,298 [INFO] Layer 27 - Training completed.
2025-09-09 09:43:58,299 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_27/state_dict.pt
2025-09-09 09:43:58,313 [INFO] Layer 27 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:58,313 [INFO] --- Processing Layer 28 ---
2025-09-09 09:43:58,577 [INFO] Layer 28 - Training completed.
2025-09-09 09:43:58,578 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_43/layer_28/state_dict.pt
2025-09-09 09:43:58,591 [INFO] Layer 28 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:43:58,591 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:43:58,591 [INFO] --- Generating OOD Datasets for Run 2 ---
2025-09-09 09:43:58,597 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:43:58,599 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:43:58,635 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:44:02,670 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:44:02,672 [INFO] [OOD 1d] Layer 1: acc=0.3367
2025-09-09 09:44:02,674 [INFO] [OOD 1d] Layer 2: acc=0.3333
2025-09-09 09:44:02,675 [INFO] [OOD 1d] Layer 3: acc=0.4200
2025-09-09 09:44:02,677 [INFO] [OOD 1d] Layer 4: acc=0.3333
2025-09-09 09:44:02,679 [INFO] [OOD 1d] Layer 5: acc=0.9633
2025-09-09 09:44:02,680 [INFO] [OOD 1d] Layer 6: acc=0.9433
2025-09-09 09:44:02,682 [INFO] [OOD 1d] Layer 7: acc=0.9900
2025-09-09 09:44:02,683 [INFO] [OOD 1d] Layer 8: acc=0.6733
2025-09-09 09:44:02,685 [INFO] [OOD 1d] Layer 9: acc=0.7400
2025-09-09 09:44:02,686 [INFO] [OOD 1d] Layer 10: acc=0.7300
2025-09-09 09:44:02,688 [INFO] [OOD 1d] Layer 11: acc=0.9067
2025-09-09 09:44:02,689 [INFO] [OOD 1d] Layer 12: acc=0.9200
2025-09-09 09:44:02,691 [INFO] [OOD 1d] Layer 13: acc=0.9467
2025-09-09 09:44:02,692 [INFO] [OOD 1d] Layer 14: acc=0.9267
2025-09-09 09:44:02,694 [INFO] [OOD 1d] Layer 15: acc=0.9033
2025-09-09 09:44:02,695 [INFO] [OOD 1d] Layer 16: acc=0.9200
2025-09-09 09:44:02,697 [INFO] [OOD 1d] Layer 17: acc=0.8967
2025-09-09 09:44:02,698 [INFO] [OOD 1d] Layer 18: acc=0.8567
2025-09-09 09:44:02,700 [INFO] [OOD 1d] Layer 19: acc=0.8933
2025-09-09 09:44:02,702 [INFO] [OOD 1d] Layer 20: acc=0.9633
2025-09-09 09:44:02,703 [INFO] [OOD 1d] Layer 21: acc=0.9267
2025-09-09 09:44:02,705 [INFO] [OOD 1d] Layer 22: acc=0.9867
2025-09-09 09:44:02,706 [INFO] [OOD 1d] Layer 23: acc=0.9533
2025-09-09 09:44:02,707 [INFO] [OOD 1d] Layer 24: acc=0.9600
2025-09-09 09:44:02,709 [INFO] [OOD 1d] Layer 25: acc=0.9900
2025-09-09 09:44:02,710 [INFO] [OOD 1d] Layer 26: acc=0.9100
2025-09-09 09:44:02,712 [INFO] [OOD 1d] Layer 27: acc=0.9500
2025-09-09 09:44:02,713 [INFO] [OOD 1d] Layer 28: acc=0.9233
2025-09-09 09:44:02,714 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:44:05,985 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:44:05,987 [INFO] [OOD 2d] Layer 1: acc=0.3450
2025-09-09 09:44:05,988 [INFO] [OOD 2d] Layer 2: acc=0.9200
2025-09-09 09:44:05,989 [INFO] [OOD 2d] Layer 3: acc=0.7950
2025-09-09 09:44:05,990 [INFO] [OOD 2d] Layer 4: acc=0.9350
2025-09-09 09:44:05,991 [INFO] [OOD 2d] Layer 5: acc=0.9750
2025-09-09 09:44:05,993 [INFO] [OOD 2d] Layer 6: acc=0.9800
2025-09-09 09:44:05,994 [INFO] [OOD 2d] Layer 7: acc=0.9700
2025-09-09 09:44:05,995 [INFO] [OOD 2d] Layer 8: acc=0.9700
2025-09-09 09:44:05,996 [INFO] [OOD 2d] Layer 9: acc=0.9700
2025-09-09 09:44:05,997 [INFO] [OOD 2d] Layer 10: acc=0.9950
2025-09-09 09:44:05,998 [INFO] [OOD 2d] Layer 11: acc=1.0000
2025-09-09 09:44:05,999 [INFO] [OOD 2d] Layer 12: acc=1.0000
2025-09-09 09:44:06,001 [INFO] [OOD 2d] Layer 13: acc=0.9800
2025-09-09 09:44:06,002 [INFO] [OOD 2d] Layer 14: acc=0.9950
2025-09-09 09:44:06,003 [INFO] [OOD 2d] Layer 15: acc=0.9900
2025-09-09 09:44:06,004 [INFO] [OOD 2d] Layer 16: acc=0.9950
2025-09-09 09:44:06,005 [INFO] [OOD 2d] Layer 17: acc=0.9950
2025-09-09 09:44:06,006 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:44:06,007 [INFO] [OOD 2d] Layer 19: acc=0.9950
2025-09-09 09:44:06,009 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:44:06,010 [INFO] [OOD 2d] Layer 21: acc=1.0000
2025-09-09 09:44:06,011 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:44:06,012 [INFO] [OOD 2d] Layer 23: acc=1.0000
2025-09-09 09:44:06,013 [INFO] [OOD 2d] Layer 24: acc=1.0000
2025-09-09 09:44:06,014 [INFO] [OOD 2d] Layer 25: acc=1.0000
2025-09-09 09:44:06,015 [INFO] [OOD 2d] Layer 26: acc=1.0000
2025-09-09 09:44:06,017 [INFO] [OOD 2d] Layer 27: acc=1.0000
2025-09-09 09:44:06,018 [INFO] [OOD 2d] Layer 28: acc=1.0000
2025-09-09 09:44:06,018 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:44:11,879 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:44:11,882 [INFO] [OOD 3d] Layer 1: acc=0.3767
2025-09-09 09:44:11,883 [INFO] [OOD 3d] Layer 2: acc=0.4000
2025-09-09 09:44:11,885 [INFO] [OOD 3d] Layer 3: acc=0.4467
2025-09-09 09:44:11,887 [INFO] [OOD 3d] Layer 4: acc=0.3700
2025-09-09 09:44:11,888 [INFO] [OOD 3d] Layer 5: acc=0.6867
2025-09-09 09:44:11,890 [INFO] [OOD 3d] Layer 6: acc=0.6900
2025-09-09 09:44:11,891 [INFO] [OOD 3d] Layer 7: acc=0.8200
2025-09-09 09:44:11,893 [INFO] [OOD 3d] Layer 8: acc=0.8700
2025-09-09 09:44:11,894 [INFO] [OOD 3d] Layer 9: acc=0.8367
2025-09-09 09:44:11,896 [INFO] [OOD 3d] Layer 10: acc=0.8767
2025-09-09 09:44:11,897 [INFO] [OOD 3d] Layer 11: acc=0.8900
2025-09-09 09:44:11,899 [INFO] [OOD 3d] Layer 12: acc=0.9433
2025-09-09 09:44:11,900 [INFO] [OOD 3d] Layer 13: acc=0.9333
2025-09-09 09:44:11,902 [INFO] [OOD 3d] Layer 14: acc=0.9333
2025-09-09 09:44:11,903 [INFO] [OOD 3d] Layer 15: acc=0.9433
2025-09-09 09:44:11,905 [INFO] [OOD 3d] Layer 16: acc=0.9433
2025-09-09 09:44:11,906 [INFO] [OOD 3d] Layer 17: acc=0.9433
2025-09-09 09:44:11,908 [INFO] [OOD 3d] Layer 18: acc=0.9667
2025-09-09 09:44:11,909 [INFO] [OOD 3d] Layer 19: acc=0.9733
2025-09-09 09:44:11,911 [INFO] [OOD 3d] Layer 20: acc=0.9900
2025-09-09 09:44:11,912 [INFO] [OOD 3d] Layer 21: acc=1.0000
2025-09-09 09:44:11,914 [INFO] [OOD 3d] Layer 22: acc=0.9933
2025-09-09 09:44:11,915 [INFO] [OOD 3d] Layer 23: acc=0.9833
2025-09-09 09:44:11,917 [INFO] [OOD 3d] Layer 24: acc=0.9867
2025-09-09 09:44:11,918 [INFO] [OOD 3d] Layer 25: acc=0.9867
2025-09-09 09:44:11,920 [INFO] [OOD 3d] Layer 26: acc=0.9700
2025-09-09 09:44:11,921 [INFO] [OOD 3d] Layer 27: acc=0.9867
2025-09-09 09:44:11,923 [INFO] [OOD 3d] Layer 28: acc=0.9700
2025-09-09 09:44:11,923 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:44:18,379 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:44:18,382 [INFO] [OOD 4d] Layer 1: acc=0.3900
2025-09-09 09:44:18,383 [INFO] [OOD 4d] Layer 2: acc=0.3967
2025-09-09 09:44:18,385 [INFO] [OOD 4d] Layer 3: acc=0.3800
2025-09-09 09:44:18,386 [INFO] [OOD 4d] Layer 4: acc=0.3867
2025-09-09 09:44:18,388 [INFO] [OOD 4d] Layer 5: acc=0.7100
2025-09-09 09:44:18,389 [INFO] [OOD 4d] Layer 6: acc=0.7367
2025-09-09 09:44:18,391 [INFO] [OOD 4d] Layer 7: acc=0.7700
2025-09-09 09:44:18,392 [INFO] [OOD 4d] Layer 8: acc=0.8200
2025-09-09 09:44:18,394 [INFO] [OOD 4d] Layer 9: acc=0.6733
2025-09-09 09:44:18,395 [INFO] [OOD 4d] Layer 10: acc=0.8900
2025-09-09 09:44:18,397 [INFO] [OOD 4d] Layer 11: acc=0.9267
2025-09-09 09:44:18,398 [INFO] [OOD 4d] Layer 12: acc=0.8433
2025-09-09 09:44:18,399 [INFO] [OOD 4d] Layer 13: acc=0.8367
2025-09-09 09:44:18,401 [INFO] [OOD 4d] Layer 14: acc=0.9667
2025-09-09 09:44:18,403 [INFO] [OOD 4d] Layer 15: acc=0.9633
2025-09-09 09:44:18,404 [INFO] [OOD 4d] Layer 16: acc=0.8367
2025-09-09 09:44:18,406 [INFO] [OOD 4d] Layer 17: acc=0.9000
2025-09-09 09:44:18,407 [INFO] [OOD 4d] Layer 18: acc=0.9667
2025-09-09 09:44:18,409 [INFO] [OOD 4d] Layer 19: acc=0.9900
2025-09-09 09:44:18,410 [INFO] [OOD 4d] Layer 20: acc=0.9733
2025-09-09 09:44:18,412 [INFO] [OOD 4d] Layer 21: acc=0.9833
2025-09-09 09:44:18,413 [INFO] [OOD 4d] Layer 22: acc=0.9933
2025-09-09 09:44:18,415 [INFO] [OOD 4d] Layer 23: acc=0.9933
2025-09-09 09:44:18,416 [INFO] [OOD 4d] Layer 24: acc=0.9833
2025-09-09 09:44:18,418 [INFO] [OOD 4d] Layer 25: acc=0.9900
2025-09-09 09:44:18,419 [INFO] [OOD 4d] Layer 26: acc=0.9400
2025-09-09 09:44:18,421 [INFO] [OOD 4d] Layer 27: acc=0.9867
2025-09-09 09:44:18,422 [INFO] [OOD 4d] Layer 28: acc=0.9767
2025-09-09 09:44:18,422 [INFO] ==================== RUN 3/5 (Seed: 44) ====================
2025-09-09 09:44:18,423 [INFO] Using device: cuda:0
2025-09-09 09:44:18,427 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:44:18,427 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:44:18,429 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:44:18,430 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:44:18,430 [INFO] [TRAIN_COMM_3WAY_Run3] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:44:42,102 [INFO] [TRAIN_COMM_3WAY_Run3] Finished extracting activations.
2025-09-09 09:44:42,133 [INFO] Per-layer classification reports -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/probe_3way_comm_Qwen2.5-7B-Instruct_seed_44_20250909_094442.txt
2025-09-09 09:44:42,133 [INFO] --- Starting Probe Training Loop for layers 1..28 ---
2025-09-09 09:44:42,133 [INFO] --- Processing Layer 1 ---
2025-09-09 09:44:42,405 [INFO] Layer 1 - Training completed.
2025-09-09 09:44:42,406 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_1/state_dict.pt
2025-09-09 09:44:42,420 [INFO] Layer 1 - Test Acc: 0.4100 | F1(C0,C1,C2): 0.449, 0.516, 0.000
2025-09-09 09:44:42,420 [INFO] --- Processing Layer 2 ---
2025-09-09 09:44:42,690 [INFO] Layer 2 - Training completed.
2025-09-09 09:44:42,691 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_2/state_dict.pt
2025-09-09 09:44:42,705 [INFO] Layer 2 - Test Acc: 0.6067 | F1(C0,C1,C2): 0.617, 0.686, 0.505
2025-09-09 09:44:42,705 [INFO] --- Processing Layer 3 ---
2025-09-09 09:44:42,975 [INFO] Layer 3 - Training completed.
2025-09-09 09:44:42,976 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_3/state_dict.pt
2025-09-09 09:44:42,989 [INFO] Layer 3 - Test Acc: 0.5767 | F1(C0,C1,C2): 0.347, 0.727, 0.569
2025-09-09 09:44:42,990 [INFO] --- Processing Layer 4 ---
2025-09-09 09:44:43,262 [INFO] Layer 4 - Training completed.
2025-09-09 09:44:43,263 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_4/state_dict.pt
2025-09-09 09:44:43,277 [INFO] Layer 4 - Test Acc: 0.9133 | F1(C0,C1,C2): 0.919, 0.856, 0.957
2025-09-09 09:44:43,277 [INFO] --- Processing Layer 5 ---
2025-09-09 09:44:43,550 [INFO] Layer 5 - Training completed.
2025-09-09 09:44:43,551 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_5/state_dict.pt
2025-09-09 09:44:43,565 [INFO] Layer 5 - Test Acc: 0.9700 | F1(C0,C1,C2): 0.954, 0.956, 1.000
2025-09-09 09:44:43,565 [INFO] --- Processing Layer 6 ---
2025-09-09 09:44:43,835 [INFO] Layer 6 - Training completed.
2025-09-09 09:44:43,836 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_6/state_dict.pt
2025-09-09 09:44:43,850 [INFO] Layer 6 - Test Acc: 0.9533 | F1(C0,C1,C2): 0.927, 0.933, 1.000
2025-09-09 09:44:43,850 [INFO] --- Processing Layer 7 ---
2025-09-09 09:44:44,122 [INFO] Layer 7 - Training completed.
2025-09-09 09:44:44,123 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_7/state_dict.pt
2025-09-09 09:44:44,137 [INFO] Layer 7 - Test Acc: 0.9300 | F1(C0,C1,C2): 0.883, 0.905, 1.000
2025-09-09 09:44:44,137 [INFO] --- Processing Layer 8 ---
2025-09-09 09:44:44,413 [INFO] Layer 8 - Training completed.
2025-09-09 09:44:44,414 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_8/state_dict.pt
2025-09-09 09:44:44,428 [INFO] Layer 8 - Test Acc: 0.9500 | F1(C0,C1,C2): 0.930, 0.920, 1.000
2025-09-09 09:44:44,428 [INFO] --- Processing Layer 9 ---
2025-09-09 09:44:44,698 [INFO] Layer 9 - Training completed.
2025-09-09 09:44:44,699 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_9/state_dict.pt
2025-09-09 09:44:44,718 [INFO] Layer 9 - Test Acc: 0.9767 | F1(C0,C1,C2): 0.965, 0.965, 1.000
2025-09-09 09:44:44,718 [INFO] --- Processing Layer 10 ---
2025-09-09 09:44:45,002 [INFO] Layer 10 - Training completed.
2025-09-09 09:44:45,003 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_10/state_dict.pt
2025-09-09 09:44:45,017 [INFO] Layer 10 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:44:45,018 [INFO] --- Processing Layer 11 ---
2025-09-09 09:44:45,289 [INFO] Layer 11 - Training completed.
2025-09-09 09:44:45,290 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_11/state_dict.pt
2025-09-09 09:44:45,304 [INFO] Layer 11 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:44:45,305 [INFO] --- Processing Layer 12 ---
2025-09-09 09:44:45,590 [INFO] Layer 12 - Training completed.
2025-09-09 09:44:45,591 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_12/state_dict.pt
2025-09-09 09:44:45,605 [INFO] Layer 12 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:44:45,605 [INFO] --- Processing Layer 13 ---
2025-09-09 09:44:45,881 [INFO] Layer 13 - Training completed.
2025-09-09 09:44:45,882 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_13/state_dict.pt
2025-09-09 09:44:45,896 [INFO] Layer 13 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:44:45,896 [INFO] --- Processing Layer 14 ---
2025-09-09 09:44:46,167 [INFO] Layer 14 - Training completed.
2025-09-09 09:44:46,169 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_14/state_dict.pt
2025-09-09 09:44:46,182 [INFO] Layer 14 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:44:46,183 [INFO] --- Processing Layer 15 ---
2025-09-09 09:44:46,456 [INFO] Layer 15 - Training completed.
2025-09-09 09:44:46,457 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_15/state_dict.pt
2025-09-09 09:44:46,471 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:44:46,471 [INFO] --- Processing Layer 16 ---
2025-09-09 09:44:46,741 [INFO] Layer 16 - Training completed.
2025-09-09 09:44:46,742 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_16/state_dict.pt
2025-09-09 09:44:46,755 [INFO] Layer 16 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:44:46,756 [INFO] --- Processing Layer 17 ---
2025-09-09 09:44:47,025 [INFO] Layer 17 - Training completed.
2025-09-09 09:44:47,026 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_17/state_dict.pt
2025-09-09 09:44:47,040 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:44:47,040 [INFO] --- Processing Layer 18 ---
2025-09-09 09:44:47,307 [INFO] Layer 18 - Training completed.
2025-09-09 09:44:47,309 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_18/state_dict.pt
2025-09-09 09:44:47,322 [INFO] Layer 18 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:44:47,322 [INFO] --- Processing Layer 19 ---
2025-09-09 09:44:47,599 [INFO] Layer 19 - Training completed.
2025-09-09 09:44:47,600 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_19/state_dict.pt
2025-09-09 09:44:47,614 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:44:47,614 [INFO] --- Processing Layer 20 ---
2025-09-09 09:44:47,883 [INFO] Layer 20 - Training completed.
2025-09-09 09:44:47,885 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_20/state_dict.pt
2025-09-09 09:44:47,898 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:44:47,898 [INFO] --- Processing Layer 21 ---
2025-09-09 09:44:48,169 [INFO] Layer 21 - Training completed.
2025-09-09 09:44:48,171 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_21/state_dict.pt
2025-09-09 09:44:48,186 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:44:48,187 [INFO] --- Processing Layer 22 ---
2025-09-09 09:44:48,466 [INFO] Layer 22 - Training completed.
2025-09-09 09:44:48,468 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_22/state_dict.pt
2025-09-09 09:44:48,487 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:44:48,488 [INFO] --- Processing Layer 23 ---
2025-09-09 09:44:48,773 [INFO] Layer 23 - Training completed.
2025-09-09 09:44:48,774 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_23/state_dict.pt
2025-09-09 09:44:48,788 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:44:48,788 [INFO] --- Processing Layer 24 ---
2025-09-09 09:44:49,062 [INFO] Layer 24 - Training completed.
2025-09-09 09:44:49,063 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_24/state_dict.pt
2025-09-09 09:44:49,077 [INFO] Layer 24 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:44:49,077 [INFO] --- Processing Layer 25 ---
2025-09-09 09:44:49,347 [INFO] Layer 25 - Training completed.
2025-09-09 09:44:49,348 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_25/state_dict.pt
2025-09-09 09:44:49,361 [INFO] Layer 25 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:44:49,362 [INFO] --- Processing Layer 26 ---
2025-09-09 09:44:49,634 [INFO] Layer 26 - Training completed.
2025-09-09 09:44:49,635 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_26/state_dict.pt
2025-09-09 09:44:49,649 [INFO] Layer 26 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:44:49,649 [INFO] --- Processing Layer 27 ---
2025-09-09 09:44:49,930 [INFO] Layer 27 - Training completed.
2025-09-09 09:44:49,931 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_27/state_dict.pt
2025-09-09 09:44:49,945 [INFO] Layer 27 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:44:49,945 [INFO] --- Processing Layer 28 ---
2025-09-09 09:44:50,217 [INFO] Layer 28 - Training completed.
2025-09-09 09:44:50,218 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_44/layer_28/state_dict.pt
2025-09-09 09:44:50,231 [INFO] Layer 28 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:44:50,231 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:44:50,231 [INFO] --- Generating OOD Datasets for Run 3 ---
2025-09-09 09:44:50,238 [WARNING] [WARN] OOD Class-2 (2-digit): Got 1/100
2025-09-09 09:44:50,240 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:44:50,277 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:44:54,335 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:44:54,338 [INFO] [OOD 1d] Layer 1: acc=0.3933
2025-09-09 09:44:54,340 [INFO] [OOD 1d] Layer 2: acc=0.5200
2025-09-09 09:44:54,341 [INFO] [OOD 1d] Layer 3: acc=0.3333
2025-09-09 09:44:54,343 [INFO] [OOD 1d] Layer 4: acc=0.3333
2025-09-09 09:44:54,345 [INFO] [OOD 1d] Layer 5: acc=0.9300
2025-09-09 09:44:54,346 [INFO] [OOD 1d] Layer 6: acc=0.7933
2025-09-09 09:44:54,347 [INFO] [OOD 1d] Layer 7: acc=0.9567
2025-09-09 09:44:54,349 [INFO] [OOD 1d] Layer 8: acc=0.6667
2025-09-09 09:44:54,350 [INFO] [OOD 1d] Layer 9: acc=0.6800
2025-09-09 09:44:54,352 [INFO] [OOD 1d] Layer 10: acc=0.6900
2025-09-09 09:44:54,354 [INFO] [OOD 1d] Layer 11: acc=0.7667
2025-09-09 09:44:54,355 [INFO] [OOD 1d] Layer 12: acc=0.9067
2025-09-09 09:44:54,357 [INFO] [OOD 1d] Layer 13: acc=0.8933
2025-09-09 09:44:54,358 [INFO] [OOD 1d] Layer 14: acc=0.9667
2025-09-09 09:44:54,359 [INFO] [OOD 1d] Layer 15: acc=0.8500
2025-09-09 09:44:54,361 [INFO] [OOD 1d] Layer 16: acc=0.8300
2025-09-09 09:44:54,363 [INFO] [OOD 1d] Layer 17: acc=0.8367
2025-09-09 09:44:54,364 [INFO] [OOD 1d] Layer 18: acc=0.7933
2025-09-09 09:44:54,366 [INFO] [OOD 1d] Layer 19: acc=0.8900
2025-09-09 09:44:54,367 [INFO] [OOD 1d] Layer 20: acc=0.9167
2025-09-09 09:44:54,369 [INFO] [OOD 1d] Layer 21: acc=0.8900
2025-09-09 09:44:54,370 [INFO] [OOD 1d] Layer 22: acc=0.9800
2025-09-09 09:44:54,372 [INFO] [OOD 1d] Layer 23: acc=0.9767
2025-09-09 09:44:54,373 [INFO] [OOD 1d] Layer 24: acc=0.9833
2025-09-09 09:44:54,375 [INFO] [OOD 1d] Layer 25: acc=0.9200
2025-09-09 09:44:54,376 [INFO] [OOD 1d] Layer 26: acc=0.9933
2025-09-09 09:44:54,378 [INFO] [OOD 1d] Layer 27: acc=0.9300
2025-09-09 09:44:54,379 [INFO] [OOD 1d] Layer 28: acc=0.9933
2025-09-09 09:44:54,379 [INFO] [OOD_2d_ALL] Extracting activations for 201 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:44:57,641 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:44:57,643 [INFO] [OOD 2d] Layer 1: acc=0.6617
2025-09-09 09:44:57,645 [INFO] [OOD 2d] Layer 2: acc=0.7214
2025-09-09 09:44:57,646 [INFO] [OOD 2d] Layer 3: acc=0.4925
2025-09-09 09:44:57,647 [INFO] [OOD 2d] Layer 4: acc=0.8905
2025-09-09 09:44:57,648 [INFO] [OOD 2d] Layer 5: acc=0.9900
2025-09-09 09:44:57,649 [INFO] [OOD 2d] Layer 6: acc=0.9502
2025-09-09 09:44:57,651 [INFO] [OOD 2d] Layer 7: acc=0.9104
2025-09-09 09:44:57,652 [INFO] [OOD 2d] Layer 8: acc=0.9403
2025-09-09 09:44:57,653 [INFO] [OOD 2d] Layer 9: acc=0.9502
2025-09-09 09:44:57,654 [INFO] [OOD 2d] Layer 10: acc=0.9950
2025-09-09 09:44:57,655 [INFO] [OOD 2d] Layer 11: acc=1.0000
2025-09-09 09:44:57,657 [INFO] [OOD 2d] Layer 12: acc=0.9950
2025-09-09 09:44:57,658 [INFO] [OOD 2d] Layer 13: acc=1.0000
2025-09-09 09:44:57,659 [INFO] [OOD 2d] Layer 14: acc=1.0000
2025-09-09 09:44:57,660 [INFO] [OOD 2d] Layer 15: acc=1.0000
2025-09-09 09:44:57,661 [INFO] [OOD 2d] Layer 16: acc=1.0000
2025-09-09 09:44:57,662 [INFO] [OOD 2d] Layer 17: acc=1.0000
2025-09-09 09:44:57,663 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:44:57,665 [INFO] [OOD 2d] Layer 19: acc=1.0000
2025-09-09 09:44:57,666 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:44:57,667 [INFO] [OOD 2d] Layer 21: acc=0.9950
2025-09-09 09:44:57,668 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:44:57,670 [INFO] [OOD 2d] Layer 23: acc=1.0000
2025-09-09 09:44:57,671 [INFO] [OOD 2d] Layer 24: acc=1.0000
2025-09-09 09:44:57,672 [INFO] [OOD 2d] Layer 25: acc=0.9950
2025-09-09 09:44:57,673 [INFO] [OOD 2d] Layer 26: acc=0.9950
2025-09-09 09:44:57,674 [INFO] [OOD 2d] Layer 27: acc=1.0000
2025-09-09 09:44:57,675 [INFO] [OOD 2d] Layer 28: acc=1.0000
2025-09-09 09:44:57,675 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:45:03,525 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:45:03,527 [INFO] [OOD 3d] Layer 1: acc=0.3967
2025-09-09 09:45:03,529 [INFO] [OOD 3d] Layer 2: acc=0.4033
2025-09-09 09:45:03,530 [INFO] [OOD 3d] Layer 3: acc=0.4400
2025-09-09 09:45:03,532 [INFO] [OOD 3d] Layer 4: acc=0.3733
2025-09-09 09:45:03,533 [INFO] [OOD 3d] Layer 5: acc=0.7033
2025-09-09 09:45:03,535 [INFO] [OOD 3d] Layer 6: acc=0.7400
2025-09-09 09:45:03,536 [INFO] [OOD 3d] Layer 7: acc=0.9000
2025-09-09 09:45:03,538 [INFO] [OOD 3d] Layer 8: acc=0.9267
2025-09-09 09:45:03,539 [INFO] [OOD 3d] Layer 9: acc=0.8500
2025-09-09 09:45:03,541 [INFO] [OOD 3d] Layer 10: acc=0.9500
2025-09-09 09:45:03,542 [INFO] [OOD 3d] Layer 11: acc=0.9567
2025-09-09 09:45:03,544 [INFO] [OOD 3d] Layer 12: acc=0.9633
2025-09-09 09:45:03,545 [INFO] [OOD 3d] Layer 13: acc=0.9700
2025-09-09 09:45:03,547 [INFO] [OOD 3d] Layer 14: acc=0.9867
2025-09-09 09:45:03,549 [INFO] [OOD 3d] Layer 15: acc=0.9933
2025-09-09 09:45:03,550 [INFO] [OOD 3d] Layer 16: acc=0.9933
2025-09-09 09:45:03,551 [INFO] [OOD 3d] Layer 17: acc=0.9200
2025-09-09 09:45:03,553 [INFO] [OOD 3d] Layer 18: acc=0.9633
2025-09-09 09:45:03,554 [INFO] [OOD 3d] Layer 19: acc=0.9800
2025-09-09 09:45:03,556 [INFO] [OOD 3d] Layer 20: acc=0.9800
2025-09-09 09:45:03,558 [INFO] [OOD 3d] Layer 21: acc=0.9933
2025-09-09 09:45:03,559 [INFO] [OOD 3d] Layer 22: acc=0.9933
2025-09-09 09:45:03,561 [INFO] [OOD 3d] Layer 23: acc=0.9900
2025-09-09 09:45:03,562 [INFO] [OOD 3d] Layer 24: acc=0.9900
2025-09-09 09:45:03,563 [INFO] [OOD 3d] Layer 25: acc=0.9900
2025-09-09 09:45:03,565 [INFO] [OOD 3d] Layer 26: acc=0.9900
2025-09-09 09:45:03,566 [INFO] [OOD 3d] Layer 27: acc=0.9900
2025-09-09 09:45:03,568 [INFO] [OOD 3d] Layer 28: acc=0.9767
2025-09-09 09:45:03,568 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:45:09,998 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:45:10,001 [INFO] [OOD 4d] Layer 1: acc=0.3800
2025-09-09 09:45:10,002 [INFO] [OOD 4d] Layer 2: acc=0.4300
2025-09-09 09:45:10,003 [INFO] [OOD 4d] Layer 3: acc=0.4267
2025-09-09 09:45:10,005 [INFO] [OOD 4d] Layer 4: acc=0.3867
2025-09-09 09:45:10,007 [INFO] [OOD 4d] Layer 5: acc=0.7433
2025-09-09 09:45:10,008 [INFO] [OOD 4d] Layer 6: acc=0.8400
2025-09-09 09:45:10,010 [INFO] [OOD 4d] Layer 7: acc=0.8700
2025-09-09 09:45:10,011 [INFO] [OOD 4d] Layer 8: acc=0.8000
2025-09-09 09:45:10,013 [INFO] [OOD 4d] Layer 9: acc=0.6700
2025-09-09 09:45:10,015 [INFO] [OOD 4d] Layer 10: acc=0.7967
2025-09-09 09:45:10,016 [INFO] [OOD 4d] Layer 11: acc=0.8633
2025-09-09 09:45:10,018 [INFO] [OOD 4d] Layer 12: acc=0.7767
2025-09-09 09:45:10,019 [INFO] [OOD 4d] Layer 13: acc=0.8967
2025-09-09 09:45:10,021 [INFO] [OOD 4d] Layer 14: acc=0.9133
2025-09-09 09:45:10,022 [INFO] [OOD 4d] Layer 15: acc=0.9000
2025-09-09 09:45:10,024 [INFO] [OOD 4d] Layer 16: acc=0.8667
2025-09-09 09:45:10,026 [INFO] [OOD 4d] Layer 17: acc=0.8133
2025-09-09 09:45:10,027 [INFO] [OOD 4d] Layer 18: acc=0.9700
2025-09-09 09:45:10,029 [INFO] [OOD 4d] Layer 19: acc=0.9600
2025-09-09 09:45:10,030 [INFO] [OOD 4d] Layer 20: acc=0.9600
2025-09-09 09:45:10,032 [INFO] [OOD 4d] Layer 21: acc=0.9733
2025-09-09 09:45:10,033 [INFO] [OOD 4d] Layer 22: acc=0.9900
2025-09-09 09:45:10,035 [INFO] [OOD 4d] Layer 23: acc=0.9900
2025-09-09 09:45:10,037 [INFO] [OOD 4d] Layer 24: acc=0.9900
2025-09-09 09:45:10,038 [INFO] [OOD 4d] Layer 25: acc=0.9867
2025-09-09 09:45:10,039 [INFO] [OOD 4d] Layer 26: acc=0.9633
2025-09-09 09:45:10,041 [INFO] [OOD 4d] Layer 27: acc=0.9900
2025-09-09 09:45:10,042 [INFO] [OOD 4d] Layer 28: acc=0.9467
2025-09-09 09:45:10,043 [INFO] ==================== RUN 4/5 (Seed: 45) ====================
2025-09-09 09:45:10,044 [INFO] Using device: cuda:0
2025-09-09 09:45:10,047 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:45:10,047 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:45:10,050 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:45:10,050 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:45:10,051 [INFO] [TRAIN_COMM_3WAY_Run4] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:45:33,899 [INFO] [TRAIN_COMM_3WAY_Run4] Finished extracting activations.
2025-09-09 09:45:33,902 [INFO] Per-layer classification reports -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/probe_3way_comm_Qwen2.5-7B-Instruct_seed_45_20250909_094533.txt
2025-09-09 09:45:33,903 [INFO] --- Starting Probe Training Loop for layers 1..28 ---
2025-09-09 09:45:33,903 [INFO] --- Processing Layer 1 ---
2025-09-09 09:45:34,174 [INFO] Layer 1 - Training completed.
2025-09-09 09:45:34,175 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_1/state_dict.pt
2025-09-09 09:45:34,190 [INFO] Layer 1 - Test Acc: 0.4167 | F1(C0,C1,C2): 0.601, 0.000, 0.388
2025-09-09 09:45:34,190 [INFO] --- Processing Layer 2 ---
2025-09-09 09:45:34,458 [INFO] Layer 2 - Training completed.
2025-09-09 09:45:34,459 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_2/state_dict.pt
2025-09-09 09:45:34,473 [INFO] Layer 2 - Test Acc: 0.5833 | F1(C0,C1,C2): 0.802, 0.627, 0.110
2025-09-09 09:45:34,473 [INFO] --- Processing Layer 3 ---
2025-09-09 09:45:34,740 [INFO] Layer 3 - Training completed.
2025-09-09 09:45:34,741 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_3/state_dict.pt
2025-09-09 09:45:34,755 [INFO] Layer 3 - Test Acc: 0.8000 | F1(C0,C1,C2): 0.867, 0.776, 0.757
2025-09-09 09:45:34,755 [INFO] --- Processing Layer 4 ---
2025-09-09 09:45:35,019 [INFO] Layer 4 - Training completed.
2025-09-09 09:45:35,020 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_4/state_dict.pt
2025-09-09 09:45:35,034 [INFO] Layer 4 - Test Acc: 0.9000 | F1(C0,C1,C2): 0.871, 0.828, 0.995
2025-09-09 09:45:35,034 [INFO] --- Processing Layer 5 ---
2025-09-09 09:45:35,299 [INFO] Layer 5 - Training completed.
2025-09-09 09:45:35,300 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_5/state_dict.pt
2025-09-09 09:45:35,314 [INFO] Layer 5 - Test Acc: 0.9800 | F1(C0,C1,C2): 0.970, 0.970, 1.000
2025-09-09 09:45:35,314 [INFO] --- Processing Layer 6 ---
2025-09-09 09:45:35,578 [INFO] Layer 6 - Training completed.
2025-09-09 09:45:35,579 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_6/state_dict.pt
2025-09-09 09:45:35,593 [INFO] Layer 6 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.975, 0.975, 1.000
2025-09-09 09:45:35,594 [INFO] --- Processing Layer 7 ---
2025-09-09 09:45:35,859 [INFO] Layer 7 - Training completed.
2025-09-09 09:45:35,860 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_7/state_dict.pt
2025-09-09 09:45:35,873 [INFO] Layer 7 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.975, 0.975, 1.000
2025-09-09 09:45:35,874 [INFO] --- Processing Layer 8 ---
2025-09-09 09:45:36,146 [INFO] Layer 8 - Training completed.
2025-09-09 09:45:36,147 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_8/state_dict.pt
2025-09-09 09:45:36,160 [INFO] Layer 8 - Test Acc: 0.9200 | F1(C0,C1,C2): 0.864, 0.893, 1.000
2025-09-09 09:45:36,161 [INFO] --- Processing Layer 9 ---
2025-09-09 09:45:36,425 [INFO] Layer 9 - Training completed.
2025-09-09 09:45:36,427 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_9/state_dict.pt
2025-09-09 09:45:36,441 [INFO] Layer 9 - Test Acc: 0.9733 | F1(C0,C1,C2): 0.961, 0.959, 1.000
2025-09-09 09:45:36,441 [INFO] --- Processing Layer 10 ---
2025-09-09 09:45:36,704 [INFO] Layer 10 - Training completed.
2025-09-09 09:45:36,705 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_10/state_dict.pt
2025-09-09 09:45:36,719 [INFO] Layer 10 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:45:36,719 [INFO] --- Processing Layer 11 ---
2025-09-09 09:45:36,985 [INFO] Layer 11 - Training completed.
2025-09-09 09:45:36,986 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_11/state_dict.pt
2025-09-09 09:45:36,999 [INFO] Layer 11 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:45:37,000 [INFO] --- Processing Layer 12 ---
2025-09-09 09:45:37,265 [INFO] Layer 12 - Training completed.
2025-09-09 09:45:37,266 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_12/state_dict.pt
2025-09-09 09:45:37,280 [INFO] Layer 12 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:45:37,280 [INFO] --- Processing Layer 13 ---
2025-09-09 09:45:37,549 [INFO] Layer 13 - Training completed.
2025-09-09 09:45:37,550 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_13/state_dict.pt
2025-09-09 09:45:37,564 [INFO] Layer 13 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:45:37,564 [INFO] --- Processing Layer 14 ---
2025-09-09 09:45:37,837 [INFO] Layer 14 - Training completed.
2025-09-09 09:45:37,838 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_14/state_dict.pt
2025-09-09 09:45:37,852 [INFO] Layer 14 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:45:37,852 [INFO] --- Processing Layer 15 ---
2025-09-09 09:45:38,122 [INFO] Layer 15 - Training completed.
2025-09-09 09:45:38,123 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_15/state_dict.pt
2025-09-09 09:45:38,137 [INFO] Layer 15 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:45:38,137 [INFO] --- Processing Layer 16 ---
2025-09-09 09:45:38,408 [INFO] Layer 16 - Training completed.
2025-09-09 09:45:38,409 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_16/state_dict.pt
2025-09-09 09:45:38,423 [INFO] Layer 16 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:45:38,423 [INFO] --- Processing Layer 17 ---
2025-09-09 09:45:38,693 [INFO] Layer 17 - Training completed.
2025-09-09 09:45:38,694 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_17/state_dict.pt
2025-09-09 09:45:38,708 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:45:38,708 [INFO] --- Processing Layer 18 ---
2025-09-09 09:45:38,975 [INFO] Layer 18 - Training completed.
2025-09-09 09:45:38,977 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_18/state_dict.pt
2025-09-09 09:45:38,990 [INFO] Layer 18 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:45:38,990 [INFO] --- Processing Layer 19 ---
2025-09-09 09:45:39,265 [INFO] Layer 19 - Training completed.
2025-09-09 09:45:39,266 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_19/state_dict.pt
2025-09-09 09:45:39,280 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:45:39,280 [INFO] --- Processing Layer 20 ---
2025-09-09 09:45:39,547 [INFO] Layer 20 - Training completed.
2025-09-09 09:45:39,548 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_20/state_dict.pt
2025-09-09 09:45:39,562 [INFO] Layer 20 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:45:39,562 [INFO] --- Processing Layer 21 ---
2025-09-09 09:45:39,827 [INFO] Layer 21 - Training completed.
2025-09-09 09:45:39,829 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_21/state_dict.pt
2025-09-09 09:45:39,842 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:45:39,843 [INFO] --- Processing Layer 22 ---
2025-09-09 09:45:40,112 [INFO] Layer 22 - Training completed.
2025-09-09 09:45:40,113 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_22/state_dict.pt
2025-09-09 09:45:40,127 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:45:40,127 [INFO] --- Processing Layer 23 ---
2025-09-09 09:45:40,398 [INFO] Layer 23 - Training completed.
2025-09-09 09:45:40,399 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_23/state_dict.pt
2025-09-09 09:45:40,413 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:45:40,413 [INFO] --- Processing Layer 24 ---
2025-09-09 09:45:40,689 [INFO] Layer 24 - Training completed.
2025-09-09 09:45:40,690 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_24/state_dict.pt
2025-09-09 09:45:40,703 [INFO] Layer 24 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:45:40,703 [INFO] --- Processing Layer 25 ---
2025-09-09 09:45:40,975 [INFO] Layer 25 - Training completed.
2025-09-09 09:45:40,976 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_25/state_dict.pt
2025-09-09 09:45:40,990 [INFO] Layer 25 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:45:40,990 [INFO] --- Processing Layer 26 ---
2025-09-09 09:45:41,272 [INFO] Layer 26 - Training completed.
2025-09-09 09:45:41,273 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_26/state_dict.pt
2025-09-09 09:45:41,288 [INFO] Layer 26 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:45:41,288 [INFO] --- Processing Layer 27 ---
2025-09-09 09:45:41,559 [INFO] Layer 27 - Training completed.
2025-09-09 09:45:41,560 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_27/state_dict.pt
2025-09-09 09:45:41,574 [INFO] Layer 27 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:45:41,574 [INFO] --- Processing Layer 28 ---
2025-09-09 09:45:41,843 [INFO] Layer 28 - Training completed.
2025-09-09 09:45:41,845 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_45/layer_28/state_dict.pt
2025-09-09 09:45:41,859 [INFO] Layer 28 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:45:41,859 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:45:41,859 [INFO] --- Generating OOD Datasets for Run 4 ---
2025-09-09 09:45:41,865 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:45:41,867 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:45:41,902 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:45:45,930 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:45:45,933 [INFO] [OOD 1d] Layer 1: acc=0.3433
2025-09-09 09:45:45,935 [INFO] [OOD 1d] Layer 2: acc=0.4100
2025-09-09 09:45:45,936 [INFO] [OOD 1d] Layer 3: acc=0.5233
2025-09-09 09:45:45,938 [INFO] [OOD 1d] Layer 4: acc=0.3333
2025-09-09 09:45:45,939 [INFO] [OOD 1d] Layer 5: acc=0.9733
2025-09-09 09:45:45,941 [INFO] [OOD 1d] Layer 6: acc=0.9367
2025-09-09 09:45:45,942 [INFO] [OOD 1d] Layer 7: acc=0.9800
2025-09-09 09:45:45,944 [INFO] [OOD 1d] Layer 8: acc=0.9800
2025-09-09 09:45:45,945 [INFO] [OOD 1d] Layer 9: acc=0.6900
2025-09-09 09:45:45,947 [INFO] [OOD 1d] Layer 10: acc=0.8000
2025-09-09 09:45:45,948 [INFO] [OOD 1d] Layer 11: acc=0.9467
2025-09-09 09:45:45,950 [INFO] [OOD 1d] Layer 12: acc=0.9467
2025-09-09 09:45:45,951 [INFO] [OOD 1d] Layer 13: acc=0.9733
2025-09-09 09:45:45,953 [INFO] [OOD 1d] Layer 14: acc=0.9967
2025-09-09 09:45:45,954 [INFO] [OOD 1d] Layer 15: acc=0.9533
2025-09-09 09:45:45,956 [INFO] [OOD 1d] Layer 16: acc=0.9733
2025-09-09 09:45:45,958 [INFO] [OOD 1d] Layer 17: acc=0.9267
2025-09-09 09:45:45,959 [INFO] [OOD 1d] Layer 18: acc=0.8967
2025-09-09 09:45:45,961 [INFO] [OOD 1d] Layer 19: acc=0.9367
2025-09-09 09:45:45,962 [INFO] [OOD 1d] Layer 20: acc=0.9633
2025-09-09 09:45:45,963 [INFO] [OOD 1d] Layer 21: acc=0.9533
2025-09-09 09:45:45,965 [INFO] [OOD 1d] Layer 22: acc=0.9700
2025-09-09 09:45:45,967 [INFO] [OOD 1d] Layer 23: acc=1.0000
2025-09-09 09:45:45,968 [INFO] [OOD 1d] Layer 24: acc=0.9867
2025-09-09 09:45:45,970 [INFO] [OOD 1d] Layer 25: acc=0.9867
2025-09-09 09:45:45,971 [INFO] [OOD 1d] Layer 26: acc=0.9600
2025-09-09 09:45:45,973 [INFO] [OOD 1d] Layer 27: acc=0.9100
2025-09-09 09:45:45,974 [INFO] [OOD 1d] Layer 28: acc=0.9533
2025-09-09 09:45:45,974 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:45:49,218 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:45:49,220 [INFO] [OOD 2d] Layer 1: acc=0.3800
2025-09-09 09:45:49,221 [INFO] [OOD 2d] Layer 2: acc=0.8150
2025-09-09 09:45:49,222 [INFO] [OOD 2d] Layer 3: acc=0.7850
2025-09-09 09:45:49,223 [INFO] [OOD 2d] Layer 4: acc=0.8200
2025-09-09 09:45:49,225 [INFO] [OOD 2d] Layer 5: acc=0.9650
2025-09-09 09:45:49,226 [INFO] [OOD 2d] Layer 6: acc=0.9650
2025-09-09 09:45:49,227 [INFO] [OOD 2d] Layer 7: acc=0.9700
2025-09-09 09:45:49,228 [INFO] [OOD 2d] Layer 8: acc=0.8650
2025-09-09 09:45:49,229 [INFO] [OOD 2d] Layer 9: acc=0.9600
2025-09-09 09:45:49,230 [INFO] [OOD 2d] Layer 10: acc=0.9950
2025-09-09 09:45:49,231 [INFO] [OOD 2d] Layer 11: acc=0.9950
2025-09-09 09:45:49,232 [INFO] [OOD 2d] Layer 12: acc=1.0000
2025-09-09 09:45:49,233 [INFO] [OOD 2d] Layer 13: acc=0.9950
2025-09-09 09:45:49,234 [INFO] [OOD 2d] Layer 14: acc=1.0000
2025-09-09 09:45:49,236 [INFO] [OOD 2d] Layer 15: acc=1.0000
2025-09-09 09:45:49,237 [INFO] [OOD 2d] Layer 16: acc=0.9950
2025-09-09 09:45:49,238 [INFO] [OOD 2d] Layer 17: acc=0.9950
2025-09-09 09:45:49,239 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:45:49,240 [INFO] [OOD 2d] Layer 19: acc=1.0000
2025-09-09 09:45:49,241 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:45:49,243 [INFO] [OOD 2d] Layer 21: acc=1.0000
2025-09-09 09:45:49,244 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:45:49,245 [INFO] [OOD 2d] Layer 23: acc=1.0000
2025-09-09 09:45:49,246 [INFO] [OOD 2d] Layer 24: acc=1.0000
2025-09-09 09:45:49,247 [INFO] [OOD 2d] Layer 25: acc=1.0000
2025-09-09 09:45:49,248 [INFO] [OOD 2d] Layer 26: acc=1.0000
2025-09-09 09:45:49,249 [INFO] [OOD 2d] Layer 27: acc=1.0000
2025-09-09 09:45:49,250 [INFO] [OOD 2d] Layer 28: acc=0.9950
2025-09-09 09:45:49,251 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:45:55,083 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:45:55,085 [INFO] [OOD 3d] Layer 1: acc=0.3433
2025-09-09 09:45:55,087 [INFO] [OOD 3d] Layer 2: acc=0.3800
2025-09-09 09:45:55,088 [INFO] [OOD 3d] Layer 3: acc=0.4833
2025-09-09 09:45:55,090 [INFO] [OOD 3d] Layer 4: acc=0.3433
2025-09-09 09:45:55,091 [INFO] [OOD 3d] Layer 5: acc=0.6733
2025-09-09 09:45:55,093 [INFO] [OOD 3d] Layer 6: acc=0.6967
2025-09-09 09:45:55,094 [INFO] [OOD 3d] Layer 7: acc=0.7633
2025-09-09 09:45:55,096 [INFO] [OOD 3d] Layer 8: acc=0.8033
2025-09-09 09:45:55,097 [INFO] [OOD 3d] Layer 9: acc=0.8900
2025-09-09 09:45:55,099 [INFO] [OOD 3d] Layer 10: acc=0.9033
2025-09-09 09:45:55,100 [INFO] [OOD 3d] Layer 11: acc=0.9167
2025-09-09 09:45:55,102 [INFO] [OOD 3d] Layer 12: acc=0.9133
2025-09-09 09:45:55,103 [INFO] [OOD 3d] Layer 13: acc=0.9267
2025-09-09 09:45:55,105 [INFO] [OOD 3d] Layer 14: acc=0.9600
2025-09-09 09:45:55,106 [INFO] [OOD 3d] Layer 15: acc=0.9733
2025-09-09 09:45:55,108 [INFO] [OOD 3d] Layer 16: acc=0.9533
2025-09-09 09:45:55,109 [INFO] [OOD 3d] Layer 17: acc=0.9533
2025-09-09 09:45:55,111 [INFO] [OOD 3d] Layer 18: acc=0.9767
2025-09-09 09:45:55,112 [INFO] [OOD 3d] Layer 19: acc=0.9933
2025-09-09 09:45:55,114 [INFO] [OOD 3d] Layer 20: acc=0.9933
2025-09-09 09:45:55,115 [INFO] [OOD 3d] Layer 21: acc=0.9900
2025-09-09 09:45:55,117 [INFO] [OOD 3d] Layer 22: acc=0.9900
2025-09-09 09:45:55,118 [INFO] [OOD 3d] Layer 23: acc=0.9800
2025-09-09 09:45:55,120 [INFO] [OOD 3d] Layer 24: acc=0.9900
2025-09-09 09:45:55,121 [INFO] [OOD 3d] Layer 25: acc=0.9667
2025-09-09 09:45:55,123 [INFO] [OOD 3d] Layer 26: acc=0.9900
2025-09-09 09:45:55,124 [INFO] [OOD 3d] Layer 27: acc=0.9800
2025-09-09 09:45:55,126 [INFO] [OOD 3d] Layer 28: acc=0.9767
2025-09-09 09:45:55,126 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:46:01,545 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:46:01,548 [INFO] [OOD 4d] Layer 1: acc=0.3433
2025-09-09 09:46:01,550 [INFO] [OOD 4d] Layer 2: acc=0.3700
2025-09-09 09:46:01,551 [INFO] [OOD 4d] Layer 3: acc=0.4267
2025-09-09 09:46:01,553 [INFO] [OOD 4d] Layer 4: acc=0.3500
2025-09-09 09:46:01,554 [INFO] [OOD 4d] Layer 5: acc=0.6800
2025-09-09 09:46:01,555 [INFO] [OOD 4d] Layer 6: acc=0.7267
2025-09-09 09:46:01,557 [INFO] [OOD 4d] Layer 7: acc=0.7367
2025-09-09 09:46:01,558 [INFO] [OOD 4d] Layer 8: acc=0.6767
2025-09-09 09:46:01,560 [INFO] [OOD 4d] Layer 9: acc=0.6867
2025-09-09 09:46:01,562 [INFO] [OOD 4d] Layer 10: acc=0.8867
2025-09-09 09:46:01,563 [INFO] [OOD 4d] Layer 11: acc=0.9167
2025-09-09 09:46:01,564 [INFO] [OOD 4d] Layer 12: acc=0.9000
2025-09-09 09:46:01,566 [INFO] [OOD 4d] Layer 13: acc=0.9200
2025-09-09 09:46:01,567 [INFO] [OOD 4d] Layer 14: acc=0.9533
2025-09-09 09:46:01,569 [INFO] [OOD 4d] Layer 15: acc=0.9233
2025-09-09 09:46:01,570 [INFO] [OOD 4d] Layer 16: acc=0.7933
2025-09-09 09:46:01,572 [INFO] [OOD 4d] Layer 17: acc=0.8600
2025-09-09 09:46:01,573 [INFO] [OOD 4d] Layer 18: acc=0.9667
2025-09-09 09:46:01,575 [INFO] [OOD 4d] Layer 19: acc=0.9933
2025-09-09 09:46:01,576 [INFO] [OOD 4d] Layer 20: acc=0.9800
2025-09-09 09:46:01,578 [INFO] [OOD 4d] Layer 21: acc=0.9933
2025-09-09 09:46:01,579 [INFO] [OOD 4d] Layer 22: acc=0.9967
2025-09-09 09:46:01,581 [INFO] [OOD 4d] Layer 23: acc=0.9933
2025-09-09 09:46:01,582 [INFO] [OOD 4d] Layer 24: acc=0.9933
2025-09-09 09:46:01,584 [INFO] [OOD 4d] Layer 25: acc=0.9900
2025-09-09 09:46:01,585 [INFO] [OOD 4d] Layer 26: acc=0.9867
2025-09-09 09:46:01,587 [INFO] [OOD 4d] Layer 27: acc=0.9900
2025-09-09 09:46:01,588 [INFO] [OOD 4d] Layer 28: acc=0.9700
2025-09-09 09:46:01,589 [INFO] ==================== RUN 5/5 (Seed: 46) ====================
2025-09-09 09:46:01,590 [INFO] Using device: cuda:0
2025-09-09 09:46:01,593 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:46:01,593 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:46:01,595 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:46:01,596 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:46:01,597 [INFO] [TRAIN_COMM_3WAY_Run5] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:46:25,264 [INFO] [TRAIN_COMM_3WAY_Run5] Finished extracting activations.
2025-09-09 09:46:25,297 [INFO] Per-layer classification reports -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/probe_3way_comm_Qwen2.5-7B-Instruct_seed_46_20250909_094625.txt
2025-09-09 09:46:25,297 [INFO] --- Starting Probe Training Loop for layers 1..28 ---
2025-09-09 09:46:25,297 [INFO] --- Processing Layer 1 ---
2025-09-09 09:46:25,564 [INFO] Layer 1 - Training completed.
2025-09-09 09:46:25,565 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_1/state_dict.pt
2025-09-09 09:46:25,585 [INFO] Layer 1 - Test Acc: 0.4467 | F1(C0,C1,C2): 0.523, 0.444, 0.279
2025-09-09 09:46:25,586 [INFO] --- Processing Layer 2 ---
2025-09-09 09:46:25,886 [INFO] Layer 2 - Training completed.
2025-09-09 09:46:25,887 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_2/state_dict.pt
2025-09-09 09:46:25,901 [INFO] Layer 2 - Test Acc: 0.6600 | F1(C0,C1,C2): 0.653, 0.714, 0.587
2025-09-09 09:46:25,901 [INFO] --- Processing Layer 3 ---
2025-09-09 09:46:26,170 [INFO] Layer 3 - Training completed.
2025-09-09 09:46:26,171 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_3/state_dict.pt
2025-09-09 09:46:26,187 [INFO] Layer 3 - Test Acc: 0.4833 | F1(C0,C1,C2): 0.400, 0.597, 0.286
2025-09-09 09:46:26,187 [INFO] --- Processing Layer 4 ---
2025-09-09 09:46:26,455 [INFO] Layer 4 - Training completed.
2025-09-09 09:46:26,457 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_4/state_dict.pt
2025-09-09 09:46:26,470 [INFO] Layer 4 - Test Acc: 0.9000 | F1(C0,C1,C2): 0.864, 0.843, 0.990
2025-09-09 09:46:26,471 [INFO] --- Processing Layer 5 ---
2025-09-09 09:46:26,738 [INFO] Layer 5 - Training completed.
2025-09-09 09:46:26,739 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_5/state_dict.pt
2025-09-09 09:46:26,753 [INFO] Layer 5 - Test Acc: 0.9633 | F1(C0,C1,C2): 0.947, 0.942, 1.000
2025-09-09 09:46:26,753 [INFO] --- Processing Layer 6 ---
2025-09-09 09:46:27,019 [INFO] Layer 6 - Training completed.
2025-09-09 09:46:27,020 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_6/state_dict.pt
2025-09-09 09:46:27,034 [INFO] Layer 6 - Test Acc: 0.9600 | F1(C0,C1,C2): 0.939, 0.941, 1.000
2025-09-09 09:46:27,034 [INFO] --- Processing Layer 7 ---
2025-09-09 09:46:27,302 [INFO] Layer 7 - Training completed.
2025-09-09 09:46:27,303 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_7/state_dict.pt
2025-09-09 09:46:27,317 [INFO] Layer 7 - Test Acc: 0.9267 | F1(C0,C1,C2): 0.878, 0.900, 1.000
2025-09-09 09:46:27,317 [INFO] --- Processing Layer 8 ---
2025-09-09 09:46:27,587 [INFO] Layer 8 - Training completed.
2025-09-09 09:46:27,589 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_8/state_dict.pt
2025-09-09 09:46:27,602 [INFO] Layer 8 - Test Acc: 0.9167 | F1(C0,C1,C2): 0.857, 0.889, 1.000
2025-09-09 09:46:27,602 [INFO] --- Processing Layer 9 ---
2025-09-09 09:46:27,875 [INFO] Layer 9 - Training completed.
2025-09-09 09:46:27,876 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_9/state_dict.pt
2025-09-09 09:46:27,889 [INFO] Layer 9 - Test Acc: 0.9433 | F1(C0,C1,C2): 0.909, 0.920, 1.000
2025-09-09 09:46:27,889 [INFO] --- Processing Layer 10 ---
2025-09-09 09:46:28,161 [INFO] Layer 10 - Training completed.
2025-09-09 09:46:28,162 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_10/state_dict.pt
2025-09-09 09:46:28,175 [INFO] Layer 10 - Test Acc: 0.9667 | F1(C0,C1,C2): 0.947, 0.952, 1.000
2025-09-09 09:46:28,175 [INFO] --- Processing Layer 11 ---
2025-09-09 09:46:28,448 [INFO] Layer 11 - Training completed.
2025-09-09 09:46:28,449 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_11/state_dict.pt
2025-09-09 09:46:28,462 [INFO] Layer 11 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:46:28,463 [INFO] --- Processing Layer 12 ---
2025-09-09 09:46:28,737 [INFO] Layer 12 - Training completed.
2025-09-09 09:46:28,738 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_12/state_dict.pt
2025-09-09 09:46:28,751 [INFO] Layer 12 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.974, 0.976, 1.000
2025-09-09 09:46:28,752 [INFO] --- Processing Layer 13 ---
2025-09-09 09:46:29,025 [INFO] Layer 13 - Training completed.
2025-09-09 09:46:29,026 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_13/state_dict.pt
2025-09-09 09:46:29,039 [INFO] Layer 13 - Test Acc: 0.9800 | F1(C0,C1,C2): 0.969, 0.971, 1.000
2025-09-09 09:46:29,040 [INFO] --- Processing Layer 14 ---
2025-09-09 09:46:29,317 [INFO] Layer 14 - Training completed.
2025-09-09 09:46:29,318 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_14/state_dict.pt
2025-09-09 09:46:29,332 [INFO] Layer 14 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:46:29,332 [INFO] --- Processing Layer 15 ---
2025-09-09 09:46:29,608 [INFO] Layer 15 - Training completed.
2025-09-09 09:46:29,609 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_15/state_dict.pt
2025-09-09 09:46:29,623 [INFO] Layer 15 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:46:29,623 [INFO] --- Processing Layer 16 ---
2025-09-09 09:46:29,915 [INFO] Layer 16 - Training completed.
2025-09-09 09:46:29,916 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_16/state_dict.pt
2025-09-09 09:46:29,930 [INFO] Layer 16 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:46:29,930 [INFO] --- Processing Layer 17 ---
2025-09-09 09:46:30,203 [INFO] Layer 17 - Training completed.
2025-09-09 09:46:30,205 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_17/state_dict.pt
2025-09-09 09:46:30,218 [INFO] Layer 17 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:46:30,219 [INFO] --- Processing Layer 18 ---
2025-09-09 09:46:30,493 [INFO] Layer 18 - Training completed.
2025-09-09 09:46:30,494 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_18/state_dict.pt
2025-09-09 09:46:30,507 [INFO] Layer 18 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:46:30,507 [INFO] --- Processing Layer 19 ---
2025-09-09 09:46:30,779 [INFO] Layer 19 - Training completed.
2025-09-09 09:46:30,781 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_19/state_dict.pt
2025-09-09 09:46:30,794 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:46:30,795 [INFO] --- Processing Layer 20 ---
2025-09-09 09:46:31,075 [INFO] Layer 20 - Training completed.
2025-09-09 09:46:31,076 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_20/state_dict.pt
2025-09-09 09:46:31,090 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:46:31,091 [INFO] --- Processing Layer 21 ---
2025-09-09 09:46:31,363 [INFO] Layer 21 - Training completed.
2025-09-09 09:46:31,365 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_21/state_dict.pt
2025-09-09 09:46:31,379 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:46:31,379 [INFO] --- Processing Layer 22 ---
2025-09-09 09:46:31,655 [INFO] Layer 22 - Training completed.
2025-09-09 09:46:31,656 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_22/state_dict.pt
2025-09-09 09:46:31,670 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:46:31,670 [INFO] --- Processing Layer 23 ---
2025-09-09 09:46:31,948 [INFO] Layer 23 - Training completed.
2025-09-09 09:46:31,949 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_23/state_dict.pt
2025-09-09 09:46:31,963 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:46:31,963 [INFO] --- Processing Layer 24 ---
2025-09-09 09:46:32,242 [INFO] Layer 24 - Training completed.
2025-09-09 09:46:32,243 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_24/state_dict.pt
2025-09-09 09:46:32,257 [INFO] Layer 24 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:46:32,258 [INFO] --- Processing Layer 25 ---
2025-09-09 09:46:32,537 [INFO] Layer 25 - Training completed.
2025-09-09 09:46:32,538 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_25/state_dict.pt
2025-09-09 09:46:32,552 [INFO] Layer 25 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:46:32,553 [INFO] --- Processing Layer 26 ---
2025-09-09 09:46:32,820 [INFO] Layer 26 - Training completed.
2025-09-09 09:46:32,821 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_26/state_dict.pt
2025-09-09 09:46:32,835 [INFO] Layer 26 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:46:32,835 [INFO] --- Processing Layer 27 ---
2025-09-09 09:46:33,106 [INFO] Layer 27 - Training completed.
2025-09-09 09:46:33,107 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_27/state_dict.pt
2025-09-09 09:46:33,122 [INFO] Layer 27 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:46:33,122 [INFO] --- Processing Layer 28 ---
2025-09-09 09:46:33,393 [INFO] Layer 28 - Training completed.
2025-09-09 09:46:33,394 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-7B-Instruct/run_seed_46/layer_28/state_dict.pt
2025-09-09 09:46:33,408 [INFO] Layer 28 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:46:33,408 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:46:33,408 [INFO] --- Generating OOD Datasets for Run 5 ---
2025-09-09 09:46:33,414 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:46:33,416 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:46:33,453 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:46:37,462 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:46:37,464 [INFO] [OOD 1d] Layer 1: acc=0.4367
2025-09-09 09:46:37,466 [INFO] [OOD 1d] Layer 2: acc=0.3867
2025-09-09 09:46:37,467 [INFO] [OOD 1d] Layer 3: acc=0.3333
2025-09-09 09:46:37,469 [INFO] [OOD 1d] Layer 4: acc=0.3333
2025-09-09 09:46:37,471 [INFO] [OOD 1d] Layer 5: acc=0.8300
2025-09-09 09:46:37,472 [INFO] [OOD 1d] Layer 6: acc=0.9200
2025-09-09 09:46:37,474 [INFO] [OOD 1d] Layer 7: acc=0.9800
2025-09-09 09:46:37,475 [INFO] [OOD 1d] Layer 8: acc=0.8367
2025-09-09 09:46:37,477 [INFO] [OOD 1d] Layer 9: acc=0.6867
2025-09-09 09:46:37,478 [INFO] [OOD 1d] Layer 10: acc=0.9400
2025-09-09 09:46:37,480 [INFO] [OOD 1d] Layer 11: acc=0.9367
2025-09-09 09:46:37,481 [INFO] [OOD 1d] Layer 12: acc=0.9833
2025-09-09 09:46:37,483 [INFO] [OOD 1d] Layer 13: acc=0.9833
2025-09-09 09:46:37,484 [INFO] [OOD 1d] Layer 14: acc=0.9700
2025-09-09 09:46:37,486 [INFO] [OOD 1d] Layer 15: acc=0.8900
2025-09-09 09:46:37,487 [INFO] [OOD 1d] Layer 16: acc=0.9633
2025-09-09 09:46:37,489 [INFO] [OOD 1d] Layer 17: acc=0.9400
2025-09-09 09:46:37,490 [INFO] [OOD 1d] Layer 18: acc=0.9100
2025-09-09 09:46:37,492 [INFO] [OOD 1d] Layer 19: acc=0.9400
2025-09-09 09:46:37,493 [INFO] [OOD 1d] Layer 20: acc=0.9867
2025-09-09 09:46:37,495 [INFO] [OOD 1d] Layer 21: acc=0.9400
2025-09-09 09:46:37,496 [INFO] [OOD 1d] Layer 22: acc=1.0000
2025-09-09 09:46:37,498 [INFO] [OOD 1d] Layer 23: acc=0.9233
2025-09-09 09:46:37,499 [INFO] [OOD 1d] Layer 24: acc=0.9933
2025-09-09 09:46:37,501 [INFO] [OOD 1d] Layer 25: acc=0.9700
2025-09-09 09:46:37,502 [INFO] [OOD 1d] Layer 26: acc=0.9867
2025-09-09 09:46:37,504 [INFO] [OOD 1d] Layer 27: acc=0.9800
2025-09-09 09:46:37,506 [INFO] [OOD 1d] Layer 28: acc=0.9933
2025-09-09 09:46:37,506 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:46:40,754 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:46:40,757 [INFO] [OOD 2d] Layer 1: acc=0.6150
2025-09-09 09:46:40,758 [INFO] [OOD 2d] Layer 2: acc=0.7050
2025-09-09 09:46:40,759 [INFO] [OOD 2d] Layer 3: acc=0.6400
2025-09-09 09:46:40,760 [INFO] [OOD 2d] Layer 4: acc=0.8350
2025-09-09 09:46:40,761 [INFO] [OOD 2d] Layer 5: acc=0.9500
2025-09-09 09:46:40,762 [INFO] [OOD 2d] Layer 6: acc=0.9500
2025-09-09 09:46:40,763 [INFO] [OOD 2d] Layer 7: acc=0.8950
2025-09-09 09:46:40,765 [INFO] [OOD 2d] Layer 8: acc=0.9000
2025-09-09 09:46:40,766 [INFO] [OOD 2d] Layer 9: acc=0.9350
2025-09-09 09:46:40,767 [INFO] [OOD 2d] Layer 10: acc=0.9400
2025-09-09 09:46:40,768 [INFO] [OOD 2d] Layer 11: acc=0.9850
2025-09-09 09:46:40,769 [INFO] [OOD 2d] Layer 12: acc=0.9750
2025-09-09 09:46:40,771 [INFO] [OOD 2d] Layer 13: acc=0.9700
2025-09-09 09:46:40,772 [INFO] [OOD 2d] Layer 14: acc=0.9850
2025-09-09 09:46:40,773 [INFO] [OOD 2d] Layer 15: acc=0.9900
2025-09-09 09:46:40,774 [INFO] [OOD 2d] Layer 16: acc=0.9950
2025-09-09 09:46:40,775 [INFO] [OOD 2d] Layer 17: acc=0.9950
2025-09-09 09:46:40,776 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:46:40,778 [INFO] [OOD 2d] Layer 19: acc=1.0000
2025-09-09 09:46:40,779 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:46:40,780 [INFO] [OOD 2d] Layer 21: acc=1.0000
2025-09-09 09:46:40,781 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:46:40,782 [INFO] [OOD 2d] Layer 23: acc=1.0000
2025-09-09 09:46:40,783 [INFO] [OOD 2d] Layer 24: acc=1.0000
2025-09-09 09:46:40,785 [INFO] [OOD 2d] Layer 25: acc=1.0000
2025-09-09 09:46:40,786 [INFO] [OOD 2d] Layer 26: acc=1.0000
2025-09-09 09:46:40,787 [INFO] [OOD 2d] Layer 27: acc=1.0000
2025-09-09 09:46:40,788 [INFO] [OOD 2d] Layer 28: acc=1.0000
2025-09-09 09:46:40,788 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:46:46,620 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:46:46,623 [INFO] [OOD 3d] Layer 1: acc=0.3967
2025-09-09 09:46:46,625 [INFO] [OOD 3d] Layer 2: acc=0.4300
2025-09-09 09:46:46,626 [INFO] [OOD 3d] Layer 3: acc=0.3967
2025-09-09 09:46:46,628 [INFO] [OOD 3d] Layer 4: acc=0.3833
2025-09-09 09:46:46,629 [INFO] [OOD 3d] Layer 5: acc=0.6733
2025-09-09 09:46:46,631 [INFO] [OOD 3d] Layer 6: acc=0.7133
2025-09-09 09:46:46,632 [INFO] [OOD 3d] Layer 7: acc=0.8233
2025-09-09 09:46:46,634 [INFO] [OOD 3d] Layer 8: acc=0.8733
2025-09-09 09:46:46,635 [INFO] [OOD 3d] Layer 9: acc=0.8767
2025-09-09 09:46:46,637 [INFO] [OOD 3d] Layer 10: acc=0.9533
2025-09-09 09:46:46,638 [INFO] [OOD 3d] Layer 11: acc=0.9633
2025-09-09 09:46:46,640 [INFO] [OOD 3d] Layer 12: acc=0.9667
2025-09-09 09:46:46,641 [INFO] [OOD 3d] Layer 13: acc=0.9633
2025-09-09 09:46:46,643 [INFO] [OOD 3d] Layer 14: acc=0.9133
2025-09-09 09:46:46,644 [INFO] [OOD 3d] Layer 15: acc=0.9133
2025-09-09 09:46:46,646 [INFO] [OOD 3d] Layer 16: acc=0.9767
2025-09-09 09:46:46,647 [INFO] [OOD 3d] Layer 17: acc=0.9200
2025-09-09 09:46:46,649 [INFO] [OOD 3d] Layer 18: acc=0.9800
2025-09-09 09:46:46,650 [INFO] [OOD 3d] Layer 19: acc=0.9900
2025-09-09 09:46:46,652 [INFO] [OOD 3d] Layer 20: acc=0.9933
2025-09-09 09:46:46,653 [INFO] [OOD 3d] Layer 21: acc=0.9967
2025-09-09 09:46:46,655 [INFO] [OOD 3d] Layer 22: acc=0.9967
2025-09-09 09:46:46,657 [INFO] [OOD 3d] Layer 23: acc=0.9900
2025-09-09 09:46:46,658 [INFO] [OOD 3d] Layer 24: acc=0.9900
2025-09-09 09:46:46,660 [INFO] [OOD 3d] Layer 25: acc=0.9933
2025-09-09 09:46:46,661 [INFO] [OOD 3d] Layer 26: acc=0.9800
2025-09-09 09:46:46,663 [INFO] [OOD 3d] Layer 27: acc=0.9633
2025-09-09 09:46:46,665 [INFO] [OOD 3d] Layer 28: acc=0.9833
2025-09-09 09:46:46,665 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:46:53,109 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:46:53,111 [INFO] [OOD 4d] Layer 1: acc=0.3467
2025-09-09 09:46:53,113 [INFO] [OOD 4d] Layer 2: acc=0.4067
2025-09-09 09:46:53,114 [INFO] [OOD 4d] Layer 3: acc=0.3600
2025-09-09 09:46:53,116 [INFO] [OOD 4d] Layer 4: acc=0.3767
2025-09-09 09:46:53,117 [INFO] [OOD 4d] Layer 5: acc=0.6700
2025-09-09 09:46:53,119 [INFO] [OOD 4d] Layer 6: acc=0.7767
2025-09-09 09:46:53,121 [INFO] [OOD 4d] Layer 7: acc=0.8167
2025-09-09 09:46:53,122 [INFO] [OOD 4d] Layer 8: acc=0.6967
2025-09-09 09:46:53,123 [INFO] [OOD 4d] Layer 9: acc=0.6800
2025-09-09 09:46:53,125 [INFO] [OOD 4d] Layer 10: acc=0.7167
2025-09-09 09:46:53,127 [INFO] [OOD 4d] Layer 11: acc=0.8467
2025-09-09 09:46:53,128 [INFO] [OOD 4d] Layer 12: acc=0.8233
2025-09-09 09:46:53,130 [INFO] [OOD 4d] Layer 13: acc=0.8367
2025-09-09 09:46:53,131 [INFO] [OOD 4d] Layer 14: acc=0.9733
2025-09-09 09:46:53,133 [INFO] [OOD 4d] Layer 15: acc=0.9733
2025-09-09 09:46:53,134 [INFO] [OOD 4d] Layer 16: acc=0.8933
2025-09-09 09:46:53,136 [INFO] [OOD 4d] Layer 17: acc=0.8500
2025-09-09 09:46:53,137 [INFO] [OOD 4d] Layer 18: acc=0.9900
2025-09-09 09:46:53,139 [INFO] [OOD 4d] Layer 19: acc=0.9900
2025-09-09 09:46:53,140 [INFO] [OOD 4d] Layer 20: acc=0.9767
2025-09-09 09:46:53,142 [INFO] [OOD 4d] Layer 21: acc=0.9733
2025-09-09 09:46:53,143 [INFO] [OOD 4d] Layer 22: acc=0.9900
2025-09-09 09:46:53,145 [INFO] [OOD 4d] Layer 23: acc=0.9833
2025-09-09 09:46:53,146 [INFO] [OOD 4d] Layer 24: acc=0.9900
2025-09-09 09:46:53,148 [INFO] [OOD 4d] Layer 25: acc=0.9467
2025-09-09 09:46:53,149 [INFO] [OOD 4d] Layer 26: acc=0.9800
2025-09-09 09:46:53,151 [INFO] [OOD 4d] Layer 27: acc=0.9500
2025-09-09 09:46:53,152 [INFO] [OOD 4d] Layer 28: acc=0.9700
2025-09-09 09:46:53,153 [INFO] --- Generating Final Aggregated Plots (with CI) ---
2025-09-09 09:46:53,897 [INFO] Saved aggregated per-layer line chart (PDF) -> ./outputs/Qwen2.5-7B-Instruct/AGG_probe_comm_generalisation_line_Qwen2.5-7B-Instruct_20250909_094653.pdf
2025-09-09 09:46:54,099 [INFO] Saved aggregated mean-accuracy bar chart (PDF) -> ./outputs/Qwen2.5-7B-Instruct/AGG_probe_comm_generalisation_bar_Qwen2.5-7B-Instruct_20250909_094653.pdf
2025-09-09 09:46:54,100 [INFO] --- All Runs and Aggregated Plotting Finished (this model) ---
2025-09-09 09:46:54,100 [INFO] Unified output dir (this model): ./outputs/Qwen2.5-7B-Instruct
