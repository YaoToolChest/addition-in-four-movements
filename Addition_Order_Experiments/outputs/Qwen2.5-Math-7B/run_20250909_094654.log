2025-09-09 09:46:54,253 [INFO] ======= Logger initialized =======
2025-09-09 09:46:54,253 [INFO] Log file: ./outputs/Qwen2.5-Math-7B/run_20250909_094654.log
2025-09-09 09:46:54,254 [INFO] Using device: cuda:0
2025-09-09 09:46:54,254 [INFO] Loading model: /root/autodl-tmp/Qwen2.5-Math-7B ...
2025-09-09 09:47:00,163 [INFO] Model and tokenizer loaded successfully.
2025-09-09 09:47:00,201 [INFO] [Auto] hidden_states length = 29; probing indices = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:47:00,201 [INFO] Final LAYERS_TO_PROBE for Qwen2.5-Math-7B: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:47:00,201 [INFO] Determining probe input dimension...
2025-09-09 09:47:00,201 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:47:00,201 [INFO] Target: 10 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:47:00,202 [INFO] Generated final dataset with 30 samples.
2025-09-09 09:47:00,202 [INFO] Final label distribution: {0: 10, 1: 10, 2: 10}
2025-09-09 09:47:00,202 [INFO] [PLACEHOLDER] Extracting activations for 30 prompts, layers=[1]
2025-09-09 09:47:00,990 [INFO] [PLACEHOLDER] Finished extracting activations.
2025-09-09 09:47:00,990 [INFO] Determined fixed probe input dimension: 3584
2025-09-09 09:47:00,990 [INFO] ==================== RUN 1/5 (Seed: 42) ====================
2025-09-09 09:47:00,991 [INFO] Using device: cuda:0
2025-09-09 09:47:00,996 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:47:00,996 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:47:01,001 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:47:01,001 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:47:01,002 [INFO] [TRAIN_COMM_3WAY_Run1] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:47:24,774 [INFO] [TRAIN_COMM_3WAY_Run1] Finished extracting activations.
2025-09-09 09:47:24,778 [INFO] Per-layer classification reports -> ./outputs/Qwen2.5-Math-7B/run_seed_42/probe_3way_comm_Qwen2.5-Math-7B_seed_42_20250909_094724.txt
2025-09-09 09:47:24,778 [INFO] --- Starting Probe Training Loop for layers 1..28 ---
2025-09-09 09:47:24,778 [INFO] --- Processing Layer 1 ---
2025-09-09 09:47:25,054 [INFO] Layer 1 - Training completed.
2025-09-09 09:47:25,055 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_1/state_dict.pt
2025-09-09 09:47:25,070 [INFO] Layer 1 - Test Acc: 0.4033 | F1(C0,C1,C2): 0.341, 0.175, 0.501
2025-09-09 09:47:25,070 [INFO] --- Processing Layer 2 ---
2025-09-09 09:47:25,355 [INFO] Layer 2 - Training completed.
2025-09-09 09:47:25,356 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_2/state_dict.pt
2025-09-09 09:47:25,370 [INFO] Layer 2 - Test Acc: 0.6967 | F1(C0,C1,C2): 0.802, 0.718, 0.552
2025-09-09 09:47:25,370 [INFO] --- Processing Layer 3 ---
2025-09-09 09:47:25,639 [INFO] Layer 3 - Training completed.
2025-09-09 09:47:25,640 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_3/state_dict.pt
2025-09-09 09:47:25,654 [INFO] Layer 3 - Test Acc: 0.7133 | F1(C0,C1,C2): 0.816, 0.746, 0.500
2025-09-09 09:47:25,654 [INFO] --- Processing Layer 4 ---
2025-09-09 09:47:25,924 [INFO] Layer 4 - Training completed.
2025-09-09 09:47:25,925 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_4/state_dict.pt
2025-09-09 09:47:25,938 [INFO] Layer 4 - Test Acc: 0.9167 | F1(C0,C1,C2): 0.910, 0.878, 0.957
2025-09-09 09:47:25,939 [INFO] --- Processing Layer 5 ---
2025-09-09 09:47:26,202 [INFO] Layer 5 - Training completed.
2025-09-09 09:47:26,203 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_5/state_dict.pt
2025-09-09 09:47:26,217 [INFO] Layer 5 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.980, 1.000
2025-09-09 09:47:26,217 [INFO] --- Processing Layer 6 ---
2025-09-09 09:47:26,495 [INFO] Layer 6 - Training completed.
2025-09-09 09:47:26,497 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_6/state_dict.pt
2025-09-09 09:47:26,510 [INFO] Layer 6 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.974, 0.976, 1.000
2025-09-09 09:47:26,510 [INFO] --- Processing Layer 7 ---
2025-09-09 09:47:26,773 [INFO] Layer 7 - Training completed.
2025-09-09 09:47:26,774 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_7/state_dict.pt
2025-09-09 09:47:26,788 [INFO] Layer 7 - Test Acc: 0.9767 | F1(C0,C1,C2): 0.965, 0.965, 1.000
2025-09-09 09:47:26,788 [INFO] --- Processing Layer 8 ---
2025-09-09 09:47:27,048 [INFO] Layer 8 - Training completed.
2025-09-09 09:47:27,049 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_8/state_dict.pt
2025-09-09 09:47:27,063 [INFO] Layer 8 - Test Acc: 0.9800 | F1(C0,C1,C2): 0.971, 0.969, 1.000
2025-09-09 09:47:27,063 [INFO] --- Processing Layer 9 ---
2025-09-09 09:47:27,323 [INFO] Layer 9 - Training completed.
2025-09-09 09:47:27,325 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_9/state_dict.pt
2025-09-09 09:47:27,338 [INFO] Layer 9 - Test Acc: 0.9733 | F1(C0,C1,C2): 0.958, 0.962, 1.000
2025-09-09 09:47:27,339 [INFO] --- Processing Layer 10 ---
2025-09-09 09:47:27,600 [INFO] Layer 10 - Training completed.
2025-09-09 09:47:27,601 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_10/state_dict.pt
2025-09-09 09:47:27,615 [INFO] Layer 10 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:47:27,615 [INFO] --- Processing Layer 11 ---
2025-09-09 09:47:27,881 [INFO] Layer 11 - Training completed.
2025-09-09 09:47:27,882 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_11/state_dict.pt
2025-09-09 09:47:27,896 [INFO] Layer 11 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:47:27,897 [INFO] --- Processing Layer 12 ---
2025-09-09 09:47:28,163 [INFO] Layer 12 - Training completed.
2025-09-09 09:47:28,164 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_12/state_dict.pt
2025-09-09 09:47:28,178 [INFO] Layer 12 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:47:28,178 [INFO] --- Processing Layer 13 ---
2025-09-09 09:47:28,441 [INFO] Layer 13 - Training completed.
2025-09-09 09:47:28,442 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_13/state_dict.pt
2025-09-09 09:47:28,455 [INFO] Layer 13 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:47:28,455 [INFO] --- Processing Layer 14 ---
2025-09-09 09:47:28,716 [INFO] Layer 14 - Training completed.
2025-09-09 09:47:28,717 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_14/state_dict.pt
2025-09-09 09:47:28,731 [INFO] Layer 14 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:47:28,731 [INFO] --- Processing Layer 15 ---
2025-09-09 09:47:28,993 [INFO] Layer 15 - Training completed.
2025-09-09 09:47:28,994 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_15/state_dict.pt
2025-09-09 09:47:29,007 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:47:29,007 [INFO] --- Processing Layer 16 ---
2025-09-09 09:47:29,270 [INFO] Layer 16 - Training completed.
2025-09-09 09:47:29,271 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_16/state_dict.pt
2025-09-09 09:47:29,285 [INFO] Layer 16 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:47:29,285 [INFO] --- Processing Layer 17 ---
2025-09-09 09:47:29,547 [INFO] Layer 17 - Training completed.
2025-09-09 09:47:29,548 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_17/state_dict.pt
2025-09-09 09:47:29,562 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:47:29,562 [INFO] --- Processing Layer 18 ---
2025-09-09 09:47:29,823 [INFO] Layer 18 - Training completed.
2025-09-09 09:47:29,824 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_18/state_dict.pt
2025-09-09 09:47:29,837 [INFO] Layer 18 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:47:29,837 [INFO] --- Processing Layer 19 ---
2025-09-09 09:47:30,103 [INFO] Layer 19 - Training completed.
2025-09-09 09:47:30,105 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_19/state_dict.pt
2025-09-09 09:47:30,118 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:47:30,118 [INFO] --- Processing Layer 20 ---
2025-09-09 09:47:30,379 [INFO] Layer 20 - Training completed.
2025-09-09 09:47:30,381 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_20/state_dict.pt
2025-09-09 09:47:30,394 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:47:30,395 [INFO] --- Processing Layer 21 ---
2025-09-09 09:47:30,655 [INFO] Layer 21 - Training completed.
2025-09-09 09:47:30,656 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_21/state_dict.pt
2025-09-09 09:47:30,670 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:47:30,670 [INFO] --- Processing Layer 22 ---
2025-09-09 09:47:30,929 [INFO] Layer 22 - Training completed.
2025-09-09 09:47:30,930 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_22/state_dict.pt
2025-09-09 09:47:30,944 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:47:30,944 [INFO] --- Processing Layer 23 ---
2025-09-09 09:47:31,207 [INFO] Layer 23 - Training completed.
2025-09-09 09:47:31,208 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_23/state_dict.pt
2025-09-09 09:47:31,221 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:47:31,222 [INFO] --- Processing Layer 24 ---
2025-09-09 09:47:31,483 [INFO] Layer 24 - Training completed.
2025-09-09 09:47:31,485 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_24/state_dict.pt
2025-09-09 09:47:31,498 [INFO] Layer 24 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:47:31,498 [INFO] --- Processing Layer 25 ---
2025-09-09 09:47:31,760 [INFO] Layer 25 - Training completed.
2025-09-09 09:47:31,761 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_25/state_dict.pt
2025-09-09 09:47:31,775 [INFO] Layer 25 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:47:31,775 [INFO] --- Processing Layer 26 ---
2025-09-09 09:47:32,036 [INFO] Layer 26 - Training completed.
2025-09-09 09:47:32,037 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_26/state_dict.pt
2025-09-09 09:47:32,051 [INFO] Layer 26 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:47:32,051 [INFO] --- Processing Layer 27 ---
2025-09-09 09:47:32,313 [INFO] Layer 27 - Training completed.
2025-09-09 09:47:32,314 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_27/state_dict.pt
2025-09-09 09:47:32,327 [INFO] Layer 27 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:47:32,327 [INFO] --- Processing Layer 28 ---
2025-09-09 09:47:32,588 [INFO] Layer 28 - Training completed.
2025-09-09 09:47:32,589 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_42/layer_28/state_dict.pt
2025-09-09 09:47:32,603 [INFO] Layer 28 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:47:32,603 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:47:32,603 [INFO] --- Generating OOD Datasets for Run 1 ---
2025-09-09 09:47:32,609 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:47:32,611 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:47:32,646 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:47:36,686 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:47:36,689 [INFO] [OOD 1d] Layer 1: acc=0.3333
2025-09-09 09:47:36,691 [INFO] [OOD 1d] Layer 2: acc=0.4133
2025-09-09 09:47:36,693 [INFO] [OOD 1d] Layer 3: acc=0.5033
2025-09-09 09:47:36,694 [INFO] [OOD 1d] Layer 4: acc=0.3333
2025-09-09 09:47:36,695 [INFO] [OOD 1d] Layer 5: acc=0.7933
2025-09-09 09:47:36,697 [INFO] [OOD 1d] Layer 6: acc=0.6700
2025-09-09 09:47:36,699 [INFO] [OOD 1d] Layer 7: acc=0.7433
2025-09-09 09:47:36,700 [INFO] [OOD 1d] Layer 8: acc=0.6533
2025-09-09 09:47:36,702 [INFO] [OOD 1d] Layer 9: acc=0.9000
2025-09-09 09:47:36,703 [INFO] [OOD 1d] Layer 10: acc=0.8567
2025-09-09 09:47:36,705 [INFO] [OOD 1d] Layer 11: acc=0.9333
2025-09-09 09:47:36,706 [INFO] [OOD 1d] Layer 12: acc=0.8633
2025-09-09 09:47:36,708 [INFO] [OOD 1d] Layer 13: acc=0.8833
2025-09-09 09:47:36,710 [INFO] [OOD 1d] Layer 14: acc=0.9033
2025-09-09 09:47:36,711 [INFO] [OOD 1d] Layer 15: acc=0.9267
2025-09-09 09:47:36,713 [INFO] [OOD 1d] Layer 16: acc=0.8500
2025-09-09 09:47:36,714 [INFO] [OOD 1d] Layer 17: acc=0.8433
2025-09-09 09:47:36,716 [INFO] [OOD 1d] Layer 18: acc=0.7400
2025-09-09 09:47:36,717 [INFO] [OOD 1d] Layer 19: acc=0.9633
2025-09-09 09:47:36,719 [INFO] [OOD 1d] Layer 20: acc=1.0000
2025-09-09 09:47:36,721 [INFO] [OOD 1d] Layer 21: acc=1.0000
2025-09-09 09:47:36,722 [INFO] [OOD 1d] Layer 22: acc=0.9767
2025-09-09 09:47:36,723 [INFO] [OOD 1d] Layer 23: acc=1.0000
2025-09-09 09:47:36,725 [INFO] [OOD 1d] Layer 24: acc=1.0000
2025-09-09 09:47:36,726 [INFO] [OOD 1d] Layer 25: acc=0.9933
2025-09-09 09:47:36,728 [INFO] [OOD 1d] Layer 26: acc=0.9300
2025-09-09 09:47:36,729 [INFO] [OOD 1d] Layer 27: acc=1.0000
2025-09-09 09:47:36,731 [INFO] [OOD 1d] Layer 28: acc=0.9833
2025-09-09 09:47:36,731 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:47:39,995 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:47:39,997 [INFO] [OOD 2d] Layer 1: acc=0.1700
2025-09-09 09:47:39,998 [INFO] [OOD 2d] Layer 2: acc=0.8200
2025-09-09 09:47:39,999 [INFO] [OOD 2d] Layer 3: acc=0.9100
2025-09-09 09:47:40,000 [INFO] [OOD 2d] Layer 4: acc=0.9100
2025-09-09 09:47:40,001 [INFO] [OOD 2d] Layer 5: acc=0.9800
2025-09-09 09:47:40,003 [INFO] [OOD 2d] Layer 6: acc=0.9750
2025-09-09 09:47:40,004 [INFO] [OOD 2d] Layer 7: acc=0.9850
2025-09-09 09:47:40,005 [INFO] [OOD 2d] Layer 8: acc=0.9650
2025-09-09 09:47:40,006 [INFO] [OOD 2d] Layer 9: acc=0.9700
2025-09-09 09:47:40,007 [INFO] [OOD 2d] Layer 10: acc=1.0000
2025-09-09 09:47:40,009 [INFO] [OOD 2d] Layer 11: acc=1.0000
2025-09-09 09:47:40,010 [INFO] [OOD 2d] Layer 12: acc=1.0000
2025-09-09 09:47:40,011 [INFO] [OOD 2d] Layer 13: acc=1.0000
2025-09-09 09:47:40,012 [INFO] [OOD 2d] Layer 14: acc=1.0000
2025-09-09 09:47:40,013 [INFO] [OOD 2d] Layer 15: acc=1.0000
2025-09-09 09:47:40,014 [INFO] [OOD 2d] Layer 16: acc=1.0000
2025-09-09 09:47:40,015 [INFO] [OOD 2d] Layer 17: acc=1.0000
2025-09-09 09:47:40,017 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:47:40,018 [INFO] [OOD 2d] Layer 19: acc=1.0000
2025-09-09 09:47:40,019 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:47:40,020 [INFO] [OOD 2d] Layer 21: acc=1.0000
2025-09-09 09:47:40,021 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:47:40,022 [INFO] [OOD 2d] Layer 23: acc=1.0000
2025-09-09 09:47:40,023 [INFO] [OOD 2d] Layer 24: acc=1.0000
2025-09-09 09:47:40,025 [INFO] [OOD 2d] Layer 25: acc=1.0000
2025-09-09 09:47:40,026 [INFO] [OOD 2d] Layer 26: acc=0.9950
2025-09-09 09:47:40,027 [INFO] [OOD 2d] Layer 27: acc=0.9850
2025-09-09 09:47:40,028 [INFO] [OOD 2d] Layer 28: acc=0.9950
2025-09-09 09:47:40,028 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:47:45,863 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:47:45,866 [INFO] [OOD 3d] Layer 1: acc=0.4000
2025-09-09 09:47:45,868 [INFO] [OOD 3d] Layer 2: acc=0.4400
2025-09-09 09:47:45,870 [INFO] [OOD 3d] Layer 3: acc=0.5533
2025-09-09 09:47:45,871 [INFO] [OOD 3d] Layer 4: acc=0.7233
2025-09-09 09:47:45,873 [INFO] [OOD 3d] Layer 5: acc=0.8200
2025-09-09 09:47:45,874 [INFO] [OOD 3d] Layer 6: acc=0.8567
2025-09-09 09:47:45,876 [INFO] [OOD 3d] Layer 7: acc=0.9300
2025-09-09 09:47:45,877 [INFO] [OOD 3d] Layer 8: acc=0.8467
2025-09-09 09:47:45,879 [INFO] [OOD 3d] Layer 9: acc=0.7367
2025-09-09 09:47:45,880 [INFO] [OOD 3d] Layer 10: acc=0.9533
2025-09-09 09:47:45,882 [INFO] [OOD 3d] Layer 11: acc=0.9533
2025-09-09 09:47:45,883 [INFO] [OOD 3d] Layer 12: acc=0.9500
2025-09-09 09:47:45,885 [INFO] [OOD 3d] Layer 13: acc=0.9400
2025-09-09 09:47:45,886 [INFO] [OOD 3d] Layer 14: acc=0.9333
2025-09-09 09:47:45,887 [INFO] [OOD 3d] Layer 15: acc=0.9400
2025-09-09 09:47:45,889 [INFO] [OOD 3d] Layer 16: acc=0.9033
2025-09-09 09:47:45,891 [INFO] [OOD 3d] Layer 17: acc=0.8600
2025-09-09 09:47:45,892 [INFO] [OOD 3d] Layer 18: acc=0.7833
2025-09-09 09:47:45,894 [INFO] [OOD 3d] Layer 19: acc=0.9833
2025-09-09 09:47:45,895 [INFO] [OOD 3d] Layer 20: acc=0.9833
2025-09-09 09:47:45,897 [INFO] [OOD 3d] Layer 21: acc=0.9767
2025-09-09 09:47:45,898 [INFO] [OOD 3d] Layer 22: acc=0.9733
2025-09-09 09:47:45,899 [INFO] [OOD 3d] Layer 23: acc=0.9733
2025-09-09 09:47:45,901 [INFO] [OOD 3d] Layer 24: acc=0.9700
2025-09-09 09:47:45,902 [INFO] [OOD 3d] Layer 25: acc=0.9767
2025-09-09 09:47:45,904 [INFO] [OOD 3d] Layer 26: acc=0.9833
2025-09-09 09:47:45,906 [INFO] [OOD 3d] Layer 27: acc=0.9767
2025-09-09 09:47:45,907 [INFO] [OOD 3d] Layer 28: acc=0.9767
2025-09-09 09:47:45,907 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:47:52,343 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:47:52,345 [INFO] [OOD 4d] Layer 1: acc=0.3700
2025-09-09 09:47:52,347 [INFO] [OOD 4d] Layer 2: acc=0.3567
2025-09-09 09:47:52,349 [INFO] [OOD 4d] Layer 3: acc=0.3933
2025-09-09 09:47:52,350 [INFO] [OOD 4d] Layer 4: acc=0.7667
2025-09-09 09:47:52,352 [INFO] [OOD 4d] Layer 5: acc=0.7833
2025-09-09 09:47:52,353 [INFO] [OOD 4d] Layer 6: acc=0.8100
2025-09-09 09:47:52,355 [INFO] [OOD 4d] Layer 7: acc=0.6700
2025-09-09 09:47:52,356 [INFO] [OOD 4d] Layer 8: acc=0.6567
2025-09-09 09:47:52,358 [INFO] [OOD 4d] Layer 9: acc=0.6433
2025-09-09 09:47:52,359 [INFO] [OOD 4d] Layer 10: acc=0.6800
2025-09-09 09:47:52,361 [INFO] [OOD 4d] Layer 11: acc=0.6733
2025-09-09 09:47:52,363 [INFO] [OOD 4d] Layer 12: acc=0.6933
2025-09-09 09:47:52,364 [INFO] [OOD 4d] Layer 13: acc=0.6733
2025-09-09 09:47:52,366 [INFO] [OOD 4d] Layer 14: acc=0.6700
2025-09-09 09:47:52,367 [INFO] [OOD 4d] Layer 15: acc=0.6700
2025-09-09 09:47:52,369 [INFO] [OOD 4d] Layer 16: acc=0.6667
2025-09-09 09:47:52,370 [INFO] [OOD 4d] Layer 17: acc=0.6667
2025-09-09 09:47:52,372 [INFO] [OOD 4d] Layer 18: acc=0.6667
2025-09-09 09:47:52,373 [INFO] [OOD 4d] Layer 19: acc=0.9900
2025-09-09 09:47:52,375 [INFO] [OOD 4d] Layer 20: acc=0.9900
2025-09-09 09:47:52,376 [INFO] [OOD 4d] Layer 21: acc=0.9833
2025-09-09 09:47:52,378 [INFO] [OOD 4d] Layer 22: acc=0.9867
2025-09-09 09:47:52,379 [INFO] [OOD 4d] Layer 23: acc=0.9833
2025-09-09 09:47:52,381 [INFO] [OOD 4d] Layer 24: acc=0.9867
2025-09-09 09:47:52,382 [INFO] [OOD 4d] Layer 25: acc=0.9767
2025-09-09 09:47:52,384 [INFO] [OOD 4d] Layer 26: acc=0.9667
2025-09-09 09:47:52,385 [INFO] [OOD 4d] Layer 27: acc=0.9633
2025-09-09 09:47:52,387 [INFO] [OOD 4d] Layer 28: acc=0.9600
2025-09-09 09:47:52,387 [INFO] ==================== RUN 2/5 (Seed: 43) ====================
2025-09-09 09:47:52,388 [INFO] Using device: cuda:0
2025-09-09 09:47:52,392 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:47:52,392 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:47:52,394 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:47:52,395 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:47:52,395 [INFO] [TRAIN_COMM_3WAY_Run2] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:48:16,176 [INFO] [TRAIN_COMM_3WAY_Run2] Finished extracting activations.
2025-09-09 09:48:16,179 [INFO] Per-layer classification reports -> ./outputs/Qwen2.5-Math-7B/run_seed_43/probe_3way_comm_Qwen2.5-Math-7B_seed_43_20250909_094816.txt
2025-09-09 09:48:16,179 [INFO] --- Starting Probe Training Loop for layers 1..28 ---
2025-09-09 09:48:16,180 [INFO] --- Processing Layer 1 ---
2025-09-09 09:48:16,456 [INFO] Layer 1 - Training completed.
2025-09-09 09:48:16,458 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_1/state_dict.pt
2025-09-09 09:48:16,473 [INFO] Layer 1 - Test Acc: 0.3467 | F1(C0,C1,C2): 0.000, 0.349, 0.449
2025-09-09 09:48:16,473 [INFO] --- Processing Layer 2 ---
2025-09-09 09:48:16,738 [INFO] Layer 2 - Training completed.
2025-09-09 09:48:16,739 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_2/state_dict.pt
2025-09-09 09:48:16,753 [INFO] Layer 2 - Test Acc: 0.6000 | F1(C0,C1,C2): 0.781, 0.649, 0.148
2025-09-09 09:48:16,753 [INFO] --- Processing Layer 3 ---
2025-09-09 09:48:17,017 [INFO] Layer 3 - Training completed.
2025-09-09 09:48:17,018 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_3/state_dict.pt
2025-09-09 09:48:17,031 [INFO] Layer 3 - Test Acc: 0.7300 | F1(C0,C1,C2): 0.806, 0.767, 0.571
2025-09-09 09:48:17,031 [INFO] --- Processing Layer 4 ---
2025-09-09 09:48:17,303 [INFO] Layer 4 - Training completed.
2025-09-09 09:48:17,305 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_4/state_dict.pt
2025-09-09 09:48:17,319 [INFO] Layer 4 - Test Acc: 0.9333 | F1(C0,C1,C2): 0.907, 0.911, 0.980
2025-09-09 09:48:17,319 [INFO] --- Processing Layer 5 ---
2025-09-09 09:48:17,582 [INFO] Layer 5 - Training completed.
2025-09-09 09:48:17,583 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_5/state_dict.pt
2025-09-09 09:48:17,597 [INFO] Layer 5 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.980, 1.000
2025-09-09 09:48:17,597 [INFO] --- Processing Layer 6 ---
2025-09-09 09:48:17,862 [INFO] Layer 6 - Training completed.
2025-09-09 09:48:17,863 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_6/state_dict.pt
2025-09-09 09:48:17,876 [INFO] Layer 6 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:48:17,877 [INFO] --- Processing Layer 7 ---
2025-09-09 09:48:18,153 [INFO] Layer 7 - Training completed.
2025-09-09 09:48:18,154 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_7/state_dict.pt
2025-09-09 09:48:18,168 [INFO] Layer 7 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.974, 0.976, 1.000
2025-09-09 09:48:18,168 [INFO] --- Processing Layer 8 ---
2025-09-09 09:48:18,435 [INFO] Layer 8 - Training completed.
2025-09-09 09:48:18,436 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_8/state_dict.pt
2025-09-09 09:48:18,450 [INFO] Layer 8 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:48:18,450 [INFO] --- Processing Layer 9 ---
2025-09-09 09:48:18,716 [INFO] Layer 9 - Training completed.
2025-09-09 09:48:18,717 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_9/state_dict.pt
2025-09-09 09:48:18,731 [INFO] Layer 9 - Test Acc: 0.9800 | F1(C0,C1,C2): 0.969, 0.971, 1.000
2025-09-09 09:48:18,731 [INFO] --- Processing Layer 10 ---
2025-09-09 09:48:18,997 [INFO] Layer 10 - Training completed.
2025-09-09 09:48:18,998 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_10/state_dict.pt
2025-09-09 09:48:19,011 [INFO] Layer 10 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:48:19,012 [INFO] --- Processing Layer 11 ---
2025-09-09 09:48:19,278 [INFO] Layer 11 - Training completed.
2025-09-09 09:48:19,279 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_11/state_dict.pt
2025-09-09 09:48:19,293 [INFO] Layer 11 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:48:19,293 [INFO] --- Processing Layer 12 ---
2025-09-09 09:48:19,557 [INFO] Layer 12 - Training completed.
2025-09-09 09:48:19,558 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_12/state_dict.pt
2025-09-09 09:48:19,572 [INFO] Layer 12 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:48:19,572 [INFO] --- Processing Layer 13 ---
2025-09-09 09:48:19,839 [INFO] Layer 13 - Training completed.
2025-09-09 09:48:19,841 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_13/state_dict.pt
2025-09-09 09:48:19,854 [INFO] Layer 13 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:48:19,855 [INFO] --- Processing Layer 14 ---
2025-09-09 09:48:20,122 [INFO] Layer 14 - Training completed.
2025-09-09 09:48:20,123 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_14/state_dict.pt
2025-09-09 09:48:20,137 [INFO] Layer 14 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:48:20,138 [INFO] --- Processing Layer 15 ---
2025-09-09 09:48:20,405 [INFO] Layer 15 - Training completed.
2025-09-09 09:48:20,406 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_15/state_dict.pt
2025-09-09 09:48:20,420 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:48:20,420 [INFO] --- Processing Layer 16 ---
2025-09-09 09:48:20,689 [INFO] Layer 16 - Training completed.
2025-09-09 09:48:20,690 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_16/state_dict.pt
2025-09-09 09:48:20,703 [INFO] Layer 16 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:48:20,704 [INFO] --- Processing Layer 17 ---
2025-09-09 09:48:20,976 [INFO] Layer 17 - Training completed.
2025-09-09 09:48:20,977 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_17/state_dict.pt
2025-09-09 09:48:20,990 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:48:20,991 [INFO] --- Processing Layer 18 ---
2025-09-09 09:48:21,260 [INFO] Layer 18 - Training completed.
2025-09-09 09:48:21,261 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_18/state_dict.pt
2025-09-09 09:48:21,275 [INFO] Layer 18 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:48:21,275 [INFO] --- Processing Layer 19 ---
2025-09-09 09:48:21,544 [INFO] Layer 19 - Training completed.
2025-09-09 09:48:21,545 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_19/state_dict.pt
2025-09-09 09:48:21,559 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:48:21,559 [INFO] --- Processing Layer 20 ---
2025-09-09 09:48:21,825 [INFO] Layer 20 - Training completed.
2025-09-09 09:48:21,826 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_20/state_dict.pt
2025-09-09 09:48:21,841 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:48:21,841 [INFO] --- Processing Layer 21 ---
2025-09-09 09:48:22,109 [INFO] Layer 21 - Training completed.
2025-09-09 09:48:22,110 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_21/state_dict.pt
2025-09-09 09:48:22,124 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:48:22,124 [INFO] --- Processing Layer 22 ---
2025-09-09 09:48:22,394 [INFO] Layer 22 - Training completed.
2025-09-09 09:48:22,395 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_22/state_dict.pt
2025-09-09 09:48:22,409 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:48:22,410 [INFO] --- Processing Layer 23 ---
2025-09-09 09:48:22,680 [INFO] Layer 23 - Training completed.
2025-09-09 09:48:22,681 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_23/state_dict.pt
2025-09-09 09:48:22,695 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:48:22,695 [INFO] --- Processing Layer 24 ---
2025-09-09 09:48:22,964 [INFO] Layer 24 - Training completed.
2025-09-09 09:48:22,965 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_24/state_dict.pt
2025-09-09 09:48:22,979 [INFO] Layer 24 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:48:22,979 [INFO] --- Processing Layer 25 ---
2025-09-09 09:48:23,244 [INFO] Layer 25 - Training completed.
2025-09-09 09:48:23,245 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_25/state_dict.pt
2025-09-09 09:48:23,259 [INFO] Layer 25 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:48:23,259 [INFO] --- Processing Layer 26 ---
2025-09-09 09:48:23,523 [INFO] Layer 26 - Training completed.
2025-09-09 09:48:23,525 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_26/state_dict.pt
2025-09-09 09:48:23,538 [INFO] Layer 26 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:48:23,538 [INFO] --- Processing Layer 27 ---
2025-09-09 09:48:23,804 [INFO] Layer 27 - Training completed.
2025-09-09 09:48:23,805 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_27/state_dict.pt
2025-09-09 09:48:23,819 [INFO] Layer 27 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:48:23,819 [INFO] --- Processing Layer 28 ---
2025-09-09 09:48:24,083 [INFO] Layer 28 - Training completed.
2025-09-09 09:48:24,085 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_43/layer_28/state_dict.pt
2025-09-09 09:48:24,098 [INFO] Layer 28 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:48:24,099 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:48:24,099 [INFO] --- Generating OOD Datasets for Run 2 ---
2025-09-09 09:48:24,105 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:48:24,108 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:48:24,143 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:48:28,191 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:48:28,193 [INFO] [OOD 1d] Layer 1: acc=0.3333
2025-09-09 09:48:28,195 [INFO] [OOD 1d] Layer 2: acc=0.3600
2025-09-09 09:48:28,197 [INFO] [OOD 1d] Layer 3: acc=0.4233
2025-09-09 09:48:28,198 [INFO] [OOD 1d] Layer 4: acc=0.4700
2025-09-09 09:48:28,199 [INFO] [OOD 1d] Layer 5: acc=0.9067
2025-09-09 09:48:28,201 [INFO] [OOD 1d] Layer 6: acc=0.7600
2025-09-09 09:48:28,203 [INFO] [OOD 1d] Layer 7: acc=0.8900
2025-09-09 09:48:28,204 [INFO] [OOD 1d] Layer 8: acc=0.6267
2025-09-09 09:48:28,206 [INFO] [OOD 1d] Layer 9: acc=0.9233
2025-09-09 09:48:28,207 [INFO] [OOD 1d] Layer 10: acc=0.7567
2025-09-09 09:48:28,209 [INFO] [OOD 1d] Layer 11: acc=0.8833
2025-09-09 09:48:28,210 [INFO] [OOD 1d] Layer 12: acc=0.7733
2025-09-09 09:48:28,212 [INFO] [OOD 1d] Layer 13: acc=0.8833
2025-09-09 09:48:28,213 [INFO] [OOD 1d] Layer 14: acc=0.9167
2025-09-09 09:48:28,215 [INFO] [OOD 1d] Layer 15: acc=0.9133
2025-09-09 09:48:28,216 [INFO] [OOD 1d] Layer 16: acc=0.8500
2025-09-09 09:48:28,218 [INFO] [OOD 1d] Layer 17: acc=0.8067
2025-09-09 09:48:28,219 [INFO] [OOD 1d] Layer 18: acc=0.7333
2025-09-09 09:48:28,221 [INFO] [OOD 1d] Layer 19: acc=0.9467
2025-09-09 09:48:28,222 [INFO] [OOD 1d] Layer 20: acc=1.0000
2025-09-09 09:48:28,223 [INFO] [OOD 1d] Layer 21: acc=1.0000
2025-09-09 09:48:28,225 [INFO] [OOD 1d] Layer 22: acc=0.9733
2025-09-09 09:48:28,226 [INFO] [OOD 1d] Layer 23: acc=1.0000
2025-09-09 09:48:28,228 [INFO] [OOD 1d] Layer 24: acc=1.0000
2025-09-09 09:48:28,230 [INFO] [OOD 1d] Layer 25: acc=0.9900
2025-09-09 09:48:28,231 [INFO] [OOD 1d] Layer 26: acc=0.9867
2025-09-09 09:48:28,233 [INFO] [OOD 1d] Layer 27: acc=1.0000
2025-09-09 09:48:28,234 [INFO] [OOD 1d] Layer 28: acc=1.0000
2025-09-09 09:48:28,234 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:48:31,489 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:48:31,491 [INFO] [OOD 2d] Layer 1: acc=0.2250
2025-09-09 09:48:31,493 [INFO] [OOD 2d] Layer 2: acc=0.8900
2025-09-09 09:48:31,494 [INFO] [OOD 2d] Layer 3: acc=0.9000
2025-09-09 09:48:31,495 [INFO] [OOD 2d] Layer 4: acc=0.9250
2025-09-09 09:48:31,496 [INFO] [OOD 2d] Layer 5: acc=0.9750
2025-09-09 09:48:31,497 [INFO] [OOD 2d] Layer 6: acc=0.9900
2025-09-09 09:48:31,498 [INFO] [OOD 2d] Layer 7: acc=0.9900
2025-09-09 09:48:31,499 [INFO] [OOD 2d] Layer 8: acc=0.9900
2025-09-09 09:48:31,501 [INFO] [OOD 2d] Layer 9: acc=0.9800
2025-09-09 09:48:31,502 [INFO] [OOD 2d] Layer 10: acc=0.9950
2025-09-09 09:48:31,503 [INFO] [OOD 2d] Layer 11: acc=1.0000
2025-09-09 09:48:31,504 [INFO] [OOD 2d] Layer 12: acc=1.0000
2025-09-09 09:48:31,505 [INFO] [OOD 2d] Layer 13: acc=1.0000
2025-09-09 09:48:31,506 [INFO] [OOD 2d] Layer 14: acc=1.0000
2025-09-09 09:48:31,507 [INFO] [OOD 2d] Layer 15: acc=1.0000
2025-09-09 09:48:31,509 [INFO] [OOD 2d] Layer 16: acc=1.0000
2025-09-09 09:48:31,510 [INFO] [OOD 2d] Layer 17: acc=1.0000
2025-09-09 09:48:31,511 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:48:31,512 [INFO] [OOD 2d] Layer 19: acc=1.0000
2025-09-09 09:48:31,513 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:48:31,514 [INFO] [OOD 2d] Layer 21: acc=1.0000
2025-09-09 09:48:31,515 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:48:31,516 [INFO] [OOD 2d] Layer 23: acc=1.0000
2025-09-09 09:48:31,518 [INFO] [OOD 2d] Layer 24: acc=1.0000
2025-09-09 09:48:31,519 [INFO] [OOD 2d] Layer 25: acc=0.9900
2025-09-09 09:48:31,520 [INFO] [OOD 2d] Layer 26: acc=1.0000
2025-09-09 09:48:31,521 [INFO] [OOD 2d] Layer 27: acc=0.9900
2025-09-09 09:48:31,522 [INFO] [OOD 2d] Layer 28: acc=0.9900
2025-09-09 09:48:31,522 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:48:37,341 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:48:37,344 [INFO] [OOD 3d] Layer 1: acc=0.4500
2025-09-09 09:48:37,345 [INFO] [OOD 3d] Layer 2: acc=0.3833
2025-09-09 09:48:37,347 [INFO] [OOD 3d] Layer 3: acc=0.5400
2025-09-09 09:48:37,348 [INFO] [OOD 3d] Layer 4: acc=0.8667
2025-09-09 09:48:37,350 [INFO] [OOD 3d] Layer 5: acc=0.8133
2025-09-09 09:48:37,351 [INFO] [OOD 3d] Layer 6: acc=0.8133
2025-09-09 09:48:37,353 [INFO] [OOD 3d] Layer 7: acc=0.8800
2025-09-09 09:48:37,354 [INFO] [OOD 3d] Layer 8: acc=0.8067
2025-09-09 09:48:37,356 [INFO] [OOD 3d] Layer 9: acc=0.7767
2025-09-09 09:48:37,357 [INFO] [OOD 3d] Layer 10: acc=0.9333
2025-09-09 09:48:37,359 [INFO] [OOD 3d] Layer 11: acc=0.9700
2025-09-09 09:48:37,360 [INFO] [OOD 3d] Layer 12: acc=0.9300
2025-09-09 09:48:37,362 [INFO] [OOD 3d] Layer 13: acc=0.8200
2025-09-09 09:48:37,363 [INFO] [OOD 3d] Layer 14: acc=0.8967
2025-09-09 09:48:37,365 [INFO] [OOD 3d] Layer 15: acc=0.7967
2025-09-09 09:48:37,366 [INFO] [OOD 3d] Layer 16: acc=0.8333
2025-09-09 09:48:37,368 [INFO] [OOD 3d] Layer 17: acc=0.8500
2025-09-09 09:48:37,369 [INFO] [OOD 3d] Layer 18: acc=0.8167
2025-09-09 09:48:37,371 [INFO] [OOD 3d] Layer 19: acc=0.9767
2025-09-09 09:48:37,372 [INFO] [OOD 3d] Layer 20: acc=0.9933
2025-09-09 09:48:37,374 [INFO] [OOD 3d] Layer 21: acc=0.9800
2025-09-09 09:48:37,375 [INFO] [OOD 3d] Layer 22: acc=0.9800
2025-09-09 09:48:37,377 [INFO] [OOD 3d] Layer 23: acc=0.9733
2025-09-09 09:48:37,378 [INFO] [OOD 3d] Layer 24: acc=0.9700
2025-09-09 09:48:37,379 [INFO] [OOD 3d] Layer 25: acc=0.9800
2025-09-09 09:48:37,381 [INFO] [OOD 3d] Layer 26: acc=0.9900
2025-09-09 09:48:37,383 [INFO] [OOD 3d] Layer 27: acc=0.9767
2025-09-09 09:48:37,384 [INFO] [OOD 3d] Layer 28: acc=0.9800
2025-09-09 09:48:37,384 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:48:43,805 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:48:43,808 [INFO] [OOD 4d] Layer 1: acc=0.3933
2025-09-09 09:48:43,810 [INFO] [OOD 4d] Layer 2: acc=0.3400
2025-09-09 09:48:43,811 [INFO] [OOD 4d] Layer 3: acc=0.3800
2025-09-09 09:48:43,813 [INFO] [OOD 4d] Layer 4: acc=0.5933
2025-09-09 09:48:43,814 [INFO] [OOD 4d] Layer 5: acc=0.8400
2025-09-09 09:48:43,815 [INFO] [OOD 4d] Layer 6: acc=0.8700
2025-09-09 09:48:43,817 [INFO] [OOD 4d] Layer 7: acc=0.6733
2025-09-09 09:48:43,819 [INFO] [OOD 4d] Layer 8: acc=0.6667
2025-09-09 09:48:43,820 [INFO] [OOD 4d] Layer 9: acc=0.6467
2025-09-09 09:48:43,822 [INFO] [OOD 4d] Layer 10: acc=0.6733
2025-09-09 09:48:43,823 [INFO] [OOD 4d] Layer 11: acc=0.6867
2025-09-09 09:48:43,825 [INFO] [OOD 4d] Layer 12: acc=0.6800
2025-09-09 09:48:43,826 [INFO] [OOD 4d] Layer 13: acc=0.6667
2025-09-09 09:48:43,828 [INFO] [OOD 4d] Layer 14: acc=0.6733
2025-09-09 09:48:43,829 [INFO] [OOD 4d] Layer 15: acc=0.6667
2025-09-09 09:48:43,831 [INFO] [OOD 4d] Layer 16: acc=0.6667
2025-09-09 09:48:43,832 [INFO] [OOD 4d] Layer 17: acc=0.6667
2025-09-09 09:48:43,834 [INFO] [OOD 4d] Layer 18: acc=0.6667
2025-09-09 09:48:43,835 [INFO] [OOD 4d] Layer 19: acc=0.8533
2025-09-09 09:48:43,837 [INFO] [OOD 4d] Layer 20: acc=0.9933
2025-09-09 09:48:43,838 [INFO] [OOD 4d] Layer 21: acc=0.9900
2025-09-09 09:48:43,840 [INFO] [OOD 4d] Layer 22: acc=0.9867
2025-09-09 09:48:43,841 [INFO] [OOD 4d] Layer 23: acc=0.9800
2025-09-09 09:48:43,843 [INFO] [OOD 4d] Layer 24: acc=0.9900
2025-09-09 09:48:43,844 [INFO] [OOD 4d] Layer 25: acc=0.9767
2025-09-09 09:48:43,846 [INFO] [OOD 4d] Layer 26: acc=0.9733
2025-09-09 09:48:43,847 [INFO] [OOD 4d] Layer 27: acc=0.9700
2025-09-09 09:48:43,849 [INFO] [OOD 4d] Layer 28: acc=0.9733
2025-09-09 09:48:43,849 [INFO] ==================== RUN 3/5 (Seed: 44) ====================
2025-09-09 09:48:43,850 [INFO] Using device: cuda:0
2025-09-09 09:48:43,854 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:48:43,854 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:48:43,856 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:48:43,857 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:48:43,857 [INFO] [TRAIN_COMM_3WAY_Run3] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:49:07,488 [INFO] [TRAIN_COMM_3WAY_Run3] Finished extracting activations.
2025-09-09 09:49:07,520 [INFO] Per-layer classification reports -> ./outputs/Qwen2.5-Math-7B/run_seed_44/probe_3way_comm_Qwen2.5-Math-7B_seed_44_20250909_094907.txt
2025-09-09 09:49:07,520 [INFO] --- Starting Probe Training Loop for layers 1..28 ---
2025-09-09 09:49:07,521 [INFO] --- Processing Layer 1 ---
2025-09-09 09:49:07,792 [INFO] Layer 1 - Training completed.
2025-09-09 09:49:07,793 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_1/state_dict.pt
2025-09-09 09:49:07,807 [INFO] Layer 1 - Test Acc: 0.3867 | F1(C0,C1,C2): 0.513, 0.131, 0.320
2025-09-09 09:49:07,807 [INFO] --- Processing Layer 2 ---
2025-09-09 09:49:08,075 [INFO] Layer 2 - Training completed.
2025-09-09 09:49:08,077 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_2/state_dict.pt
2025-09-09 09:49:08,090 [INFO] Layer 2 - Test Acc: 0.6833 | F1(C0,C1,C2): 0.739, 0.707, 0.612
2025-09-09 09:49:08,090 [INFO] --- Processing Layer 3 ---
2025-09-09 09:49:08,354 [INFO] Layer 3 - Training completed.
2025-09-09 09:49:08,355 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_3/state_dict.pt
2025-09-09 09:49:08,369 [INFO] Layer 3 - Test Acc: 0.7167 | F1(C0,C1,C2): 0.811, 0.743, 0.548
2025-09-09 09:49:08,369 [INFO] --- Processing Layer 4 ---
2025-09-09 09:49:08,638 [INFO] Layer 4 - Training completed.
2025-09-09 09:49:08,639 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_4/state_dict.pt
2025-09-09 09:49:08,653 [INFO] Layer 4 - Test Acc: 0.8567 | F1(C0,C1,C2): 0.858, 0.726, 0.952
2025-09-09 09:49:08,653 [INFO] --- Processing Layer 5 ---
2025-09-09 09:49:08,921 [INFO] Layer 5 - Training completed.
2025-09-09 09:49:08,922 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_5/state_dict.pt
2025-09-09 09:49:08,935 [INFO] Layer 5 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:49:08,935 [INFO] --- Processing Layer 6 ---
2025-09-09 09:49:09,201 [INFO] Layer 6 - Training completed.
2025-09-09 09:49:09,202 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_6/state_dict.pt
2025-09-09 09:49:09,216 [INFO] Layer 6 - Test Acc: 0.9667 | F1(C0,C1,C2): 0.947, 0.952, 1.000
2025-09-09 09:49:09,216 [INFO] --- Processing Layer 7 ---
2025-09-09 09:49:09,484 [INFO] Layer 7 - Training completed.
2025-09-09 09:49:09,485 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_7/state_dict.pt
2025-09-09 09:49:09,499 [INFO] Layer 7 - Test Acc: 0.9667 | F1(C0,C1,C2): 0.947, 0.952, 1.000
2025-09-09 09:49:09,499 [INFO] --- Processing Layer 8 ---
2025-09-09 09:49:09,771 [INFO] Layer 8 - Training completed.
2025-09-09 09:49:09,772 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_8/state_dict.pt
2025-09-09 09:49:09,786 [INFO] Layer 8 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:49:09,786 [INFO] --- Processing Layer 9 ---
2025-09-09 09:49:10,053 [INFO] Layer 9 - Training completed.
2025-09-09 09:49:10,054 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_9/state_dict.pt
2025-09-09 09:49:10,068 [INFO] Layer 9 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:49:10,069 [INFO] --- Processing Layer 10 ---
2025-09-09 09:49:10,337 [INFO] Layer 10 - Training completed.
2025-09-09 09:49:10,338 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_10/state_dict.pt
2025-09-09 09:49:10,352 [INFO] Layer 10 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:49:10,352 [INFO] --- Processing Layer 11 ---
2025-09-09 09:49:10,620 [INFO] Layer 11 - Training completed.
2025-09-09 09:49:10,621 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_11/state_dict.pt
2025-09-09 09:49:10,635 [INFO] Layer 11 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:49:10,635 [INFO] --- Processing Layer 12 ---
2025-09-09 09:49:10,903 [INFO] Layer 12 - Training completed.
2025-09-09 09:49:10,904 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_12/state_dict.pt
2025-09-09 09:49:10,918 [INFO] Layer 12 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:49:10,918 [INFO] --- Processing Layer 13 ---
2025-09-09 09:49:11,190 [INFO] Layer 13 - Training completed.
2025-09-09 09:49:11,191 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_13/state_dict.pt
2025-09-09 09:49:11,205 [INFO] Layer 13 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:49:11,206 [INFO] --- Processing Layer 14 ---
2025-09-09 09:49:11,475 [INFO] Layer 14 - Training completed.
2025-09-09 09:49:11,476 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_14/state_dict.pt
2025-09-09 09:49:11,490 [INFO] Layer 14 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:49:11,491 [INFO] --- Processing Layer 15 ---
2025-09-09 09:49:11,760 [INFO] Layer 15 - Training completed.
2025-09-09 09:49:11,761 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_15/state_dict.pt
2025-09-09 09:49:11,775 [INFO] Layer 15 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:49:11,775 [INFO] --- Processing Layer 16 ---
2025-09-09 09:49:12,043 [INFO] Layer 16 - Training completed.
2025-09-09 09:49:12,045 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_16/state_dict.pt
2025-09-09 09:49:12,058 [INFO] Layer 16 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:49:12,058 [INFO] --- Processing Layer 17 ---
2025-09-09 09:49:12,334 [INFO] Layer 17 - Training completed.
2025-09-09 09:49:12,335 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_17/state_dict.pt
2025-09-09 09:49:12,351 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:49:12,351 [INFO] --- Processing Layer 18 ---
2025-09-09 09:49:12,616 [INFO] Layer 18 - Training completed.
2025-09-09 09:49:12,617 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_18/state_dict.pt
2025-09-09 09:49:12,631 [INFO] Layer 18 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:49:12,631 [INFO] --- Processing Layer 19 ---
2025-09-09 09:49:12,898 [INFO] Layer 19 - Training completed.
2025-09-09 09:49:12,899 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_19/state_dict.pt
2025-09-09 09:49:12,913 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:49:12,913 [INFO] --- Processing Layer 20 ---
2025-09-09 09:49:13,179 [INFO] Layer 20 - Training completed.
2025-09-09 09:49:13,181 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_20/state_dict.pt
2025-09-09 09:49:13,194 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:49:13,195 [INFO] --- Processing Layer 21 ---
2025-09-09 09:49:13,462 [INFO] Layer 21 - Training completed.
2025-09-09 09:49:13,463 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_21/state_dict.pt
2025-09-09 09:49:13,477 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:49:13,477 [INFO] --- Processing Layer 22 ---
2025-09-09 09:49:13,741 [INFO] Layer 22 - Training completed.
2025-09-09 09:49:13,742 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_22/state_dict.pt
2025-09-09 09:49:13,756 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:49:13,756 [INFO] --- Processing Layer 23 ---
2025-09-09 09:49:14,023 [INFO] Layer 23 - Training completed.
2025-09-09 09:49:14,025 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_23/state_dict.pt
2025-09-09 09:49:14,038 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:49:14,038 [INFO] --- Processing Layer 24 ---
2025-09-09 09:49:14,306 [INFO] Layer 24 - Training completed.
2025-09-09 09:49:14,307 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_24/state_dict.pt
2025-09-09 09:49:14,321 [INFO] Layer 24 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:49:14,321 [INFO] --- Processing Layer 25 ---
2025-09-09 09:49:14,587 [INFO] Layer 25 - Training completed.
2025-09-09 09:49:14,589 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_25/state_dict.pt
2025-09-09 09:49:14,602 [INFO] Layer 25 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:49:14,603 [INFO] --- Processing Layer 26 ---
2025-09-09 09:49:14,868 [INFO] Layer 26 - Training completed.
2025-09-09 09:49:14,869 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_26/state_dict.pt
2025-09-09 09:49:14,883 [INFO] Layer 26 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:49:14,883 [INFO] --- Processing Layer 27 ---
2025-09-09 09:49:15,153 [INFO] Layer 27 - Training completed.
2025-09-09 09:49:15,154 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_27/state_dict.pt
2025-09-09 09:49:15,168 [INFO] Layer 27 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:49:15,168 [INFO] --- Processing Layer 28 ---
2025-09-09 09:49:15,435 [INFO] Layer 28 - Training completed.
2025-09-09 09:49:15,437 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_44/layer_28/state_dict.pt
2025-09-09 09:49:15,450 [INFO] Layer 28 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:49:15,451 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:49:15,451 [INFO] --- Generating OOD Datasets for Run 3 ---
2025-09-09 09:49:15,457 [WARNING] [WARN] OOD Class-2 (2-digit): Got 1/100
2025-09-09 09:49:15,459 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:49:15,494 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:49:19,511 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:49:19,514 [INFO] [OOD 1d] Layer 1: acc=0.3200
2025-09-09 09:49:19,516 [INFO] [OOD 1d] Layer 2: acc=0.4367
2025-09-09 09:49:19,517 [INFO] [OOD 1d] Layer 3: acc=0.5400
2025-09-09 09:49:19,519 [INFO] [OOD 1d] Layer 4: acc=0.3333
2025-09-09 09:49:19,520 [INFO] [OOD 1d] Layer 5: acc=0.8667
2025-09-09 09:49:19,522 [INFO] [OOD 1d] Layer 6: acc=0.6367
2025-09-09 09:49:19,523 [INFO] [OOD 1d] Layer 7: acc=0.8133
2025-09-09 09:49:19,525 [INFO] [OOD 1d] Layer 8: acc=0.6767
2025-09-09 09:49:19,526 [INFO] [OOD 1d] Layer 9: acc=0.8867
2025-09-09 09:49:19,528 [INFO] [OOD 1d] Layer 10: acc=0.8667
2025-09-09 09:49:19,530 [INFO] [OOD 1d] Layer 11: acc=0.9567
2025-09-09 09:49:19,531 [INFO] [OOD 1d] Layer 12: acc=0.9400
2025-09-09 09:49:19,532 [INFO] [OOD 1d] Layer 13: acc=0.9333
2025-09-09 09:49:19,534 [INFO] [OOD 1d] Layer 14: acc=0.9600
2025-09-09 09:49:19,535 [INFO] [OOD 1d] Layer 15: acc=0.8700
2025-09-09 09:49:19,537 [INFO] [OOD 1d] Layer 16: acc=0.9100
2025-09-09 09:49:19,538 [INFO] [OOD 1d] Layer 17: acc=0.8867
2025-09-09 09:49:19,540 [INFO] [OOD 1d] Layer 18: acc=0.8733
2025-09-09 09:49:19,541 [INFO] [OOD 1d] Layer 19: acc=0.9367
2025-09-09 09:49:19,543 [INFO] [OOD 1d] Layer 20: acc=1.0000
2025-09-09 09:49:19,545 [INFO] [OOD 1d] Layer 21: acc=1.0000
2025-09-09 09:49:19,546 [INFO] [OOD 1d] Layer 22: acc=0.9867
2025-09-09 09:49:19,547 [INFO] [OOD 1d] Layer 23: acc=1.0000
2025-09-09 09:49:19,549 [INFO] [OOD 1d] Layer 24: acc=1.0000
2025-09-09 09:49:19,551 [INFO] [OOD 1d] Layer 25: acc=1.0000
2025-09-09 09:49:19,553 [INFO] [OOD 1d] Layer 26: acc=0.9900
2025-09-09 09:49:19,554 [INFO] [OOD 1d] Layer 27: acc=1.0000
2025-09-09 09:49:19,556 [INFO] [OOD 1d] Layer 28: acc=1.0000
2025-09-09 09:49:19,556 [INFO] [OOD_2d_ALL] Extracting activations for 201 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:49:22,806 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:49:22,808 [INFO] [OOD 2d] Layer 1: acc=0.4478
2025-09-09 09:49:22,809 [INFO] [OOD 2d] Layer 2: acc=0.7761
2025-09-09 09:49:22,811 [INFO] [OOD 2d] Layer 3: acc=0.8806
2025-09-09 09:49:22,812 [INFO] [OOD 2d] Layer 4: acc=0.8010
2025-09-09 09:49:22,813 [INFO] [OOD 2d] Layer 5: acc=0.9900
2025-09-09 09:49:22,814 [INFO] [OOD 2d] Layer 6: acc=0.9502
2025-09-09 09:49:22,815 [INFO] [OOD 2d] Layer 7: acc=0.9552
2025-09-09 09:49:22,817 [INFO] [OOD 2d] Layer 8: acc=0.9950
2025-09-09 09:49:22,818 [INFO] [OOD 2d] Layer 9: acc=1.0000
2025-09-09 09:49:22,819 [INFO] [OOD 2d] Layer 10: acc=0.9950
2025-09-09 09:49:22,821 [INFO] [OOD 2d] Layer 11: acc=1.0000
2025-09-09 09:49:22,822 [INFO] [OOD 2d] Layer 12: acc=1.0000
2025-09-09 09:49:22,823 [INFO] [OOD 2d] Layer 13: acc=1.0000
2025-09-09 09:49:22,824 [INFO] [OOD 2d] Layer 14: acc=1.0000
2025-09-09 09:49:22,825 [INFO] [OOD 2d] Layer 15: acc=1.0000
2025-09-09 09:49:22,826 [INFO] [OOD 2d] Layer 16: acc=1.0000
2025-09-09 09:49:22,827 [INFO] [OOD 2d] Layer 17: acc=1.0000
2025-09-09 09:49:22,829 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:49:22,830 [INFO] [OOD 2d] Layer 19: acc=1.0000
2025-09-09 09:49:22,831 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:49:22,832 [INFO] [OOD 2d] Layer 21: acc=1.0000
2025-09-09 09:49:22,833 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:49:22,834 [INFO] [OOD 2d] Layer 23: acc=1.0000
2025-09-09 09:49:22,835 [INFO] [OOD 2d] Layer 24: acc=1.0000
2025-09-09 09:49:22,837 [INFO] [OOD 2d] Layer 25: acc=0.9851
2025-09-09 09:49:22,838 [INFO] [OOD 2d] Layer 26: acc=0.9851
2025-09-09 09:49:22,839 [INFO] [OOD 2d] Layer 27: acc=0.9950
2025-09-09 09:49:22,840 [INFO] [OOD 2d] Layer 28: acc=0.9950
2025-09-09 09:49:22,840 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:49:28,682 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:49:28,684 [INFO] [OOD 3d] Layer 1: acc=0.3667
2025-09-09 09:49:28,686 [INFO] [OOD 3d] Layer 2: acc=0.4400
2025-09-09 09:49:28,687 [INFO] [OOD 3d] Layer 3: acc=0.5967
2025-09-09 09:49:28,689 [INFO] [OOD 3d] Layer 4: acc=0.6867
2025-09-09 09:49:28,690 [INFO] [OOD 3d] Layer 5: acc=0.8100
2025-09-09 09:49:28,692 [INFO] [OOD 3d] Layer 6: acc=0.8700
2025-09-09 09:49:28,693 [INFO] [OOD 3d] Layer 7: acc=0.8467
2025-09-09 09:49:28,695 [INFO] [OOD 3d] Layer 8: acc=0.9033
2025-09-09 09:49:28,697 [INFO] [OOD 3d] Layer 9: acc=0.8300
2025-09-09 09:49:28,698 [INFO] [OOD 3d] Layer 10: acc=0.9700
2025-09-09 09:49:28,699 [INFO] [OOD 3d] Layer 11: acc=0.9800
2025-09-09 09:49:28,701 [INFO] [OOD 3d] Layer 12: acc=0.9733
2025-09-09 09:49:28,702 [INFO] [OOD 3d] Layer 13: acc=0.9833
2025-09-09 09:49:28,704 [INFO] [OOD 3d] Layer 14: acc=0.9767
2025-09-09 09:49:28,705 [INFO] [OOD 3d] Layer 15: acc=0.9667
2025-09-09 09:49:28,707 [INFO] [OOD 3d] Layer 16: acc=0.9167
2025-09-09 09:49:28,708 [INFO] [OOD 3d] Layer 17: acc=0.8933
2025-09-09 09:49:28,710 [INFO] [OOD 3d] Layer 18: acc=0.9400
2025-09-09 09:49:28,711 [INFO] [OOD 3d] Layer 19: acc=0.9867
2025-09-09 09:49:28,713 [INFO] [OOD 3d] Layer 20: acc=0.9933
2025-09-09 09:49:28,714 [INFO] [OOD 3d] Layer 21: acc=0.9933
2025-09-09 09:49:28,716 [INFO] [OOD 3d] Layer 22: acc=0.9833
2025-09-09 09:49:28,717 [INFO] [OOD 3d] Layer 23: acc=0.9800
2025-09-09 09:49:28,719 [INFO] [OOD 3d] Layer 24: acc=0.9700
2025-09-09 09:49:28,720 [INFO] [OOD 3d] Layer 25: acc=0.9767
2025-09-09 09:49:28,722 [INFO] [OOD 3d] Layer 26: acc=0.9867
2025-09-09 09:49:28,723 [INFO] [OOD 3d] Layer 27: acc=0.9867
2025-09-09 09:49:28,725 [INFO] [OOD 3d] Layer 28: acc=0.9933
2025-09-09 09:49:28,725 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:49:35,181 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:49:35,183 [INFO] [OOD 4d] Layer 1: acc=0.3400
2025-09-09 09:49:35,185 [INFO] [OOD 4d] Layer 2: acc=0.4200
2025-09-09 09:49:35,187 [INFO] [OOD 4d] Layer 3: acc=0.4733
2025-09-09 09:49:35,188 [INFO] [OOD 4d] Layer 4: acc=0.8367
2025-09-09 09:49:35,190 [INFO] [OOD 4d] Layer 5: acc=0.8567
2025-09-09 09:49:35,191 [INFO] [OOD 4d] Layer 6: acc=0.8200
2025-09-09 09:49:35,193 [INFO] [OOD 4d] Layer 7: acc=0.6733
2025-09-09 09:49:35,195 [INFO] [OOD 4d] Layer 8: acc=0.6733
2025-09-09 09:49:35,196 [INFO] [OOD 4d] Layer 9: acc=0.6700
2025-09-09 09:49:35,198 [INFO] [OOD 4d] Layer 10: acc=0.7300
2025-09-09 09:49:35,200 [INFO] [OOD 4d] Layer 11: acc=0.7167
2025-09-09 09:49:35,201 [INFO] [OOD 4d] Layer 12: acc=0.7533
2025-09-09 09:49:35,203 [INFO] [OOD 4d] Layer 13: acc=0.7433
2025-09-09 09:49:35,205 [INFO] [OOD 4d] Layer 14: acc=0.7000
2025-09-09 09:49:35,206 [INFO] [OOD 4d] Layer 15: acc=0.6700
2025-09-09 09:49:35,208 [INFO] [OOD 4d] Layer 16: acc=0.6800
2025-09-09 09:49:35,209 [INFO] [OOD 4d] Layer 17: acc=0.6700
2025-09-09 09:49:35,211 [INFO] [OOD 4d] Layer 18: acc=0.6733
2025-09-09 09:49:35,212 [INFO] [OOD 4d] Layer 19: acc=0.9833
2025-09-09 09:49:35,214 [INFO] [OOD 4d] Layer 20: acc=0.9933
2025-09-09 09:49:35,215 [INFO] [OOD 4d] Layer 21: acc=0.9900
2025-09-09 09:49:35,217 [INFO] [OOD 4d] Layer 22: acc=0.9800
2025-09-09 09:49:35,218 [INFO] [OOD 4d] Layer 23: acc=0.9700
2025-09-09 09:49:35,220 [INFO] [OOD 4d] Layer 24: acc=0.9767
2025-09-09 09:49:35,221 [INFO] [OOD 4d] Layer 25: acc=0.9800
2025-09-09 09:49:35,223 [INFO] [OOD 4d] Layer 26: acc=0.9667
2025-09-09 09:49:35,224 [INFO] [OOD 4d] Layer 27: acc=0.9700
2025-09-09 09:49:35,226 [INFO] [OOD 4d] Layer 28: acc=0.9833
2025-09-09 09:49:35,226 [INFO] ==================== RUN 4/5 (Seed: 45) ====================
2025-09-09 09:49:35,227 [INFO] Using device: cuda:0
2025-09-09 09:49:35,231 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:49:35,231 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:49:35,233 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:49:35,234 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:49:35,235 [INFO] [TRAIN_COMM_3WAY_Run4] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:49:59,125 [INFO] [TRAIN_COMM_3WAY_Run4] Finished extracting activations.
2025-09-09 09:49:59,127 [INFO] Per-layer classification reports -> ./outputs/Qwen2.5-Math-7B/run_seed_45/probe_3way_comm_Qwen2.5-Math-7B_seed_45_20250909_094959.txt
2025-09-09 09:49:59,127 [INFO] --- Starting Probe Training Loop for layers 1..28 ---
2025-09-09 09:49:59,127 [INFO] --- Processing Layer 1 ---
2025-09-09 09:49:59,402 [INFO] Layer 1 - Training completed.
2025-09-09 09:49:59,404 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_1/state_dict.pt
2025-09-09 09:49:59,418 [INFO] Layer 1 - Test Acc: 0.5000 | F1(C0,C1,C2): 0.599, 0.391, 0.439
2025-09-09 09:49:59,418 [INFO] --- Processing Layer 2 ---
2025-09-09 09:49:59,689 [INFO] Layer 2 - Training completed.
2025-09-09 09:49:59,690 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_2/state_dict.pt
2025-09-09 09:49:59,704 [INFO] Layer 2 - Test Acc: 0.7833 | F1(C0,C1,C2): 0.815, 0.786, 0.757
2025-09-09 09:49:59,704 [INFO] --- Processing Layer 3 ---
2025-09-09 09:49:59,987 [INFO] Layer 3 - Training completed.
2025-09-09 09:49:59,988 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_3/state_dict.pt
2025-09-09 09:50:00,002 [INFO] Layer 3 - Test Acc: 0.7333 | F1(C0,C1,C2): 0.839, 0.772, 0.489
2025-09-09 09:50:00,002 [INFO] --- Processing Layer 4 ---
2025-09-09 09:50:00,281 [INFO] Layer 4 - Training completed.
2025-09-09 09:50:00,282 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_4/state_dict.pt
2025-09-09 09:50:00,296 [INFO] Layer 4 - Test Acc: 0.9633 | F1(C0,C1,C2): 0.949, 0.950, 0.990
2025-09-09 09:50:00,296 [INFO] --- Processing Layer 5 ---
2025-09-09 09:50:00,573 [INFO] Layer 5 - Training completed.
2025-09-09 09:50:00,574 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_5/state_dict.pt
2025-09-09 09:50:00,587 [INFO] Layer 5 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:50:00,588 [INFO] --- Processing Layer 6 ---
2025-09-09 09:50:00,869 [INFO] Layer 6 - Training completed.
2025-09-09 09:50:00,870 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_6/state_dict.pt
2025-09-09 09:50:00,884 [INFO] Layer 6 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:50:00,884 [INFO] --- Processing Layer 7 ---
2025-09-09 09:50:01,179 [INFO] Layer 7 - Training completed.
2025-09-09 09:50:01,181 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_7/state_dict.pt
2025-09-09 09:50:01,200 [INFO] Layer 7 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:50:01,200 [INFO] --- Processing Layer 8 ---
2025-09-09 09:50:01,486 [INFO] Layer 8 - Training completed.
2025-09-09 09:50:01,487 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_8/state_dict.pt
2025-09-09 09:50:01,501 [INFO] Layer 8 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.974, 0.976, 1.000
2025-09-09 09:50:01,501 [INFO] --- Processing Layer 9 ---
2025-09-09 09:50:01,783 [INFO] Layer 9 - Training completed.
2025-09-09 09:50:01,785 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_9/state_dict.pt
2025-09-09 09:50:01,799 [INFO] Layer 9 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:50:01,799 [INFO] --- Processing Layer 10 ---
2025-09-09 09:50:02,073 [INFO] Layer 10 - Training completed.
2025-09-09 09:50:02,074 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_10/state_dict.pt
2025-09-09 09:50:02,088 [INFO] Layer 10 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:02,089 [INFO] --- Processing Layer 11 ---
2025-09-09 09:50:02,361 [INFO] Layer 11 - Training completed.
2025-09-09 09:50:02,362 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_11/state_dict.pt
2025-09-09 09:50:02,376 [INFO] Layer 11 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:02,376 [INFO] --- Processing Layer 12 ---
2025-09-09 09:50:02,647 [INFO] Layer 12 - Training completed.
2025-09-09 09:50:02,648 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_12/state_dict.pt
2025-09-09 09:50:02,662 [INFO] Layer 12 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:02,662 [INFO] --- Processing Layer 13 ---
2025-09-09 09:50:02,930 [INFO] Layer 13 - Training completed.
2025-09-09 09:50:02,931 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_13/state_dict.pt
2025-09-09 09:50:02,945 [INFO] Layer 13 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:50:02,945 [INFO] --- Processing Layer 14 ---
2025-09-09 09:50:03,228 [INFO] Layer 14 - Training completed.
2025-09-09 09:50:03,229 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_14/state_dict.pt
2025-09-09 09:50:03,243 [INFO] Layer 14 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:03,243 [INFO] --- Processing Layer 15 ---
2025-09-09 09:50:03,514 [INFO] Layer 15 - Training completed.
2025-09-09 09:50:03,515 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_15/state_dict.pt
2025-09-09 09:50:03,530 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:03,530 [INFO] --- Processing Layer 16 ---
2025-09-09 09:50:03,802 [INFO] Layer 16 - Training completed.
2025-09-09 09:50:03,803 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_16/state_dict.pt
2025-09-09 09:50:03,817 [INFO] Layer 16 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:50:03,818 [INFO] --- Processing Layer 17 ---
2025-09-09 09:50:04,089 [INFO] Layer 17 - Training completed.
2025-09-09 09:50:04,090 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_17/state_dict.pt
2025-09-09 09:50:04,104 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:04,104 [INFO] --- Processing Layer 18 ---
2025-09-09 09:50:04,370 [INFO] Layer 18 - Training completed.
2025-09-09 09:50:04,371 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_18/state_dict.pt
2025-09-09 09:50:04,385 [INFO] Layer 18 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:50:04,385 [INFO] --- Processing Layer 19 ---
2025-09-09 09:50:04,655 [INFO] Layer 19 - Training completed.
2025-09-09 09:50:04,657 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_19/state_dict.pt
2025-09-09 09:50:04,670 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:04,670 [INFO] --- Processing Layer 20 ---
2025-09-09 09:50:04,941 [INFO] Layer 20 - Training completed.
2025-09-09 09:50:04,942 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_20/state_dict.pt
2025-09-09 09:50:04,957 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:04,957 [INFO] --- Processing Layer 21 ---
2025-09-09 09:50:05,235 [INFO] Layer 21 - Training completed.
2025-09-09 09:50:05,236 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_21/state_dict.pt
2025-09-09 09:50:05,249 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:05,249 [INFO] --- Processing Layer 22 ---
2025-09-09 09:50:05,522 [INFO] Layer 22 - Training completed.
2025-09-09 09:50:05,523 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_22/state_dict.pt
2025-09-09 09:50:05,536 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:05,536 [INFO] --- Processing Layer 23 ---
2025-09-09 09:50:05,809 [INFO] Layer 23 - Training completed.
2025-09-09 09:50:05,811 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_23/state_dict.pt
2025-09-09 09:50:05,825 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:05,825 [INFO] --- Processing Layer 24 ---
2025-09-09 09:50:06,114 [INFO] Layer 24 - Training completed.
2025-09-09 09:50:06,115 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_24/state_dict.pt
2025-09-09 09:50:06,129 [INFO] Layer 24 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:06,129 [INFO] --- Processing Layer 25 ---
2025-09-09 09:50:06,402 [INFO] Layer 25 - Training completed.
2025-09-09 09:50:06,403 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_25/state_dict.pt
2025-09-09 09:50:06,417 [INFO] Layer 25 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:06,417 [INFO] --- Processing Layer 26 ---
2025-09-09 09:50:06,694 [INFO] Layer 26 - Training completed.
2025-09-09 09:50:06,695 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_26/state_dict.pt
2025-09-09 09:50:06,709 [INFO] Layer 26 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:50:06,709 [INFO] --- Processing Layer 27 ---
2025-09-09 09:50:06,987 [INFO] Layer 27 - Training completed.
2025-09-09 09:50:06,988 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_27/state_dict.pt
2025-09-09 09:50:07,003 [INFO] Layer 27 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:50:07,003 [INFO] --- Processing Layer 28 ---
2025-09-09 09:50:07,277 [INFO] Layer 28 - Training completed.
2025-09-09 09:50:07,278 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_45/layer_28/state_dict.pt
2025-09-09 09:50:07,292 [INFO] Layer 28 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:50:07,292 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:50:07,293 [INFO] --- Generating OOD Datasets for Run 4 ---
2025-09-09 09:50:07,299 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:50:07,301 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:50:07,338 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:50:11,342 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:50:11,345 [INFO] [OOD 1d] Layer 1: acc=0.3233
2025-09-09 09:50:11,347 [INFO] [OOD 1d] Layer 2: acc=0.4067
2025-09-09 09:50:11,348 [INFO] [OOD 1d] Layer 3: acc=0.4900
2025-09-09 09:50:11,350 [INFO] [OOD 1d] Layer 4: acc=0.4133
2025-09-09 09:50:11,351 [INFO] [OOD 1d] Layer 5: acc=0.9033
2025-09-09 09:50:11,353 [INFO] [OOD 1d] Layer 6: acc=0.7133
2025-09-09 09:50:11,354 [INFO] [OOD 1d] Layer 7: acc=0.6600
2025-09-09 09:50:11,356 [INFO] [OOD 1d] Layer 8: acc=0.9167
2025-09-09 09:50:11,358 [INFO] [OOD 1d] Layer 9: acc=0.9233
2025-09-09 09:50:11,359 [INFO] [OOD 1d] Layer 10: acc=0.9067
2025-09-09 09:50:11,361 [INFO] [OOD 1d] Layer 11: acc=0.9633
2025-09-09 09:50:11,362 [INFO] [OOD 1d] Layer 12: acc=0.9700
2025-09-09 09:50:11,364 [INFO] [OOD 1d] Layer 13: acc=0.9700
2025-09-09 09:50:11,365 [INFO] [OOD 1d] Layer 14: acc=0.9800
2025-09-09 09:50:11,367 [INFO] [OOD 1d] Layer 15: acc=0.9800
2025-09-09 09:50:11,368 [INFO] [OOD 1d] Layer 16: acc=0.9733
2025-09-09 09:50:11,370 [INFO] [OOD 1d] Layer 17: acc=0.9233
2025-09-09 09:50:11,371 [INFO] [OOD 1d] Layer 18: acc=0.8767
2025-09-09 09:50:11,373 [INFO] [OOD 1d] Layer 19: acc=0.9633
2025-09-09 09:50:11,374 [INFO] [OOD 1d] Layer 20: acc=1.0000
2025-09-09 09:50:11,376 [INFO] [OOD 1d] Layer 21: acc=1.0000
2025-09-09 09:50:11,378 [INFO] [OOD 1d] Layer 22: acc=1.0000
2025-09-09 09:50:11,379 [INFO] [OOD 1d] Layer 23: acc=1.0000
2025-09-09 09:50:11,381 [INFO] [OOD 1d] Layer 24: acc=1.0000
2025-09-09 09:50:11,382 [INFO] [OOD 1d] Layer 25: acc=1.0000
2025-09-09 09:50:11,384 [INFO] [OOD 1d] Layer 26: acc=1.0000
2025-09-09 09:50:11,385 [INFO] [OOD 1d] Layer 27: acc=1.0000
2025-09-09 09:50:11,387 [INFO] [OOD 1d] Layer 28: acc=0.9833
2025-09-09 09:50:11,387 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:50:14,638 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:50:14,641 [INFO] [OOD 2d] Layer 1: acc=0.5050
2025-09-09 09:50:14,642 [INFO] [OOD 2d] Layer 2: acc=0.6950
2025-09-09 09:50:14,643 [INFO] [OOD 2d] Layer 3: acc=0.9200
2025-09-09 09:50:14,644 [INFO] [OOD 2d] Layer 4: acc=0.9050
2025-09-09 09:50:14,646 [INFO] [OOD 2d] Layer 5: acc=0.9800
2025-09-09 09:50:14,647 [INFO] [OOD 2d] Layer 6: acc=0.9800
2025-09-09 09:50:14,648 [INFO] [OOD 2d] Layer 7: acc=0.9850
2025-09-09 09:50:14,649 [INFO] [OOD 2d] Layer 8: acc=0.9600
2025-09-09 09:50:14,650 [INFO] [OOD 2d] Layer 9: acc=1.0000
2025-09-09 09:50:14,651 [INFO] [OOD 2d] Layer 10: acc=1.0000
2025-09-09 09:50:14,653 [INFO] [OOD 2d] Layer 11: acc=1.0000
2025-09-09 09:50:14,654 [INFO] [OOD 2d] Layer 12: acc=1.0000
2025-09-09 09:50:14,655 [INFO] [OOD 2d] Layer 13: acc=1.0000
2025-09-09 09:50:14,656 [INFO] [OOD 2d] Layer 14: acc=0.9950
2025-09-09 09:50:14,657 [INFO] [OOD 2d] Layer 15: acc=1.0000
2025-09-09 09:50:14,658 [INFO] [OOD 2d] Layer 16: acc=0.9950
2025-09-09 09:50:14,659 [INFO] [OOD 2d] Layer 17: acc=1.0000
2025-09-09 09:50:14,661 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:50:14,662 [INFO] [OOD 2d] Layer 19: acc=1.0000
2025-09-09 09:50:14,663 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:50:14,664 [INFO] [OOD 2d] Layer 21: acc=1.0000
2025-09-09 09:50:14,665 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:50:14,666 [INFO] [OOD 2d] Layer 23: acc=1.0000
2025-09-09 09:50:14,667 [INFO] [OOD 2d] Layer 24: acc=1.0000
2025-09-09 09:50:14,669 [INFO] [OOD 2d] Layer 25: acc=1.0000
2025-09-09 09:50:14,670 [INFO] [OOD 2d] Layer 26: acc=0.9950
2025-09-09 09:50:14,671 [INFO] [OOD 2d] Layer 27: acc=1.0000
2025-09-09 09:50:14,672 [INFO] [OOD 2d] Layer 28: acc=0.9950
2025-09-09 09:50:14,673 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:50:20,496 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:50:20,499 [INFO] [OOD 3d] Layer 1: acc=0.3800
2025-09-09 09:50:20,500 [INFO] [OOD 3d] Layer 2: acc=0.4067
2025-09-09 09:50:20,502 [INFO] [OOD 3d] Layer 3: acc=0.5100
2025-09-09 09:50:20,503 [INFO] [OOD 3d] Layer 4: acc=0.8033
2025-09-09 09:50:20,505 [INFO] [OOD 3d] Layer 5: acc=0.7533
2025-09-09 09:50:20,507 [INFO] [OOD 3d] Layer 6: acc=0.7633
2025-09-09 09:50:20,508 [INFO] [OOD 3d] Layer 7: acc=0.9233
2025-09-09 09:50:20,510 [INFO] [OOD 3d] Layer 8: acc=0.7567
2025-09-09 09:50:20,511 [INFO] [OOD 3d] Layer 9: acc=0.9167
2025-09-09 09:50:20,513 [INFO] [OOD 3d] Layer 10: acc=0.9733
2025-09-09 09:50:20,514 [INFO] [OOD 3d] Layer 11: acc=0.9667
2025-09-09 09:50:20,516 [INFO] [OOD 3d] Layer 12: acc=0.9733
2025-09-09 09:50:20,517 [INFO] [OOD 3d] Layer 13: acc=0.8767
2025-09-09 09:50:20,519 [INFO] [OOD 3d] Layer 14: acc=0.9467
2025-09-09 09:50:20,520 [INFO] [OOD 3d] Layer 15: acc=0.9167
2025-09-09 09:50:20,522 [INFO] [OOD 3d] Layer 16: acc=0.8633
2025-09-09 09:50:20,523 [INFO] [OOD 3d] Layer 17: acc=0.8600
2025-09-09 09:50:20,525 [INFO] [OOD 3d] Layer 18: acc=0.8367
2025-09-09 09:50:20,526 [INFO] [OOD 3d] Layer 19: acc=0.9767
2025-09-09 09:50:20,528 [INFO] [OOD 3d] Layer 20: acc=0.9700
2025-09-09 09:50:20,530 [INFO] [OOD 3d] Layer 21: acc=0.9733
2025-09-09 09:50:20,531 [INFO] [OOD 3d] Layer 22: acc=0.9700
2025-09-09 09:50:20,533 [INFO] [OOD 3d] Layer 23: acc=0.9700
2025-09-09 09:50:20,534 [INFO] [OOD 3d] Layer 24: acc=0.9800
2025-09-09 09:50:20,536 [INFO] [OOD 3d] Layer 25: acc=0.9667
2025-09-09 09:50:20,537 [INFO] [OOD 3d] Layer 26: acc=0.9667
2025-09-09 09:50:20,539 [INFO] [OOD 3d] Layer 27: acc=0.9700
2025-09-09 09:50:20,540 [INFO] [OOD 3d] Layer 28: acc=0.9733
2025-09-09 09:50:20,541 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:50:26,963 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:50:26,966 [INFO] [OOD 4d] Layer 1: acc=0.3800
2025-09-09 09:50:26,968 [INFO] [OOD 4d] Layer 2: acc=0.4500
2025-09-09 09:50:26,969 [INFO] [OOD 4d] Layer 3: acc=0.4533
2025-09-09 09:50:26,971 [INFO] [OOD 4d] Layer 4: acc=0.7233
2025-09-09 09:50:26,972 [INFO] [OOD 4d] Layer 5: acc=0.7633
2025-09-09 09:50:26,974 [INFO] [OOD 4d] Layer 6: acc=0.8400
2025-09-09 09:50:26,975 [INFO] [OOD 4d] Layer 7: acc=0.6933
2025-09-09 09:50:26,977 [INFO] [OOD 4d] Layer 8: acc=0.6667
2025-09-09 09:50:26,978 [INFO] [OOD 4d] Layer 9: acc=0.6867
2025-09-09 09:50:26,980 [INFO] [OOD 4d] Layer 10: acc=0.7300
2025-09-09 09:50:26,981 [INFO] [OOD 4d] Layer 11: acc=0.6767
2025-09-09 09:50:26,983 [INFO] [OOD 4d] Layer 12: acc=0.8000
2025-09-09 09:50:26,985 [INFO] [OOD 4d] Layer 13: acc=0.6667
2025-09-09 09:50:26,986 [INFO] [OOD 4d] Layer 14: acc=0.6667
2025-09-09 09:50:26,987 [INFO] [OOD 4d] Layer 15: acc=0.6767
2025-09-09 09:50:26,989 [INFO] [OOD 4d] Layer 16: acc=0.6667
2025-09-09 09:50:26,990 [INFO] [OOD 4d] Layer 17: acc=0.6667
2025-09-09 09:50:26,992 [INFO] [OOD 4d] Layer 18: acc=0.6667
2025-09-09 09:50:26,993 [INFO] [OOD 4d] Layer 19: acc=0.9900
2025-09-09 09:50:26,995 [INFO] [OOD 4d] Layer 20: acc=0.9867
2025-09-09 09:50:26,997 [INFO] [OOD 4d] Layer 21: acc=0.9867
2025-09-09 09:50:26,998 [INFO] [OOD 4d] Layer 22: acc=0.9867
2025-09-09 09:50:26,999 [INFO] [OOD 4d] Layer 23: acc=0.9900
2025-09-09 09:50:27,001 [INFO] [OOD 4d] Layer 24: acc=0.9867
2025-09-09 09:50:27,003 [INFO] [OOD 4d] Layer 25: acc=0.9900
2025-09-09 09:50:27,004 [INFO] [OOD 4d] Layer 26: acc=0.9767
2025-09-09 09:50:27,006 [INFO] [OOD 4d] Layer 27: acc=0.9800
2025-09-09 09:50:27,007 [INFO] [OOD 4d] Layer 28: acc=0.9800
2025-09-09 09:50:27,007 [INFO] ==================== RUN 5/5 (Seed: 46) ====================
2025-09-09 09:50:27,009 [INFO] Using device: cuda:0
2025-09-09 09:50:27,013 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:50:27,013 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:50:27,015 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:50:27,015 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:50:27,017 [INFO] [TRAIN_COMM_3WAY_Run5] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:50:50,774 [INFO] [TRAIN_COMM_3WAY_Run5] Finished extracting activations.
2025-09-09 09:50:50,818 [INFO] Per-layer classification reports -> ./outputs/Qwen2.5-Math-7B/run_seed_46/probe_3way_comm_Qwen2.5-Math-7B_seed_46_20250909_095050.txt
2025-09-09 09:50:50,818 [INFO] --- Starting Probe Training Loop for layers 1..28 ---
2025-09-09 09:50:50,818 [INFO] --- Processing Layer 1 ---
2025-09-09 09:50:51,127 [INFO] Layer 1 - Training completed.
2025-09-09 09:50:51,129 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_1/state_dict.pt
2025-09-09 09:50:51,143 [INFO] Layer 1 - Test Acc: 0.4000 | F1(C0,C1,C2): 0.497, 0.164, 0.369
2025-09-09 09:50:51,143 [INFO] --- Processing Layer 2 ---
2025-09-09 09:50:51,418 [INFO] Layer 2 - Training completed.
2025-09-09 09:50:51,419 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_2/state_dict.pt
2025-09-09 09:50:51,433 [INFO] Layer 2 - Test Acc: 0.6267 | F1(C0,C1,C2): 0.636, 0.686, 0.528
2025-09-09 09:50:51,433 [INFO] --- Processing Layer 3 ---
2025-09-09 09:50:51,696 [INFO] Layer 3 - Training completed.
2025-09-09 09:50:51,697 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_3/state_dict.pt
2025-09-09 09:50:51,710 [INFO] Layer 3 - Test Acc: 0.5800 | F1(C0,C1,C2): 0.319, 0.722, 0.603
2025-09-09 09:50:51,711 [INFO] --- Processing Layer 4 ---
2025-09-09 09:50:51,975 [INFO] Layer 4 - Training completed.
2025-09-09 09:50:51,977 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_4/state_dict.pt
2025-09-09 09:50:51,990 [INFO] Layer 4 - Test Acc: 0.9400 | F1(C0,C1,C2): 0.903, 0.938, 0.976
2025-09-09 09:50:51,991 [INFO] --- Processing Layer 5 ---
2025-09-09 09:50:52,257 [INFO] Layer 5 - Training completed.
2025-09-09 09:50:52,258 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_5/state_dict.pt
2025-09-09 09:50:52,273 [INFO] Layer 5 - Test Acc: 0.9667 | F1(C0,C1,C2): 0.951, 0.953, 0.995
2025-09-09 09:50:52,273 [INFO] --- Processing Layer 6 ---
2025-09-09 09:50:52,538 [INFO] Layer 6 - Training completed.
2025-09-09 09:50:52,539 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_6/state_dict.pt
2025-09-09 09:50:52,553 [INFO] Layer 6 - Test Acc: 0.9500 | F1(C0,C1,C2): 0.919, 0.935, 0.995
2025-09-09 09:50:52,553 [INFO] --- Processing Layer 7 ---
2025-09-09 09:50:52,818 [INFO] Layer 7 - Training completed.
2025-09-09 09:50:52,819 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_7/state_dict.pt
2025-09-09 09:50:52,833 [INFO] Layer 7 - Test Acc: 0.9467 | F1(C0,C1,C2): 0.913, 0.930, 0.995
2025-09-09 09:50:52,833 [INFO] --- Processing Layer 8 ---
2025-09-09 09:50:53,096 [INFO] Layer 8 - Training completed.
2025-09-09 09:50:53,097 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_8/state_dict.pt
2025-09-09 09:50:53,111 [INFO] Layer 8 - Test Acc: 0.9267 | F1(C0,C1,C2): 0.876, 0.901, 1.000
2025-09-09 09:50:53,111 [INFO] --- Processing Layer 9 ---
2025-09-09 09:50:53,379 [INFO] Layer 9 - Training completed.
2025-09-09 09:50:53,381 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_9/state_dict.pt
2025-09-09 09:50:53,394 [INFO] Layer 9 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.985, 0.995
2025-09-09 09:50:53,395 [INFO] --- Processing Layer 10 ---
2025-09-09 09:50:53,666 [INFO] Layer 10 - Training completed.
2025-09-09 09:50:53,667 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_10/state_dict.pt
2025-09-09 09:50:53,681 [INFO] Layer 10 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:53,681 [INFO] --- Processing Layer 11 ---
2025-09-09 09:50:53,959 [INFO] Layer 11 - Training completed.
2025-09-09 09:50:53,961 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_11/state_dict.pt
2025-09-09 09:50:53,974 [INFO] Layer 11 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:53,974 [INFO] --- Processing Layer 12 ---
2025-09-09 09:50:54,247 [INFO] Layer 12 - Training completed.
2025-09-09 09:50:54,249 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_12/state_dict.pt
2025-09-09 09:50:54,262 [INFO] Layer 12 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 1.000, 0.995
2025-09-09 09:50:54,263 [INFO] --- Processing Layer 13 ---
2025-09-09 09:50:54,538 [INFO] Layer 13 - Training completed.
2025-09-09 09:50:54,539 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_13/state_dict.pt
2025-09-09 09:50:54,554 [INFO] Layer 13 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 1.000, 0.995
2025-09-09 09:50:54,554 [INFO] --- Processing Layer 14 ---
2025-09-09 09:50:54,832 [INFO] Layer 14 - Training completed.
2025-09-09 09:50:54,833 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_14/state_dict.pt
2025-09-09 09:50:54,847 [INFO] Layer 14 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:54,847 [INFO] --- Processing Layer 15 ---
2025-09-09 09:50:55,119 [INFO] Layer 15 - Training completed.
2025-09-09 09:50:55,121 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_15/state_dict.pt
2025-09-09 09:50:55,135 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:55,135 [INFO] --- Processing Layer 16 ---
2025-09-09 09:50:55,404 [INFO] Layer 16 - Training completed.
2025-09-09 09:50:55,405 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_16/state_dict.pt
2025-09-09 09:50:55,420 [INFO] Layer 16 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:50:55,421 [INFO] --- Processing Layer 17 ---
2025-09-09 09:50:55,722 [INFO] Layer 17 - Training completed.
2025-09-09 09:50:55,723 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_17/state_dict.pt
2025-09-09 09:50:55,737 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:55,738 [INFO] --- Processing Layer 18 ---
2025-09-09 09:50:56,005 [INFO] Layer 18 - Training completed.
2025-09-09 09:50:56,006 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_18/state_dict.pt
2025-09-09 09:50:56,020 [INFO] Layer 18 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:50:56,021 [INFO] --- Processing Layer 19 ---
2025-09-09 09:50:56,290 [INFO] Layer 19 - Training completed.
2025-09-09 09:50:56,291 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_19/state_dict.pt
2025-09-09 09:50:56,305 [INFO] Layer 19 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:50:56,305 [INFO] --- Processing Layer 20 ---
2025-09-09 09:50:56,570 [INFO] Layer 20 - Training completed.
2025-09-09 09:50:56,572 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_20/state_dict.pt
2025-09-09 09:50:56,585 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:56,586 [INFO] --- Processing Layer 21 ---
2025-09-09 09:50:56,854 [INFO] Layer 21 - Training completed.
2025-09-09 09:50:56,855 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_21/state_dict.pt
2025-09-09 09:50:56,869 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:56,869 [INFO] --- Processing Layer 22 ---
2025-09-09 09:50:57,135 [INFO] Layer 22 - Training completed.
2025-09-09 09:50:57,136 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_22/state_dict.pt
2025-09-09 09:50:57,150 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:57,150 [INFO] --- Processing Layer 23 ---
2025-09-09 09:50:57,412 [INFO] Layer 23 - Training completed.
2025-09-09 09:50:57,413 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_23/state_dict.pt
2025-09-09 09:50:57,427 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:57,427 [INFO] --- Processing Layer 24 ---
2025-09-09 09:50:57,691 [INFO] Layer 24 - Training completed.
2025-09-09 09:50:57,692 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_24/state_dict.pt
2025-09-09 09:50:57,705 [INFO] Layer 24 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:50:57,706 [INFO] --- Processing Layer 25 ---
2025-09-09 09:50:57,971 [INFO] Layer 25 - Training completed.
2025-09-09 09:50:57,972 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_25/state_dict.pt
2025-09-09 09:50:57,986 [INFO] Layer 25 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:50:57,986 [INFO] --- Processing Layer 26 ---
2025-09-09 09:50:58,251 [INFO] Layer 26 - Training completed.
2025-09-09 09:50:58,253 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_26/state_dict.pt
2025-09-09 09:50:58,266 [INFO] Layer 26 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:50:58,267 [INFO] --- Processing Layer 27 ---
2025-09-09 09:50:58,530 [INFO] Layer 27 - Training completed.
2025-09-09 09:50:58,531 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_27/state_dict.pt
2025-09-09 09:50:58,545 [INFO] Layer 27 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:50:58,546 [INFO] --- Processing Layer 28 ---
2025-09-09 09:50:58,812 [INFO] Layer 28 - Training completed.
2025-09-09 09:50:58,813 [INFO] Saved probe state_dict -> ./outputs/Qwen2.5-Math-7B/run_seed_46/layer_28/state_dict.pt
2025-09-09 09:50:58,827 [INFO] Layer 28 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:50:58,827 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:50:58,827 [INFO] --- Generating OOD Datasets for Run 5 ---
2025-09-09 09:50:58,833 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:50:58,835 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:50:58,870 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:51:02,874 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:51:02,877 [INFO] [OOD 1d] Layer 1: acc=0.3300
2025-09-09 09:51:02,878 [INFO] [OOD 1d] Layer 2: acc=0.5200
2025-09-09 09:51:02,880 [INFO] [OOD 1d] Layer 3: acc=0.3500
2025-09-09 09:51:02,881 [INFO] [OOD 1d] Layer 4: acc=0.4000
2025-09-09 09:51:02,883 [INFO] [OOD 1d] Layer 5: acc=0.9200
2025-09-09 09:51:02,884 [INFO] [OOD 1d] Layer 6: acc=0.7400
2025-09-09 09:51:02,886 [INFO] [OOD 1d] Layer 7: acc=0.7067
2025-09-09 09:51:02,887 [INFO] [OOD 1d] Layer 8: acc=0.9300
2025-09-09 09:51:02,889 [INFO] [OOD 1d] Layer 9: acc=0.9200
2025-09-09 09:51:02,890 [INFO] [OOD 1d] Layer 10: acc=0.9400
2025-09-09 09:51:02,892 [INFO] [OOD 1d] Layer 11: acc=0.9867
2025-09-09 09:51:02,893 [INFO] [OOD 1d] Layer 12: acc=0.9867
2025-09-09 09:51:02,895 [INFO] [OOD 1d] Layer 13: acc=0.9633
2025-09-09 09:51:02,896 [INFO] [OOD 1d] Layer 14: acc=0.9767
2025-09-09 09:51:02,898 [INFO] [OOD 1d] Layer 15: acc=0.9633
2025-09-09 09:51:02,899 [INFO] [OOD 1d] Layer 16: acc=0.9100
2025-09-09 09:51:02,901 [INFO] [OOD 1d] Layer 17: acc=0.9500
2025-09-09 09:51:02,902 [INFO] [OOD 1d] Layer 18: acc=0.8867
2025-09-09 09:51:02,904 [INFO] [OOD 1d] Layer 19: acc=0.9767
2025-09-09 09:51:02,905 [INFO] [OOD 1d] Layer 20: acc=1.0000
2025-09-09 09:51:02,907 [INFO] [OOD 1d] Layer 21: acc=1.0000
2025-09-09 09:51:02,908 [INFO] [OOD 1d] Layer 22: acc=0.9967
2025-09-09 09:51:02,910 [INFO] [OOD 1d] Layer 23: acc=1.0000
2025-09-09 09:51:02,911 [INFO] [OOD 1d] Layer 24: acc=1.0000
2025-09-09 09:51:02,913 [INFO] [OOD 1d] Layer 25: acc=1.0000
2025-09-09 09:51:02,914 [INFO] [OOD 1d] Layer 26: acc=0.9967
2025-09-09 09:51:02,916 [INFO] [OOD 1d] Layer 27: acc=0.9633
2025-09-09 09:51:02,917 [INFO] [OOD 1d] Layer 28: acc=1.0000
2025-09-09 09:51:02,918 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:51:06,157 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:51:06,159 [INFO] [OOD 2d] Layer 1: acc=0.4200
2025-09-09 09:51:06,161 [INFO] [OOD 2d] Layer 2: acc=0.7200
2025-09-09 09:51:06,162 [INFO] [OOD 2d] Layer 3: acc=0.3650
2025-09-09 09:51:06,163 [INFO] [OOD 2d] Layer 4: acc=0.9000
2025-09-09 09:51:06,164 [INFO] [OOD 2d] Layer 5: acc=0.9650
2025-09-09 09:51:06,165 [INFO] [OOD 2d] Layer 6: acc=0.9400
2025-09-09 09:51:06,167 [INFO] [OOD 2d] Layer 7: acc=0.9400
2025-09-09 09:51:06,168 [INFO] [OOD 2d] Layer 8: acc=0.9200
2025-09-09 09:51:06,169 [INFO] [OOD 2d] Layer 9: acc=0.9850
2025-09-09 09:51:06,170 [INFO] [OOD 2d] Layer 10: acc=1.0000
2025-09-09 09:51:06,171 [INFO] [OOD 2d] Layer 11: acc=1.0000
2025-09-09 09:51:06,173 [INFO] [OOD 2d] Layer 12: acc=1.0000
2025-09-09 09:51:06,174 [INFO] [OOD 2d] Layer 13: acc=1.0000
2025-09-09 09:51:06,175 [INFO] [OOD 2d] Layer 14: acc=1.0000
2025-09-09 09:51:06,176 [INFO] [OOD 2d] Layer 15: acc=1.0000
2025-09-09 09:51:06,177 [INFO] [OOD 2d] Layer 16: acc=0.9950
2025-09-09 09:51:06,178 [INFO] [OOD 2d] Layer 17: acc=1.0000
2025-09-09 09:51:06,179 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:51:06,181 [INFO] [OOD 2d] Layer 19: acc=1.0000
2025-09-09 09:51:06,182 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:51:06,183 [INFO] [OOD 2d] Layer 21: acc=1.0000
2025-09-09 09:51:06,184 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:51:06,185 [INFO] [OOD 2d] Layer 23: acc=1.0000
2025-09-09 09:51:06,186 [INFO] [OOD 2d] Layer 24: acc=1.0000
2025-09-09 09:51:06,188 [INFO] [OOD 2d] Layer 25: acc=1.0000
2025-09-09 09:51:06,189 [INFO] [OOD 2d] Layer 26: acc=0.9800
2025-09-09 09:51:06,190 [INFO] [OOD 2d] Layer 27: acc=0.9950
2025-09-09 09:51:06,191 [INFO] [OOD 2d] Layer 28: acc=0.9900
2025-09-09 09:51:06,191 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:51:12,006 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:51:12,009 [INFO] [OOD 3d] Layer 1: acc=0.3633
2025-09-09 09:51:12,010 [INFO] [OOD 3d] Layer 2: acc=0.4200
2025-09-09 09:51:12,012 [INFO] [OOD 3d] Layer 3: acc=0.4500
2025-09-09 09:51:12,014 [INFO] [OOD 3d] Layer 4: acc=0.8067
2025-09-09 09:51:12,015 [INFO] [OOD 3d] Layer 5: acc=0.7233
2025-09-09 09:51:12,017 [INFO] [OOD 3d] Layer 6: acc=0.8400
2025-09-09 09:51:12,018 [INFO] [OOD 3d] Layer 7: acc=0.8967
2025-09-09 09:51:12,020 [INFO] [OOD 3d] Layer 8: acc=0.7633
2025-09-09 09:51:12,021 [INFO] [OOD 3d] Layer 9: acc=0.8500
2025-09-09 09:51:12,023 [INFO] [OOD 3d] Layer 10: acc=0.9700
2025-09-09 09:51:12,024 [INFO] [OOD 3d] Layer 11: acc=0.9633
2025-09-09 09:51:12,026 [INFO] [OOD 3d] Layer 12: acc=0.9633
2025-09-09 09:51:12,027 [INFO] [OOD 3d] Layer 13: acc=0.9700
2025-09-09 09:51:12,029 [INFO] [OOD 3d] Layer 14: acc=0.9733
2025-09-09 09:51:12,031 [INFO] [OOD 3d] Layer 15: acc=0.9567
2025-09-09 09:51:12,032 [INFO] [OOD 3d] Layer 16: acc=0.9400
2025-09-09 09:51:12,034 [INFO] [OOD 3d] Layer 17: acc=0.8733
2025-09-09 09:51:12,035 [INFO] [OOD 3d] Layer 18: acc=0.9600
2025-09-09 09:51:12,037 [INFO] [OOD 3d] Layer 19: acc=0.9367
2025-09-09 09:51:12,038 [INFO] [OOD 3d] Layer 20: acc=0.9667
2025-09-09 09:51:12,040 [INFO] [OOD 3d] Layer 21: acc=0.9800
2025-09-09 09:51:12,041 [INFO] [OOD 3d] Layer 22: acc=0.9733
2025-09-09 09:51:12,043 [INFO] [OOD 3d] Layer 23: acc=0.9900
2025-09-09 09:51:12,044 [INFO] [OOD 3d] Layer 24: acc=0.9733
2025-09-09 09:51:12,046 [INFO] [OOD 3d] Layer 25: acc=0.9800
2025-09-09 09:51:12,047 [INFO] [OOD 3d] Layer 26: acc=0.9933
2025-09-09 09:51:12,049 [INFO] [OOD 3d] Layer 27: acc=0.9833
2025-09-09 09:51:12,050 [INFO] [OOD 3d] Layer 28: acc=0.9767
2025-09-09 09:51:12,051 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:51:18,486 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:51:18,489 [INFO] [OOD 4d] Layer 1: acc=0.3467
2025-09-09 09:51:18,490 [INFO] [OOD 4d] Layer 2: acc=0.3600
2025-09-09 09:51:18,492 [INFO] [OOD 4d] Layer 3: acc=0.4367
2025-09-09 09:51:18,493 [INFO] [OOD 4d] Layer 4: acc=0.7200
2025-09-09 09:51:18,495 [INFO] [OOD 4d] Layer 5: acc=0.6933
2025-09-09 09:51:18,496 [INFO] [OOD 4d] Layer 6: acc=0.8467
2025-09-09 09:51:18,498 [INFO] [OOD 4d] Layer 7: acc=0.6767
2025-09-09 09:51:18,499 [INFO] [OOD 4d] Layer 8: acc=0.6267
2025-09-09 09:51:18,501 [INFO] [OOD 4d] Layer 9: acc=0.6433
2025-09-09 09:51:18,502 [INFO] [OOD 4d] Layer 10: acc=0.7067
2025-09-09 09:51:18,504 [INFO] [OOD 4d] Layer 11: acc=0.7600
2025-09-09 09:51:18,505 [INFO] [OOD 4d] Layer 12: acc=0.8300
2025-09-09 09:51:18,507 [INFO] [OOD 4d] Layer 13: acc=0.6733
2025-09-09 09:51:18,509 [INFO] [OOD 4d] Layer 14: acc=0.6833
2025-09-09 09:51:18,510 [INFO] [OOD 4d] Layer 15: acc=0.6667
2025-09-09 09:51:18,511 [INFO] [OOD 4d] Layer 16: acc=0.6733
2025-09-09 09:51:18,513 [INFO] [OOD 4d] Layer 17: acc=0.6667
2025-09-09 09:51:18,514 [INFO] [OOD 4d] Layer 18: acc=0.6733
2025-09-09 09:51:18,516 [INFO] [OOD 4d] Layer 19: acc=0.9600
2025-09-09 09:51:18,517 [INFO] [OOD 4d] Layer 20: acc=0.9800
2025-09-09 09:51:18,519 [INFO] [OOD 4d] Layer 21: acc=0.9800
2025-09-09 09:51:18,520 [INFO] [OOD 4d] Layer 22: acc=0.9867
2025-09-09 09:51:18,522 [INFO] [OOD 4d] Layer 23: acc=0.9833
2025-09-09 09:51:18,523 [INFO] [OOD 4d] Layer 24: acc=0.9800
2025-09-09 09:51:18,525 [INFO] [OOD 4d] Layer 25: acc=0.9800
2025-09-09 09:51:18,526 [INFO] [OOD 4d] Layer 26: acc=0.9800
2025-09-09 09:51:18,528 [INFO] [OOD 4d] Layer 27: acc=0.9767
2025-09-09 09:51:18,529 [INFO] [OOD 4d] Layer 28: acc=0.9667
2025-09-09 09:51:18,530 [INFO] --- Generating Final Aggregated Plots (with CI) ---
2025-09-09 09:51:19,279 [INFO] Saved aggregated per-layer line chart (PDF) -> ./outputs/Qwen2.5-Math-7B/AGG_probe_comm_generalisation_line_Qwen2.5-Math-7B_20250909_095118.pdf
2025-09-09 09:51:19,509 [INFO] Saved aggregated mean-accuracy bar chart (PDF) -> ./outputs/Qwen2.5-Math-7B/AGG_probe_comm_generalisation_bar_Qwen2.5-Math-7B_20250909_095118.pdf
2025-09-09 09:51:19,509 [INFO] --- All Runs and Aggregated Plotting Finished (this model) ---
2025-09-09 09:51:19,510 [INFO] Unified output dir (this model): ./outputs/Qwen2.5-Math-7B
