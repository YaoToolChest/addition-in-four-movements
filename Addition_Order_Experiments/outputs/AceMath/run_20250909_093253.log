2025-09-09 09:32:53,890 [INFO] ======= Logger initialized =======
2025-09-09 09:32:53,890 [INFO] Log file: ./outputs/AceMath/run_20250909_093253.log
2025-09-09 09:32:53,891 [INFO] Using device: cuda:0
2025-09-09 09:32:53,891 [INFO] Loading model: /root/autodl-tmp/AceMath ...
2025-09-09 09:33:00,057 [INFO] Model and tokenizer loaded successfully.
2025-09-09 09:33:00,103 [INFO] [Auto] hidden_states length = 29; probing indices = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:33:00,104 [INFO] Final LAYERS_TO_PROBE for AceMath: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:33:00,104 [INFO] Determining probe input dimension...
2025-09-09 09:33:00,104 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:33:00,104 [INFO] Target: 10 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:33:00,104 [INFO] Generated final dataset with 30 samples.
2025-09-09 09:33:00,104 [INFO] Final label distribution: {0: 10, 1: 10, 2: 10}
2025-09-09 09:33:00,104 [INFO] [PLACEHOLDER] Extracting activations for 30 prompts, layers=[1]
2025-09-09 09:33:00,896 [INFO] [PLACEHOLDER] Finished extracting activations.
2025-09-09 09:33:00,897 [INFO] Determined fixed probe input dimension: 3584
2025-09-09 09:33:00,897 [INFO] ==================== RUN 1/5 (Seed: 42) ====================
2025-09-09 09:33:00,897 [INFO] Using device: cuda:0
2025-09-09 09:33:00,901 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:33:00,901 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:33:00,904 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:33:00,905 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:33:00,905 [INFO] [TRAIN_COMM_3WAY_Run1] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:33:24,602 [INFO] [TRAIN_COMM_3WAY_Run1] Finished extracting activations.
2025-09-09 09:33:24,605 [INFO] Per-layer classification reports -> ./outputs/AceMath/run_seed_42/probe_3way_comm_AceMath_seed_42_20250909_093324.txt
2025-09-09 09:33:24,605 [INFO] --- Starting Probe Training Loop for layers 1..28 ---
2025-09-09 09:33:24,605 [INFO] --- Processing Layer 1 ---
2025-09-09 09:33:24,874 [INFO] Layer 1 - Training completed.
2025-09-09 09:33:24,875 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_1/state_dict.pt
2025-09-09 09:33:24,889 [INFO] Layer 1 - Test Acc: 0.3900 | F1(C0,C1,C2): 0.378, 0.154, 0.476
2025-09-09 09:33:24,890 [INFO] --- Processing Layer 2 ---
2025-09-09 09:33:25,155 [INFO] Layer 2 - Training completed.
2025-09-09 09:33:25,156 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_2/state_dict.pt
2025-09-09 09:33:25,169 [INFO] Layer 2 - Test Acc: 0.6867 | F1(C0,C1,C2): 0.804, 0.700, 0.524
2025-09-09 09:33:25,170 [INFO] --- Processing Layer 3 ---
2025-09-09 09:33:25,431 [INFO] Layer 3 - Training completed.
2025-09-09 09:33:25,432 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_3/state_dict.pt
2025-09-09 09:33:25,446 [INFO] Layer 3 - Test Acc: 0.6700 | F1(C0,C1,C2): 0.827, 0.691, 0.403
2025-09-09 09:33:25,446 [INFO] --- Processing Layer 4 ---
2025-09-09 09:33:25,708 [INFO] Layer 4 - Training completed.
2025-09-09 09:33:25,709 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_4/state_dict.pt
2025-09-09 09:33:25,723 [INFO] Layer 4 - Test Acc: 0.9200 | F1(C0,C1,C2): 0.914, 0.884, 0.957
2025-09-09 09:33:25,723 [INFO] --- Processing Layer 5 ---
2025-09-09 09:33:25,986 [INFO] Layer 5 - Training completed.
2025-09-09 09:33:25,987 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_5/state_dict.pt
2025-09-09 09:33:26,001 [INFO] Layer 5 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.974, 0.976, 1.000
2025-09-09 09:33:26,001 [INFO] --- Processing Layer 6 ---
2025-09-09 09:33:26,281 [INFO] Layer 6 - Training completed.
2025-09-09 09:33:26,282 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_6/state_dict.pt
2025-09-09 09:33:26,295 [INFO] Layer 6 - Test Acc: 0.9767 | F1(C0,C1,C2): 0.964, 0.966, 1.000
2025-09-09 09:33:26,295 [INFO] --- Processing Layer 7 ---
2025-09-09 09:33:26,571 [INFO] Layer 7 - Training completed.
2025-09-09 09:33:26,572 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_7/state_dict.pt
2025-09-09 09:33:26,586 [INFO] Layer 7 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.976, 0.974, 1.000
2025-09-09 09:33:26,586 [INFO] --- Processing Layer 8 ---
2025-09-09 09:33:26,849 [INFO] Layer 8 - Training completed.
2025-09-09 09:33:26,850 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_8/state_dict.pt
2025-09-09 09:33:26,863 [INFO] Layer 8 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:33:26,863 [INFO] --- Processing Layer 9 ---
2025-09-09 09:33:27,127 [INFO] Layer 9 - Training completed.
2025-09-09 09:33:27,128 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_9/state_dict.pt
2025-09-09 09:33:27,142 [INFO] Layer 9 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.974, 0.976, 1.000
2025-09-09 09:33:27,142 [INFO] --- Processing Layer 10 ---
2025-09-09 09:33:27,402 [INFO] Layer 10 - Training completed.
2025-09-09 09:33:27,403 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_10/state_dict.pt
2025-09-09 09:33:27,418 [INFO] Layer 10 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:33:27,418 [INFO] --- Processing Layer 11 ---
2025-09-09 09:33:27,679 [INFO] Layer 11 - Training completed.
2025-09-09 09:33:27,681 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_11/state_dict.pt
2025-09-09 09:33:27,694 [INFO] Layer 11 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:33:27,694 [INFO] --- Processing Layer 12 ---
2025-09-09 09:33:27,955 [INFO] Layer 12 - Training completed.
2025-09-09 09:33:27,956 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_12/state_dict.pt
2025-09-09 09:33:27,970 [INFO] Layer 12 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:33:27,971 [INFO] --- Processing Layer 13 ---
2025-09-09 09:33:28,231 [INFO] Layer 13 - Training completed.
2025-09-09 09:33:28,233 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_13/state_dict.pt
2025-09-09 09:33:28,246 [INFO] Layer 13 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:33:28,246 [INFO] --- Processing Layer 14 ---
2025-09-09 09:33:28,541 [INFO] Layer 14 - Training completed.
2025-09-09 09:33:28,542 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_14/state_dict.pt
2025-09-09 09:33:28,556 [INFO] Layer 14 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:33:28,556 [INFO] --- Processing Layer 15 ---
2025-09-09 09:33:28,813 [INFO] Layer 15 - Training completed.
2025-09-09 09:33:28,814 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_15/state_dict.pt
2025-09-09 09:33:28,828 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:33:28,828 [INFO] --- Processing Layer 16 ---
2025-09-09 09:33:29,087 [INFO] Layer 16 - Training completed.
2025-09-09 09:33:29,088 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_16/state_dict.pt
2025-09-09 09:33:29,101 [INFO] Layer 16 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:33:29,101 [INFO] --- Processing Layer 17 ---
2025-09-09 09:33:29,361 [INFO] Layer 17 - Training completed.
2025-09-09 09:33:29,362 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_17/state_dict.pt
2025-09-09 09:33:29,376 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:33:29,376 [INFO] --- Processing Layer 18 ---
2025-09-09 09:33:29,644 [INFO] Layer 18 - Training completed.
2025-09-09 09:33:29,645 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_18/state_dict.pt
2025-09-09 09:33:29,659 [INFO] Layer 18 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:33:29,659 [INFO] --- Processing Layer 19 ---
2025-09-09 09:33:29,941 [INFO] Layer 19 - Training completed.
2025-09-09 09:33:29,942 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_19/state_dict.pt
2025-09-09 09:33:29,955 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:33:29,956 [INFO] --- Processing Layer 20 ---
2025-09-09 09:33:30,241 [INFO] Layer 20 - Training completed.
2025-09-09 09:33:30,242 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_20/state_dict.pt
2025-09-09 09:33:30,256 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:33:30,256 [INFO] --- Processing Layer 21 ---
2025-09-09 09:33:30,535 [INFO] Layer 21 - Training completed.
2025-09-09 09:33:30,536 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_21/state_dict.pt
2025-09-09 09:33:30,550 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:33:30,550 [INFO] --- Processing Layer 22 ---
2025-09-09 09:33:30,819 [INFO] Layer 22 - Training completed.
2025-09-09 09:33:30,820 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_22/state_dict.pt
2025-09-09 09:33:30,834 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:33:30,834 [INFO] --- Processing Layer 23 ---
2025-09-09 09:33:31,102 [INFO] Layer 23 - Training completed.
2025-09-09 09:33:31,103 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_23/state_dict.pt
2025-09-09 09:33:31,117 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:33:31,117 [INFO] --- Processing Layer 24 ---
2025-09-09 09:33:31,384 [INFO] Layer 24 - Training completed.
2025-09-09 09:33:31,385 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_24/state_dict.pt
2025-09-09 09:33:31,399 [INFO] Layer 24 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:33:31,399 [INFO] --- Processing Layer 25 ---
2025-09-09 09:33:31,665 [INFO] Layer 25 - Training completed.
2025-09-09 09:33:31,666 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_25/state_dict.pt
2025-09-09 09:33:31,679 [INFO] Layer 25 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:33:31,679 [INFO] --- Processing Layer 26 ---
2025-09-09 09:33:31,941 [INFO] Layer 26 - Training completed.
2025-09-09 09:33:31,942 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_26/state_dict.pt
2025-09-09 09:33:31,955 [INFO] Layer 26 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:33:31,956 [INFO] --- Processing Layer 27 ---
2025-09-09 09:33:32,220 [INFO] Layer 27 - Training completed.
2025-09-09 09:33:32,221 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_27/state_dict.pt
2025-09-09 09:33:32,235 [INFO] Layer 27 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:33:32,235 [INFO] --- Processing Layer 28 ---
2025-09-09 09:33:32,499 [INFO] Layer 28 - Training completed.
2025-09-09 09:33:32,500 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_42/layer_28/state_dict.pt
2025-09-09 09:33:32,513 [INFO] Layer 28 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:33:32,514 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:33:32,514 [INFO] --- Generating OOD Datasets for Run 1 ---
2025-09-09 09:33:32,520 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:33:32,521 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:33:32,558 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:33:36,590 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:33:36,592 [INFO] [OOD 1d] Layer 1: acc=0.3333
2025-09-09 09:33:36,594 [INFO] [OOD 1d] Layer 2: acc=0.4267
2025-09-09 09:33:36,595 [INFO] [OOD 1d] Layer 3: acc=0.4633
2025-09-09 09:33:36,597 [INFO] [OOD 1d] Layer 4: acc=0.3333
2025-09-09 09:33:36,599 [INFO] [OOD 1d] Layer 5: acc=0.8133
2025-09-09 09:33:36,600 [INFO] [OOD 1d] Layer 6: acc=0.6633
2025-09-09 09:33:36,602 [INFO] [OOD 1d] Layer 7: acc=0.6533
2025-09-09 09:33:36,603 [INFO] [OOD 1d] Layer 8: acc=0.6333
2025-09-09 09:33:36,605 [INFO] [OOD 1d] Layer 9: acc=0.7167
2025-09-09 09:33:36,606 [INFO] [OOD 1d] Layer 10: acc=0.7000
2025-09-09 09:33:36,608 [INFO] [OOD 1d] Layer 11: acc=0.7100
2025-09-09 09:33:36,609 [INFO] [OOD 1d] Layer 12: acc=0.6600
2025-09-09 09:33:36,611 [INFO] [OOD 1d] Layer 13: acc=0.7100
2025-09-09 09:33:36,612 [INFO] [OOD 1d] Layer 14: acc=0.7067
2025-09-09 09:33:36,614 [INFO] [OOD 1d] Layer 15: acc=0.7267
2025-09-09 09:33:36,615 [INFO] [OOD 1d] Layer 16: acc=0.7767
2025-09-09 09:33:36,617 [INFO] [OOD 1d] Layer 17: acc=0.8367
2025-09-09 09:33:36,618 [INFO] [OOD 1d] Layer 18: acc=0.7167
2025-09-09 09:33:36,620 [INFO] [OOD 1d] Layer 19: acc=0.9600
2025-09-09 09:33:36,621 [INFO] [OOD 1d] Layer 20: acc=0.9933
2025-09-09 09:33:36,623 [INFO] [OOD 1d] Layer 21: acc=1.0000
2025-09-09 09:33:36,625 [INFO] [OOD 1d] Layer 22: acc=0.9767
2025-09-09 09:33:36,626 [INFO] [OOD 1d] Layer 23: acc=1.0000
2025-09-09 09:33:36,627 [INFO] [OOD 1d] Layer 24: acc=1.0000
2025-09-09 09:33:36,629 [INFO] [OOD 1d] Layer 25: acc=0.9667
2025-09-09 09:33:36,630 [INFO] [OOD 1d] Layer 26: acc=0.9633
2025-09-09 09:33:36,632 [INFO] [OOD 1d] Layer 27: acc=0.9600
2025-09-09 09:33:36,634 [INFO] [OOD 1d] Layer 28: acc=0.9967
2025-09-09 09:33:36,634 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:33:39,883 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:33:39,886 [INFO] [OOD 2d] Layer 1: acc=0.1750
2025-09-09 09:33:39,887 [INFO] [OOD 2d] Layer 2: acc=0.8300
2025-09-09 09:33:39,888 [INFO] [OOD 2d] Layer 3: acc=0.9050
2025-09-09 09:33:39,889 [INFO] [OOD 2d] Layer 4: acc=0.9050
2025-09-09 09:33:39,891 [INFO] [OOD 2d] Layer 5: acc=0.9700
2025-09-09 09:33:39,892 [INFO] [OOD 2d] Layer 6: acc=0.9650
2025-09-09 09:33:39,893 [INFO] [OOD 2d] Layer 7: acc=0.9750
2025-09-09 09:33:39,894 [INFO] [OOD 2d] Layer 8: acc=0.9750
2025-09-09 09:33:39,895 [INFO] [OOD 2d] Layer 9: acc=0.9700
2025-09-09 09:33:39,896 [INFO] [OOD 2d] Layer 10: acc=1.0000
2025-09-09 09:33:39,898 [INFO] [OOD 2d] Layer 11: acc=1.0000
2025-09-09 09:33:39,899 [INFO] [OOD 2d] Layer 12: acc=1.0000
2025-09-09 09:33:39,900 [INFO] [OOD 2d] Layer 13: acc=1.0000
2025-09-09 09:33:39,901 [INFO] [OOD 2d] Layer 14: acc=1.0000
2025-09-09 09:33:39,902 [INFO] [OOD 2d] Layer 15: acc=1.0000
2025-09-09 09:33:39,903 [INFO] [OOD 2d] Layer 16: acc=1.0000
2025-09-09 09:33:39,904 [INFO] [OOD 2d] Layer 17: acc=1.0000
2025-09-09 09:33:39,906 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:33:39,907 [INFO] [OOD 2d] Layer 19: acc=1.0000
2025-09-09 09:33:39,908 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:33:39,909 [INFO] [OOD 2d] Layer 21: acc=1.0000
2025-09-09 09:33:39,910 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:33:39,911 [INFO] [OOD 2d] Layer 23: acc=1.0000
2025-09-09 09:33:39,912 [INFO] [OOD 2d] Layer 24: acc=1.0000
2025-09-09 09:33:39,914 [INFO] [OOD 2d] Layer 25: acc=1.0000
2025-09-09 09:33:39,915 [INFO] [OOD 2d] Layer 26: acc=1.0000
2025-09-09 09:33:39,916 [INFO] [OOD 2d] Layer 27: acc=0.9950
2025-09-09 09:33:39,917 [INFO] [OOD 2d] Layer 28: acc=1.0000
2025-09-09 09:33:39,917 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:33:45,742 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:33:45,745 [INFO] [OOD 3d] Layer 1: acc=0.3833
2025-09-09 09:33:45,747 [INFO] [OOD 3d] Layer 2: acc=0.4533
2025-09-09 09:33:45,749 [INFO] [OOD 3d] Layer 3: acc=0.5233
2025-09-09 09:33:45,750 [INFO] [OOD 3d] Layer 4: acc=0.7700
2025-09-09 09:33:45,751 [INFO] [OOD 3d] Layer 5: acc=0.8467
2025-09-09 09:33:45,753 [INFO] [OOD 3d] Layer 6: acc=0.8000
2025-09-09 09:33:45,755 [INFO] [OOD 3d] Layer 7: acc=0.8667
2025-09-09 09:33:45,757 [INFO] [OOD 3d] Layer 8: acc=0.9133
2025-09-09 09:33:45,758 [INFO] [OOD 3d] Layer 9: acc=0.8733
2025-09-09 09:33:45,759 [INFO] [OOD 3d] Layer 10: acc=0.9500
2025-09-09 09:33:45,761 [INFO] [OOD 3d] Layer 11: acc=0.9767
2025-09-09 09:33:45,763 [INFO] [OOD 3d] Layer 12: acc=0.9667
2025-09-09 09:33:45,764 [INFO] [OOD 3d] Layer 13: acc=0.9833
2025-09-09 09:33:45,766 [INFO] [OOD 3d] Layer 14: acc=0.9633
2025-09-09 09:33:45,767 [INFO] [OOD 3d] Layer 15: acc=0.9533
2025-09-09 09:33:45,769 [INFO] [OOD 3d] Layer 16: acc=0.9633
2025-09-09 09:33:45,770 [INFO] [OOD 3d] Layer 17: acc=0.9633
2025-09-09 09:33:45,771 [INFO] [OOD 3d] Layer 18: acc=0.9567
2025-09-09 09:33:45,773 [INFO] [OOD 3d] Layer 19: acc=1.0000
2025-09-09 09:33:45,774 [INFO] [OOD 3d] Layer 20: acc=1.0000
2025-09-09 09:33:45,776 [INFO] [OOD 3d] Layer 21: acc=1.0000
2025-09-09 09:33:45,777 [INFO] [OOD 3d] Layer 22: acc=1.0000
2025-09-09 09:33:45,779 [INFO] [OOD 3d] Layer 23: acc=0.9967
2025-09-09 09:33:45,781 [INFO] [OOD 3d] Layer 24: acc=0.9967
2025-09-09 09:33:45,782 [INFO] [OOD 3d] Layer 25: acc=0.9967
2025-09-09 09:33:45,783 [INFO] [OOD 3d] Layer 26: acc=0.9967
2025-09-09 09:33:45,785 [INFO] [OOD 3d] Layer 27: acc=0.9967
2025-09-09 09:33:45,787 [INFO] [OOD 3d] Layer 28: acc=0.9933
2025-09-09 09:33:45,787 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:33:52,217 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:33:52,219 [INFO] [OOD 4d] Layer 1: acc=0.3367
2025-09-09 09:33:52,221 [INFO] [OOD 4d] Layer 2: acc=0.3533
2025-09-09 09:33:52,222 [INFO] [OOD 4d] Layer 3: acc=0.3967
2025-09-09 09:33:52,224 [INFO] [OOD 4d] Layer 4: acc=0.7767
2025-09-09 09:33:52,225 [INFO] [OOD 4d] Layer 5: acc=0.8000
2025-09-09 09:33:52,227 [INFO] [OOD 4d] Layer 6: acc=0.8067
2025-09-09 09:33:52,229 [INFO] [OOD 4d] Layer 7: acc=0.7633
2025-09-09 09:33:52,230 [INFO] [OOD 4d] Layer 8: acc=0.7400
2025-09-09 09:33:52,231 [INFO] [OOD 4d] Layer 9: acc=0.6700
2025-09-09 09:33:52,233 [INFO] [OOD 4d] Layer 10: acc=0.6733
2025-09-09 09:33:52,235 [INFO] [OOD 4d] Layer 11: acc=0.6900
2025-09-09 09:33:52,236 [INFO] [OOD 4d] Layer 12: acc=0.6767
2025-09-09 09:33:52,238 [INFO] [OOD 4d] Layer 13: acc=0.7233
2025-09-09 09:33:52,239 [INFO] [OOD 4d] Layer 14: acc=0.6867
2025-09-09 09:33:52,241 [INFO] [OOD 4d] Layer 15: acc=0.6867
2025-09-09 09:33:52,242 [INFO] [OOD 4d] Layer 16: acc=0.6767
2025-09-09 09:33:52,244 [INFO] [OOD 4d] Layer 17: acc=0.6667
2025-09-09 09:33:52,245 [INFO] [OOD 4d] Layer 18: acc=0.6667
2025-09-09 09:33:52,247 [INFO] [OOD 4d] Layer 19: acc=0.9867
2025-09-09 09:33:52,248 [INFO] [OOD 4d] Layer 20: acc=0.9967
2025-09-09 09:33:52,250 [INFO] [OOD 4d] Layer 21: acc=1.0000
2025-09-09 09:33:52,251 [INFO] [OOD 4d] Layer 22: acc=1.0000
2025-09-09 09:33:52,253 [INFO] [OOD 4d] Layer 23: acc=0.9967
2025-09-09 09:33:52,254 [INFO] [OOD 4d] Layer 24: acc=1.0000
2025-09-09 09:33:52,256 [INFO] [OOD 4d] Layer 25: acc=0.9967
2025-09-09 09:33:52,257 [INFO] [OOD 4d] Layer 26: acc=0.9933
2025-09-09 09:33:52,258 [INFO] [OOD 4d] Layer 27: acc=0.9933
2025-09-09 09:33:52,260 [INFO] [OOD 4d] Layer 28: acc=0.9833
2025-09-09 09:33:52,260 [INFO] ==================== RUN 2/5 (Seed: 43) ====================
2025-09-09 09:33:52,261 [INFO] Using device: cuda:0
2025-09-09 09:33:52,265 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:33:52,265 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:33:52,267 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:33:52,267 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:33:52,268 [INFO] [TRAIN_COMM_3WAY_Run2] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:34:16,062 [INFO] [TRAIN_COMM_3WAY_Run2] Finished extracting activations.
2025-09-09 09:34:16,065 [INFO] Per-layer classification reports -> ./outputs/AceMath/run_seed_43/probe_3way_comm_AceMath_seed_43_20250909_093416.txt
2025-09-09 09:34:16,066 [INFO] --- Starting Probe Training Loop for layers 1..28 ---
2025-09-09 09:34:16,066 [INFO] --- Processing Layer 1 ---
2025-09-09 09:34:16,342 [INFO] Layer 1 - Training completed.
2025-09-09 09:34:16,344 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_1/state_dict.pt
2025-09-09 09:34:16,358 [INFO] Layer 1 - Test Acc: 0.3267 | F1(C0,C1,C2): 0.000, 0.278, 0.444
2025-09-09 09:34:16,359 [INFO] --- Processing Layer 2 ---
2025-09-09 09:34:16,639 [INFO] Layer 2 - Training completed.
2025-09-09 09:34:16,640 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_2/state_dict.pt
2025-09-09 09:34:16,654 [INFO] Layer 2 - Test Acc: 0.6067 | F1(C0,C1,C2): 0.769, 0.667, 0.148
2025-09-09 09:34:16,654 [INFO] --- Processing Layer 3 ---
2025-09-09 09:34:16,935 [INFO] Layer 3 - Training completed.
2025-09-09 09:34:16,936 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_3/state_dict.pt
2025-09-09 09:34:16,950 [INFO] Layer 3 - Test Acc: 0.7167 | F1(C0,C1,C2): 0.780, 0.774, 0.531
2025-09-09 09:34:16,950 [INFO] --- Processing Layer 4 ---
2025-09-09 09:34:17,217 [INFO] Layer 4 - Training completed.
2025-09-09 09:34:17,218 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_4/state_dict.pt
2025-09-09 09:34:17,231 [INFO] Layer 4 - Test Acc: 0.9400 | F1(C0,C1,C2): 0.919, 0.919, 0.980
2025-09-09 09:34:17,231 [INFO] --- Processing Layer 5 ---
2025-09-09 09:34:17,498 [INFO] Layer 5 - Training completed.
2025-09-09 09:34:17,499 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_5/state_dict.pt
2025-09-09 09:34:17,513 [INFO] Layer 5 - Test Acc: 0.9800 | F1(C0,C1,C2): 0.969, 0.971, 1.000
2025-09-09 09:34:17,513 [INFO] --- Processing Layer 6 ---
2025-09-09 09:34:17,777 [INFO] Layer 6 - Training completed.
2025-09-09 09:34:17,778 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_6/state_dict.pt
2025-09-09 09:34:17,792 [INFO] Layer 6 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.980, 1.000
2025-09-09 09:34:17,792 [INFO] --- Processing Layer 7 ---
2025-09-09 09:34:18,057 [INFO] Layer 7 - Training completed.
2025-09-09 09:34:18,058 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_7/state_dict.pt
2025-09-09 09:34:18,072 [INFO] Layer 7 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:34:18,072 [INFO] --- Processing Layer 8 ---
2025-09-09 09:34:18,339 [INFO] Layer 8 - Training completed.
2025-09-09 09:34:18,341 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_8/state_dict.pt
2025-09-09 09:34:18,354 [INFO] Layer 8 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:34:18,354 [INFO] --- Processing Layer 9 ---
2025-09-09 09:34:18,619 [INFO] Layer 9 - Training completed.
2025-09-09 09:34:18,620 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_9/state_dict.pt
2025-09-09 09:34:18,634 [INFO] Layer 9 - Test Acc: 0.9800 | F1(C0,C1,C2): 0.969, 0.971, 1.000
2025-09-09 09:34:18,634 [INFO] --- Processing Layer 10 ---
2025-09-09 09:34:18,905 [INFO] Layer 10 - Training completed.
2025-09-09 09:34:18,906 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_10/state_dict.pt
2025-09-09 09:34:18,920 [INFO] Layer 10 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:34:18,921 [INFO] --- Processing Layer 11 ---
2025-09-09 09:34:19,189 [INFO] Layer 11 - Training completed.
2025-09-09 09:34:19,190 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_11/state_dict.pt
2025-09-09 09:34:19,204 [INFO] Layer 11 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:34:19,204 [INFO] --- Processing Layer 12 ---
2025-09-09 09:34:19,469 [INFO] Layer 12 - Training completed.
2025-09-09 09:34:19,470 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_12/state_dict.pt
2025-09-09 09:34:19,483 [INFO] Layer 12 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:34:19,483 [INFO] --- Processing Layer 13 ---
2025-09-09 09:34:19,752 [INFO] Layer 13 - Training completed.
2025-09-09 09:34:19,753 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_13/state_dict.pt
2025-09-09 09:34:19,767 [INFO] Layer 13 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:34:19,767 [INFO] --- Processing Layer 14 ---
2025-09-09 09:34:20,031 [INFO] Layer 14 - Training completed.
2025-09-09 09:34:20,032 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_14/state_dict.pt
2025-09-09 09:34:20,046 [INFO] Layer 14 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:34:20,046 [INFO] --- Processing Layer 15 ---
2025-09-09 09:34:20,318 [INFO] Layer 15 - Training completed.
2025-09-09 09:34:20,319 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_15/state_dict.pt
2025-09-09 09:34:20,333 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:34:20,333 [INFO] --- Processing Layer 16 ---
2025-09-09 09:34:20,597 [INFO] Layer 16 - Training completed.
2025-09-09 09:34:20,598 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_16/state_dict.pt
2025-09-09 09:34:20,611 [INFO] Layer 16 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:34:20,612 [INFO] --- Processing Layer 17 ---
2025-09-09 09:34:20,877 [INFO] Layer 17 - Training completed.
2025-09-09 09:34:20,878 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_17/state_dict.pt
2025-09-09 09:34:20,892 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:34:20,892 [INFO] --- Processing Layer 18 ---
2025-09-09 09:34:21,162 [INFO] Layer 18 - Training completed.
2025-09-09 09:34:21,163 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_18/state_dict.pt
2025-09-09 09:34:21,177 [INFO] Layer 18 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:34:21,177 [INFO] --- Processing Layer 19 ---
2025-09-09 09:34:21,463 [INFO] Layer 19 - Training completed.
2025-09-09 09:34:21,464 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_19/state_dict.pt
2025-09-09 09:34:21,477 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:34:21,478 [INFO] --- Processing Layer 20 ---
2025-09-09 09:34:21,769 [INFO] Layer 20 - Training completed.
2025-09-09 09:34:21,770 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_20/state_dict.pt
2025-09-09 09:34:21,787 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:34:21,787 [INFO] --- Processing Layer 21 ---
2025-09-09 09:34:22,072 [INFO] Layer 21 - Training completed.
2025-09-09 09:34:22,073 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_21/state_dict.pt
2025-09-09 09:34:22,086 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:34:22,086 [INFO] --- Processing Layer 22 ---
2025-09-09 09:34:22,369 [INFO] Layer 22 - Training completed.
2025-09-09 09:34:22,370 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_22/state_dict.pt
2025-09-09 09:34:22,384 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:34:22,384 [INFO] --- Processing Layer 23 ---
2025-09-09 09:34:22,653 [INFO] Layer 23 - Training completed.
2025-09-09 09:34:22,654 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_23/state_dict.pt
2025-09-09 09:34:22,668 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:34:22,668 [INFO] --- Processing Layer 24 ---
2025-09-09 09:34:22,939 [INFO] Layer 24 - Training completed.
2025-09-09 09:34:22,940 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_24/state_dict.pt
2025-09-09 09:34:22,953 [INFO] Layer 24 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:34:22,954 [INFO] --- Processing Layer 25 ---
2025-09-09 09:34:23,239 [INFO] Layer 25 - Training completed.
2025-09-09 09:34:23,241 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_25/state_dict.pt
2025-09-09 09:34:23,254 [INFO] Layer 25 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:34:23,254 [INFO] --- Processing Layer 26 ---
2025-09-09 09:34:23,554 [INFO] Layer 26 - Training completed.
2025-09-09 09:34:23,555 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_26/state_dict.pt
2025-09-09 09:34:23,569 [INFO] Layer 26 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:34:23,569 [INFO] --- Processing Layer 27 ---
2025-09-09 09:34:23,851 [INFO] Layer 27 - Training completed.
2025-09-09 09:34:23,853 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_27/state_dict.pt
2025-09-09 09:34:23,867 [INFO] Layer 27 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:34:23,867 [INFO] --- Processing Layer 28 ---
2025-09-09 09:34:24,135 [INFO] Layer 28 - Training completed.
2025-09-09 09:34:24,137 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_43/layer_28/state_dict.pt
2025-09-09 09:34:24,150 [INFO] Layer 28 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:34:24,151 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:34:24,151 [INFO] --- Generating OOD Datasets for Run 2 ---
2025-09-09 09:34:24,157 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:34:24,159 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:34:24,195 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:34:28,231 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:34:28,234 [INFO] [OOD 1d] Layer 1: acc=0.3333
2025-09-09 09:34:28,235 [INFO] [OOD 1d] Layer 2: acc=0.3500
2025-09-09 09:34:28,237 [INFO] [OOD 1d] Layer 3: acc=0.4200
2025-09-09 09:34:28,238 [INFO] [OOD 1d] Layer 4: acc=0.4467
2025-09-09 09:34:28,240 [INFO] [OOD 1d] Layer 5: acc=0.8867
2025-09-09 09:34:28,242 [INFO] [OOD 1d] Layer 6: acc=0.8633
2025-09-09 09:34:28,243 [INFO] [OOD 1d] Layer 7: acc=0.8100
2025-09-09 09:34:28,245 [INFO] [OOD 1d] Layer 8: acc=0.6333
2025-09-09 09:34:28,246 [INFO] [OOD 1d] Layer 9: acc=0.8200
2025-09-09 09:34:28,248 [INFO] [OOD 1d] Layer 10: acc=0.6867
2025-09-09 09:34:28,250 [INFO] [OOD 1d] Layer 11: acc=0.6800
2025-09-09 09:34:28,251 [INFO] [OOD 1d] Layer 12: acc=0.6667
2025-09-09 09:34:28,253 [INFO] [OOD 1d] Layer 13: acc=0.6833
2025-09-09 09:34:28,254 [INFO] [OOD 1d] Layer 14: acc=0.7500
2025-09-09 09:34:28,255 [INFO] [OOD 1d] Layer 15: acc=0.6933
2025-09-09 09:34:28,257 [INFO] [OOD 1d] Layer 16: acc=0.8733
2025-09-09 09:34:28,259 [INFO] [OOD 1d] Layer 17: acc=0.8233
2025-09-09 09:34:28,260 [INFO] [OOD 1d] Layer 18: acc=0.8700
2025-09-09 09:34:28,262 [INFO] [OOD 1d] Layer 19: acc=0.9733
2025-09-09 09:34:28,263 [INFO] [OOD 1d] Layer 20: acc=1.0000
2025-09-09 09:34:28,265 [INFO] [OOD 1d] Layer 21: acc=1.0000
2025-09-09 09:34:28,266 [INFO] [OOD 1d] Layer 22: acc=0.9733
2025-09-09 09:34:28,268 [INFO] [OOD 1d] Layer 23: acc=1.0000
2025-09-09 09:34:28,269 [INFO] [OOD 1d] Layer 24: acc=0.9667
2025-09-09 09:34:28,271 [INFO] [OOD 1d] Layer 25: acc=1.0000
2025-09-09 09:34:28,272 [INFO] [OOD 1d] Layer 26: acc=1.0000
2025-09-09 09:34:28,274 [INFO] [OOD 1d] Layer 27: acc=0.9833
2025-09-09 09:34:28,275 [INFO] [OOD 1d] Layer 28: acc=0.9733
2025-09-09 09:34:28,275 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:34:31,526 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:34:31,528 [INFO] [OOD 2d] Layer 1: acc=0.1750
2025-09-09 09:34:31,529 [INFO] [OOD 2d] Layer 2: acc=0.8950
2025-09-09 09:34:31,530 [INFO] [OOD 2d] Layer 3: acc=0.9150
2025-09-09 09:34:31,531 [INFO] [OOD 2d] Layer 4: acc=0.9450
2025-09-09 09:34:31,533 [INFO] [OOD 2d] Layer 5: acc=0.9800
2025-09-09 09:34:31,534 [INFO] [OOD 2d] Layer 6: acc=0.9950
2025-09-09 09:34:31,535 [INFO] [OOD 2d] Layer 7: acc=0.9900
2025-09-09 09:34:31,536 [INFO] [OOD 2d] Layer 8: acc=1.0000
2025-09-09 09:34:31,538 [INFO] [OOD 2d] Layer 9: acc=0.9850
2025-09-09 09:34:31,539 [INFO] [OOD 2d] Layer 10: acc=0.9900
2025-09-09 09:34:31,540 [INFO] [OOD 2d] Layer 11: acc=0.9950
2025-09-09 09:34:31,541 [INFO] [OOD 2d] Layer 12: acc=0.9900
2025-09-09 09:34:31,542 [INFO] [OOD 2d] Layer 13: acc=0.9900
2025-09-09 09:34:31,543 [INFO] [OOD 2d] Layer 14: acc=0.9900
2025-09-09 09:34:31,545 [INFO] [OOD 2d] Layer 15: acc=0.9900
2025-09-09 09:34:31,546 [INFO] [OOD 2d] Layer 16: acc=1.0000
2025-09-09 09:34:31,547 [INFO] [OOD 2d] Layer 17: acc=1.0000
2025-09-09 09:34:31,548 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:34:31,549 [INFO] [OOD 2d] Layer 19: acc=1.0000
2025-09-09 09:34:31,551 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:34:31,552 [INFO] [OOD 2d] Layer 21: acc=1.0000
2025-09-09 09:34:31,553 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:34:31,554 [INFO] [OOD 2d] Layer 23: acc=1.0000
2025-09-09 09:34:31,555 [INFO] [OOD 2d] Layer 24: acc=1.0000
2025-09-09 09:34:31,557 [INFO] [OOD 2d] Layer 25: acc=1.0000
2025-09-09 09:34:31,558 [INFO] [OOD 2d] Layer 26: acc=1.0000
2025-09-09 09:34:31,559 [INFO] [OOD 2d] Layer 27: acc=0.9850
2025-09-09 09:34:31,560 [INFO] [OOD 2d] Layer 28: acc=0.9950
2025-09-09 09:34:31,560 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:34:37,402 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:34:37,405 [INFO] [OOD 3d] Layer 1: acc=0.3700
2025-09-09 09:34:37,407 [INFO] [OOD 3d] Layer 2: acc=0.3933
2025-09-09 09:34:37,408 [INFO] [OOD 3d] Layer 3: acc=0.5467
2025-09-09 09:34:37,410 [INFO] [OOD 3d] Layer 4: acc=0.8533
2025-09-09 09:34:37,411 [INFO] [OOD 3d] Layer 5: acc=0.7967
2025-09-09 09:34:37,413 [INFO] [OOD 3d] Layer 6: acc=0.7200
2025-09-09 09:34:37,414 [INFO] [OOD 3d] Layer 7: acc=0.8933
2025-09-09 09:34:37,416 [INFO] [OOD 3d] Layer 8: acc=0.9300
2025-09-09 09:34:37,417 [INFO] [OOD 3d] Layer 9: acc=0.9167
2025-09-09 09:34:37,419 [INFO] [OOD 3d] Layer 10: acc=0.9367
2025-09-09 09:34:37,421 [INFO] [OOD 3d] Layer 11: acc=0.9667
2025-09-09 09:34:37,422 [INFO] [OOD 3d] Layer 12: acc=0.9233
2025-09-09 09:34:37,423 [INFO] [OOD 3d] Layer 13: acc=0.9567
2025-09-09 09:34:37,425 [INFO] [OOD 3d] Layer 14: acc=0.9700
2025-09-09 09:34:37,427 [INFO] [OOD 3d] Layer 15: acc=0.8900
2025-09-09 09:34:37,428 [INFO] [OOD 3d] Layer 16: acc=0.9567
2025-09-09 09:34:37,430 [INFO] [OOD 3d] Layer 17: acc=0.9633
2025-09-09 09:34:37,431 [INFO] [OOD 3d] Layer 18: acc=0.9567
2025-09-09 09:34:37,433 [INFO] [OOD 3d] Layer 19: acc=0.9933
2025-09-09 09:34:37,434 [INFO] [OOD 3d] Layer 20: acc=1.0000
2025-09-09 09:34:37,435 [INFO] [OOD 3d] Layer 21: acc=1.0000
2025-09-09 09:34:37,437 [INFO] [OOD 3d] Layer 22: acc=1.0000
2025-09-09 09:34:37,438 [INFO] [OOD 3d] Layer 23: acc=1.0000
2025-09-09 09:34:37,440 [INFO] [OOD 3d] Layer 24: acc=1.0000
2025-09-09 09:34:37,442 [INFO] [OOD 3d] Layer 25: acc=1.0000
2025-09-09 09:34:37,443 [INFO] [OOD 3d] Layer 26: acc=0.9967
2025-09-09 09:34:37,445 [INFO] [OOD 3d] Layer 27: acc=0.9967
2025-09-09 09:34:37,446 [INFO] [OOD 3d] Layer 28: acc=1.0000
2025-09-09 09:34:37,446 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:34:43,878 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:34:43,881 [INFO] [OOD 4d] Layer 1: acc=0.3900
2025-09-09 09:34:43,882 [INFO] [OOD 4d] Layer 2: acc=0.3367
2025-09-09 09:34:43,884 [INFO] [OOD 4d] Layer 3: acc=0.4100
2025-09-09 09:34:43,885 [INFO] [OOD 4d] Layer 4: acc=0.6800
2025-09-09 09:34:43,887 [INFO] [OOD 4d] Layer 5: acc=0.8333
2025-09-09 09:34:43,888 [INFO] [OOD 4d] Layer 6: acc=0.7067
2025-09-09 09:34:43,890 [INFO] [OOD 4d] Layer 7: acc=0.7967
2025-09-09 09:34:43,891 [INFO] [OOD 4d] Layer 8: acc=0.7233
2025-09-09 09:34:43,893 [INFO] [OOD 4d] Layer 9: acc=0.7033
2025-09-09 09:34:43,895 [INFO] [OOD 4d] Layer 10: acc=0.6700
2025-09-09 09:34:43,896 [INFO] [OOD 4d] Layer 11: acc=0.6833
2025-09-09 09:34:43,898 [INFO] [OOD 4d] Layer 12: acc=0.6667
2025-09-09 09:34:43,899 [INFO] [OOD 4d] Layer 13: acc=0.6767
2025-09-09 09:34:43,901 [INFO] [OOD 4d] Layer 14: acc=0.6700
2025-09-09 09:34:43,902 [INFO] [OOD 4d] Layer 15: acc=0.6667
2025-09-09 09:34:43,904 [INFO] [OOD 4d] Layer 16: acc=0.6667
2025-09-09 09:34:43,905 [INFO] [OOD 4d] Layer 17: acc=0.6700
2025-09-09 09:34:43,907 [INFO] [OOD 4d] Layer 18: acc=0.6733
2025-09-09 09:34:43,908 [INFO] [OOD 4d] Layer 19: acc=0.9033
2025-09-09 09:34:43,910 [INFO] [OOD 4d] Layer 20: acc=0.9800
2025-09-09 09:34:43,911 [INFO] [OOD 4d] Layer 21: acc=0.9967
2025-09-09 09:34:43,913 [INFO] [OOD 4d] Layer 22: acc=0.9967
2025-09-09 09:34:43,914 [INFO] [OOD 4d] Layer 23: acc=1.0000
2025-09-09 09:34:43,916 [INFO] [OOD 4d] Layer 24: acc=0.9967
2025-09-09 09:34:43,917 [INFO] [OOD 4d] Layer 25: acc=0.9933
2025-09-09 09:34:43,919 [INFO] [OOD 4d] Layer 26: acc=0.9833
2025-09-09 09:34:43,920 [INFO] [OOD 4d] Layer 27: acc=0.9767
2025-09-09 09:34:43,922 [INFO] [OOD 4d] Layer 28: acc=0.9700
2025-09-09 09:34:43,922 [INFO] ==================== RUN 3/5 (Seed: 44) ====================
2025-09-09 09:34:43,923 [INFO] Using device: cuda:0
2025-09-09 09:34:43,927 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:34:43,927 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:34:43,929 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:34:43,929 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:34:43,930 [INFO] [TRAIN_COMM_3WAY_Run3] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:35:07,565 [INFO] [TRAIN_COMM_3WAY_Run3] Finished extracting activations.
2025-09-09 09:35:07,594 [INFO] Per-layer classification reports -> ./outputs/AceMath/run_seed_44/probe_3way_comm_AceMath_seed_44_20250909_093507.txt
2025-09-09 09:35:07,594 [INFO] --- Starting Probe Training Loop for layers 1..28 ---
2025-09-09 09:35:07,594 [INFO] --- Processing Layer 1 ---
2025-09-09 09:35:07,858 [INFO] Layer 1 - Training completed.
2025-09-09 09:35:07,859 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_1/state_dict.pt
2025-09-09 09:35:07,873 [INFO] Layer 1 - Test Acc: 0.3900 | F1(C0,C1,C2): 0.514, 0.148, 0.320
2025-09-09 09:35:07,873 [INFO] --- Processing Layer 2 ---
2025-09-09 09:35:08,138 [INFO] Layer 2 - Training completed.
2025-09-09 09:35:08,139 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_2/state_dict.pt
2025-09-09 09:35:08,153 [INFO] Layer 2 - Test Acc: 0.6500 | F1(C0,C1,C2): 0.708, 0.683, 0.563
2025-09-09 09:35:08,153 [INFO] --- Processing Layer 3 ---
2025-09-09 09:35:08,449 [INFO] Layer 3 - Training completed.
2025-09-09 09:35:08,450 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_3/state_dict.pt
2025-09-09 09:35:08,463 [INFO] Layer 3 - Test Acc: 0.6900 | F1(C0,C1,C2): 0.823, 0.680, 0.571
2025-09-09 09:35:08,464 [INFO] --- Processing Layer 4 ---
2025-09-09 09:35:08,725 [INFO] Layer 4 - Training completed.
2025-09-09 09:35:08,726 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_4/state_dict.pt
2025-09-09 09:35:08,739 [INFO] Layer 4 - Test Acc: 0.9000 | F1(C0,C1,C2): 0.905, 0.824, 0.957
2025-09-09 09:35:08,739 [INFO] --- Processing Layer 5 ---
2025-09-09 09:35:08,999 [INFO] Layer 5 - Training completed.
2025-09-09 09:35:09,001 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_5/state_dict.pt
2025-09-09 09:35:09,014 [INFO] Layer 5 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:35:09,014 [INFO] --- Processing Layer 6 ---
2025-09-09 09:35:09,276 [INFO] Layer 6 - Training completed.
2025-09-09 09:35:09,277 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_6/state_dict.pt
2025-09-09 09:35:09,291 [INFO] Layer 6 - Test Acc: 0.9700 | F1(C0,C1,C2): 0.953, 0.957, 1.000
2025-09-09 09:35:09,291 [INFO] --- Processing Layer 7 ---
2025-09-09 09:35:09,557 [INFO] Layer 7 - Training completed.
2025-09-09 09:35:09,558 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_7/state_dict.pt
2025-09-09 09:35:09,572 [INFO] Layer 7 - Test Acc: 0.9467 | F1(C0,C1,C2): 0.913, 0.926, 1.000
2025-09-09 09:35:09,573 [INFO] --- Processing Layer 8 ---
2025-09-09 09:35:09,835 [INFO] Layer 8 - Training completed.
2025-09-09 09:35:09,837 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_8/state_dict.pt
2025-09-09 09:35:09,850 [INFO] Layer 8 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:35:09,850 [INFO] --- Processing Layer 9 ---
2025-09-09 09:35:10,116 [INFO] Layer 9 - Training completed.
2025-09-09 09:35:10,117 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_9/state_dict.pt
2025-09-09 09:35:10,131 [INFO] Layer 9 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:35:10,131 [INFO] --- Processing Layer 10 ---
2025-09-09 09:35:10,397 [INFO] Layer 10 - Training completed.
2025-09-09 09:35:10,398 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_10/state_dict.pt
2025-09-09 09:35:10,412 [INFO] Layer 10 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:10,413 [INFO] --- Processing Layer 11 ---
2025-09-09 09:35:10,678 [INFO] Layer 11 - Training completed.
2025-09-09 09:35:10,679 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_11/state_dict.pt
2025-09-09 09:35:10,693 [INFO] Layer 11 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:10,693 [INFO] --- Processing Layer 12 ---
2025-09-09 09:35:10,958 [INFO] Layer 12 - Training completed.
2025-09-09 09:35:10,959 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_12/state_dict.pt
2025-09-09 09:35:10,972 [INFO] Layer 12 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:10,973 [INFO] --- Processing Layer 13 ---
2025-09-09 09:35:11,236 [INFO] Layer 13 - Training completed.
2025-09-09 09:35:11,237 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_13/state_dict.pt
2025-09-09 09:35:11,251 [INFO] Layer 13 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:11,251 [INFO] --- Processing Layer 14 ---
2025-09-09 09:35:11,516 [INFO] Layer 14 - Training completed.
2025-09-09 09:35:11,518 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_14/state_dict.pt
2025-09-09 09:35:11,533 [INFO] Layer 14 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:11,533 [INFO] --- Processing Layer 15 ---
2025-09-09 09:35:11,801 [INFO] Layer 15 - Training completed.
2025-09-09 09:35:11,803 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_15/state_dict.pt
2025-09-09 09:35:11,817 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:11,817 [INFO] --- Processing Layer 16 ---
2025-09-09 09:35:12,079 [INFO] Layer 16 - Training completed.
2025-09-09 09:35:12,080 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_16/state_dict.pt
2025-09-09 09:35:12,094 [INFO] Layer 16 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:12,094 [INFO] --- Processing Layer 17 ---
2025-09-09 09:35:12,358 [INFO] Layer 17 - Training completed.
2025-09-09 09:35:12,359 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_17/state_dict.pt
2025-09-09 09:35:12,372 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:12,373 [INFO] --- Processing Layer 18 ---
2025-09-09 09:35:12,639 [INFO] Layer 18 - Training completed.
2025-09-09 09:35:12,641 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_18/state_dict.pt
2025-09-09 09:35:12,656 [INFO] Layer 18 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:12,656 [INFO] --- Processing Layer 19 ---
2025-09-09 09:35:12,923 [INFO] Layer 19 - Training completed.
2025-09-09 09:35:12,925 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_19/state_dict.pt
2025-09-09 09:35:12,939 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:12,939 [INFO] --- Processing Layer 20 ---
2025-09-09 09:35:13,206 [INFO] Layer 20 - Training completed.
2025-09-09 09:35:13,207 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_20/state_dict.pt
2025-09-09 09:35:13,222 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:13,222 [INFO] --- Processing Layer 21 ---
2025-09-09 09:35:13,487 [INFO] Layer 21 - Training completed.
2025-09-09 09:35:13,489 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_21/state_dict.pt
2025-09-09 09:35:13,502 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:13,503 [INFO] --- Processing Layer 22 ---
2025-09-09 09:35:13,773 [INFO] Layer 22 - Training completed.
2025-09-09 09:35:13,774 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_22/state_dict.pt
2025-09-09 09:35:13,788 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:13,788 [INFO] --- Processing Layer 23 ---
2025-09-09 09:35:14,056 [INFO] Layer 23 - Training completed.
2025-09-09 09:35:14,057 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_23/state_dict.pt
2025-09-09 09:35:14,070 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:14,071 [INFO] --- Processing Layer 24 ---
2025-09-09 09:35:14,341 [INFO] Layer 24 - Training completed.
2025-09-09 09:35:14,342 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_24/state_dict.pt
2025-09-09 09:35:14,357 [INFO] Layer 24 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:14,357 [INFO] --- Processing Layer 25 ---
2025-09-09 09:35:14,626 [INFO] Layer 25 - Training completed.
2025-09-09 09:35:14,627 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_25/state_dict.pt
2025-09-09 09:35:14,641 [INFO] Layer 25 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:14,641 [INFO] --- Processing Layer 26 ---
2025-09-09 09:35:14,906 [INFO] Layer 26 - Training completed.
2025-09-09 09:35:14,907 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_26/state_dict.pt
2025-09-09 09:35:14,921 [INFO] Layer 26 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:14,921 [INFO] --- Processing Layer 27 ---
2025-09-09 09:35:15,192 [INFO] Layer 27 - Training completed.
2025-09-09 09:35:15,193 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_27/state_dict.pt
2025-09-09 09:35:15,207 [INFO] Layer 27 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:15,207 [INFO] --- Processing Layer 28 ---
2025-09-09 09:35:15,475 [INFO] Layer 28 - Training completed.
2025-09-09 09:35:15,476 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_44/layer_28/state_dict.pt
2025-09-09 09:35:15,490 [INFO] Layer 28 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:35:15,490 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:35:15,490 [INFO] --- Generating OOD Datasets for Run 3 ---
2025-09-09 09:35:15,496 [WARNING] [WARN] OOD Class-2 (2-digit): Got 1/100
2025-09-09 09:35:15,498 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:35:15,535 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:35:19,522 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:35:19,525 [INFO] [OOD 1d] Layer 1: acc=0.3200
2025-09-09 09:35:19,526 [INFO] [OOD 1d] Layer 2: acc=0.3933
2025-09-09 09:35:19,528 [INFO] [OOD 1d] Layer 3: acc=0.5500
2025-09-09 09:35:19,530 [INFO] [OOD 1d] Layer 4: acc=0.3333
2025-09-09 09:35:19,531 [INFO] [OOD 1d] Layer 5: acc=0.8533
2025-09-09 09:35:19,533 [INFO] [OOD 1d] Layer 6: acc=0.6833
2025-09-09 09:35:19,534 [INFO] [OOD 1d] Layer 7: acc=0.7867
2025-09-09 09:35:19,536 [INFO] [OOD 1d] Layer 8: acc=0.6533
2025-09-09 09:35:19,537 [INFO] [OOD 1d] Layer 9: acc=0.6800
2025-09-09 09:35:19,539 [INFO] [OOD 1d] Layer 10: acc=0.6767
2025-09-09 09:35:19,540 [INFO] [OOD 1d] Layer 11: acc=0.7100
2025-09-09 09:35:19,542 [INFO] [OOD 1d] Layer 12: acc=0.6667
2025-09-09 09:35:19,543 [INFO] [OOD 1d] Layer 13: acc=0.7633
2025-09-09 09:35:19,545 [INFO] [OOD 1d] Layer 14: acc=0.9500
2025-09-09 09:35:19,546 [INFO] [OOD 1d] Layer 15: acc=0.6567
2025-09-09 09:35:19,548 [INFO] [OOD 1d] Layer 16: acc=0.9367
2025-09-09 09:35:19,549 [INFO] [OOD 1d] Layer 17: acc=0.8900
2025-09-09 09:35:19,551 [INFO] [OOD 1d] Layer 18: acc=0.8633
2025-09-09 09:35:19,553 [INFO] [OOD 1d] Layer 19: acc=0.9800
2025-09-09 09:35:19,554 [INFO] [OOD 1d] Layer 20: acc=1.0000
2025-09-09 09:35:19,555 [INFO] [OOD 1d] Layer 21: acc=1.0000
2025-09-09 09:35:19,557 [INFO] [OOD 1d] Layer 22: acc=1.0000
2025-09-09 09:35:19,559 [INFO] [OOD 1d] Layer 23: acc=1.0000
2025-09-09 09:35:19,560 [INFO] [OOD 1d] Layer 24: acc=1.0000
2025-09-09 09:35:19,562 [INFO] [OOD 1d] Layer 25: acc=0.9900
2025-09-09 09:35:19,563 [INFO] [OOD 1d] Layer 26: acc=1.0000
2025-09-09 09:35:19,565 [INFO] [OOD 1d] Layer 27: acc=1.0000
2025-09-09 09:35:19,566 [INFO] [OOD 1d] Layer 28: acc=1.0000
2025-09-09 09:35:19,566 [INFO] [OOD_2d_ALL] Extracting activations for 201 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:35:22,823 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:35:22,826 [INFO] [OOD 2d] Layer 1: acc=0.4627
2025-09-09 09:35:22,827 [INFO] [OOD 2d] Layer 2: acc=0.7413
2025-09-09 09:35:22,828 [INFO] [OOD 2d] Layer 3: acc=0.8209
2025-09-09 09:35:22,829 [INFO] [OOD 2d] Layer 4: acc=0.8607
2025-09-09 09:35:22,831 [INFO] [OOD 2d] Layer 5: acc=0.9900
2025-09-09 09:35:22,832 [INFO] [OOD 2d] Layer 6: acc=0.9652
2025-09-09 09:35:22,833 [INFO] [OOD 2d] Layer 7: acc=0.9353
2025-09-09 09:35:22,834 [INFO] [OOD 2d] Layer 8: acc=0.9950
2025-09-09 09:35:22,835 [INFO] [OOD 2d] Layer 9: acc=1.0000
2025-09-09 09:35:22,837 [INFO] [OOD 2d] Layer 10: acc=1.0000
2025-09-09 09:35:22,838 [INFO] [OOD 2d] Layer 11: acc=1.0000
2025-09-09 09:35:22,839 [INFO] [OOD 2d] Layer 12: acc=1.0000
2025-09-09 09:35:22,840 [INFO] [OOD 2d] Layer 13: acc=1.0000
2025-09-09 09:35:22,841 [INFO] [OOD 2d] Layer 14: acc=1.0000
2025-09-09 09:35:22,842 [INFO] [OOD 2d] Layer 15: acc=1.0000
2025-09-09 09:35:22,843 [INFO] [OOD 2d] Layer 16: acc=1.0000
2025-09-09 09:35:22,845 [INFO] [OOD 2d] Layer 17: acc=1.0000
2025-09-09 09:35:22,846 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:35:22,847 [INFO] [OOD 2d] Layer 19: acc=1.0000
2025-09-09 09:35:22,848 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:35:22,849 [INFO] [OOD 2d] Layer 21: acc=1.0000
2025-09-09 09:35:22,850 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:35:22,852 [INFO] [OOD 2d] Layer 23: acc=0.9950
2025-09-09 09:35:22,853 [INFO] [OOD 2d] Layer 24: acc=1.0000
2025-09-09 09:35:22,854 [INFO] [OOD 2d] Layer 25: acc=0.9950
2025-09-09 09:35:22,855 [INFO] [OOD 2d] Layer 26: acc=1.0000
2025-09-09 09:35:22,856 [INFO] [OOD 2d] Layer 27: acc=0.9950
2025-09-09 09:35:22,857 [INFO] [OOD 2d] Layer 28: acc=0.9950
2025-09-09 09:35:22,858 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:35:28,674 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:35:28,676 [INFO] [OOD 3d] Layer 1: acc=0.3467
2025-09-09 09:35:28,678 [INFO] [OOD 3d] Layer 2: acc=0.4367
2025-09-09 09:35:28,679 [INFO] [OOD 3d] Layer 3: acc=0.5933
2025-09-09 09:35:28,681 [INFO] [OOD 3d] Layer 4: acc=0.7100
2025-09-09 09:35:28,683 [INFO] [OOD 3d] Layer 5: acc=0.8100
2025-09-09 09:35:28,684 [INFO] [OOD 3d] Layer 6: acc=0.8100
2025-09-09 09:35:28,686 [INFO] [OOD 3d] Layer 7: acc=0.9233
2025-09-09 09:35:28,687 [INFO] [OOD 3d] Layer 8: acc=0.9033
2025-09-09 09:35:28,689 [INFO] [OOD 3d] Layer 9: acc=0.9800
2025-09-09 09:35:28,690 [INFO] [OOD 3d] Layer 10: acc=0.9667
2025-09-09 09:35:28,692 [INFO] [OOD 3d] Layer 11: acc=0.9667
2025-09-09 09:35:28,693 [INFO] [OOD 3d] Layer 12: acc=0.9733
2025-09-09 09:35:28,695 [INFO] [OOD 3d] Layer 13: acc=0.9567
2025-09-09 09:35:28,696 [INFO] [OOD 3d] Layer 14: acc=0.9767
2025-09-09 09:35:28,698 [INFO] [OOD 3d] Layer 15: acc=0.9633
2025-09-09 09:35:28,699 [INFO] [OOD 3d] Layer 16: acc=0.9833
2025-09-09 09:35:28,701 [INFO] [OOD 3d] Layer 17: acc=0.9633
2025-09-09 09:35:28,702 [INFO] [OOD 3d] Layer 18: acc=0.9867
2025-09-09 09:35:28,704 [INFO] [OOD 3d] Layer 19: acc=0.9933
2025-09-09 09:35:28,706 [INFO] [OOD 3d] Layer 20: acc=1.0000
2025-09-09 09:35:28,707 [INFO] [OOD 3d] Layer 21: acc=1.0000
2025-09-09 09:35:28,709 [INFO] [OOD 3d] Layer 22: acc=1.0000
2025-09-09 09:35:28,710 [INFO] [OOD 3d] Layer 23: acc=0.9967
2025-09-09 09:35:28,712 [INFO] [OOD 3d] Layer 24: acc=0.9933
2025-09-09 09:35:28,713 [INFO] [OOD 3d] Layer 25: acc=0.9867
2025-09-09 09:35:28,715 [INFO] [OOD 3d] Layer 26: acc=0.9967
2025-09-09 09:35:28,716 [INFO] [OOD 3d] Layer 27: acc=0.9967
2025-09-09 09:35:28,718 [INFO] [OOD 3d] Layer 28: acc=1.0000
2025-09-09 09:35:28,718 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:35:35,132 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:35:35,134 [INFO] [OOD 4d] Layer 1: acc=0.3333
2025-09-09 09:35:35,136 [INFO] [OOD 4d] Layer 2: acc=0.4200
2025-09-09 09:35:35,137 [INFO] [OOD 4d] Layer 3: acc=0.5067
2025-09-09 09:35:35,139 [INFO] [OOD 4d] Layer 4: acc=0.8567
2025-09-09 09:35:35,141 [INFO] [OOD 4d] Layer 5: acc=0.7900
2025-09-09 09:35:35,142 [INFO] [OOD 4d] Layer 6: acc=0.8200
2025-09-09 09:35:35,144 [INFO] [OOD 4d] Layer 7: acc=0.7600
2025-09-09 09:35:35,145 [INFO] [OOD 4d] Layer 8: acc=0.8700
2025-09-09 09:35:35,147 [INFO] [OOD 4d] Layer 9: acc=0.8000
2025-09-09 09:35:35,148 [INFO] [OOD 4d] Layer 10: acc=0.7200
2025-09-09 09:35:35,150 [INFO] [OOD 4d] Layer 11: acc=0.7967
2025-09-09 09:35:35,151 [INFO] [OOD 4d] Layer 12: acc=0.6900
2025-09-09 09:35:35,153 [INFO] [OOD 4d] Layer 13: acc=0.9833
2025-09-09 09:35:35,154 [INFO] [OOD 4d] Layer 14: acc=0.7100
2025-09-09 09:35:35,156 [INFO] [OOD 4d] Layer 15: acc=0.6900
2025-09-09 09:35:35,157 [INFO] [OOD 4d] Layer 16: acc=0.7033
2025-09-09 09:35:35,159 [INFO] [OOD 4d] Layer 17: acc=0.6667
2025-09-09 09:35:35,160 [INFO] [OOD 4d] Layer 18: acc=0.7033
2025-09-09 09:35:35,162 [INFO] [OOD 4d] Layer 19: acc=0.9667
2025-09-09 09:35:35,163 [INFO] [OOD 4d] Layer 20: acc=0.9700
2025-09-09 09:35:35,165 [INFO] [OOD 4d] Layer 21: acc=0.9967
2025-09-09 09:35:35,166 [INFO] [OOD 4d] Layer 22: acc=0.9967
2025-09-09 09:35:35,168 [INFO] [OOD 4d] Layer 23: acc=0.9967
2025-09-09 09:35:35,169 [INFO] [OOD 4d] Layer 24: acc=1.0000
2025-09-09 09:35:35,171 [INFO] [OOD 4d] Layer 25: acc=1.0000
2025-09-09 09:35:35,173 [INFO] [OOD 4d] Layer 26: acc=1.0000
2025-09-09 09:35:35,174 [INFO] [OOD 4d] Layer 27: acc=0.9967
2025-09-09 09:35:35,175 [INFO] [OOD 4d] Layer 28: acc=0.9900
2025-09-09 09:35:35,176 [INFO] ==================== RUN 4/5 (Seed: 45) ====================
2025-09-09 09:35:35,177 [INFO] Using device: cuda:0
2025-09-09 09:35:35,181 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:35:35,181 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:35:35,183 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:35:35,183 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:35:35,184 [INFO] [TRAIN_COMM_3WAY_Run4] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:35:59,028 [INFO] [TRAIN_COMM_3WAY_Run4] Finished extracting activations.
2025-09-09 09:35:59,030 [INFO] Per-layer classification reports -> ./outputs/AceMath/run_seed_45/probe_3way_comm_AceMath_seed_45_20250909_093559.txt
2025-09-09 09:35:59,031 [INFO] --- Starting Probe Training Loop for layers 1..28 ---
2025-09-09 09:35:59,031 [INFO] --- Processing Layer 1 ---
2025-09-09 09:35:59,299 [INFO] Layer 1 - Training completed.
2025-09-09 09:35:59,301 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_1/state_dict.pt
2025-09-09 09:35:59,314 [INFO] Layer 1 - Test Acc: 0.4533 | F1(C0,C1,C2): 0.565, 0.147, 0.432
2025-09-09 09:35:59,315 [INFO] --- Processing Layer 2 ---
2025-09-09 09:35:59,608 [INFO] Layer 2 - Training completed.
2025-09-09 09:35:59,609 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_2/state_dict.pt
2025-09-09 09:35:59,623 [INFO] Layer 2 - Test Acc: 0.7667 | F1(C0,C1,C2): 0.840, 0.764, 0.699
2025-09-09 09:35:59,623 [INFO] --- Processing Layer 3 ---
2025-09-09 09:35:59,885 [INFO] Layer 3 - Training completed.
2025-09-09 09:35:59,886 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_3/state_dict.pt
2025-09-09 09:35:59,900 [INFO] Layer 3 - Test Acc: 0.6767 | F1(C0,C1,C2): 0.770, 0.768, 0.303
2025-09-09 09:35:59,900 [INFO] --- Processing Layer 4 ---
2025-09-09 09:36:00,173 [INFO] Layer 4 - Training completed.
2025-09-09 09:36:00,174 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_4/state_dict.pt
2025-09-09 09:36:00,187 [INFO] Layer 4 - Test Acc: 0.9633 | F1(C0,C1,C2): 0.951, 0.943, 0.995
2025-09-09 09:36:00,187 [INFO] --- Processing Layer 5 ---
2025-09-09 09:36:00,454 [INFO] Layer 5 - Training completed.
2025-09-09 09:36:00,455 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_5/state_dict.pt
2025-09-09 09:36:00,469 [INFO] Layer 5 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:36:00,470 [INFO] --- Processing Layer 6 ---
2025-09-09 09:36:00,739 [INFO] Layer 6 - Training completed.
2025-09-09 09:36:00,740 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_6/state_dict.pt
2025-09-09 09:36:00,754 [INFO] Layer 6 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:36:00,754 [INFO] --- Processing Layer 7 ---
2025-09-09 09:36:01,021 [INFO] Layer 7 - Training completed.
2025-09-09 09:36:01,022 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_7/state_dict.pt
2025-09-09 09:36:01,035 [INFO] Layer 7 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:36:01,036 [INFO] --- Processing Layer 8 ---
2025-09-09 09:36:01,301 [INFO] Layer 8 - Training completed.
2025-09-09 09:36:01,302 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_8/state_dict.pt
2025-09-09 09:36:01,316 [INFO] Layer 8 - Test Acc: 0.9733 | F1(C0,C1,C2): 0.958, 0.962, 1.000
2025-09-09 09:36:01,316 [INFO] --- Processing Layer 9 ---
2025-09-09 09:36:01,593 [INFO] Layer 9 - Training completed.
2025-09-09 09:36:01,594 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_9/state_dict.pt
2025-09-09 09:36:01,607 [INFO] Layer 9 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:01,607 [INFO] --- Processing Layer 10 ---
2025-09-09 09:36:01,885 [INFO] Layer 10 - Training completed.
2025-09-09 09:36:01,886 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_10/state_dict.pt
2025-09-09 09:36:01,900 [INFO] Layer 10 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:01,900 [INFO] --- Processing Layer 11 ---
2025-09-09 09:36:02,168 [INFO] Layer 11 - Training completed.
2025-09-09 09:36:02,169 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_11/state_dict.pt
2025-09-09 09:36:02,183 [INFO] Layer 11 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:02,183 [INFO] --- Processing Layer 12 ---
2025-09-09 09:36:02,451 [INFO] Layer 12 - Training completed.
2025-09-09 09:36:02,452 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_12/state_dict.pt
2025-09-09 09:36:02,466 [INFO] Layer 12 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:02,466 [INFO] --- Processing Layer 13 ---
2025-09-09 09:36:02,740 [INFO] Layer 13 - Training completed.
2025-09-09 09:36:02,741 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_13/state_dict.pt
2025-09-09 09:36:02,755 [INFO] Layer 13 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:02,755 [INFO] --- Processing Layer 14 ---
2025-09-09 09:36:03,020 [INFO] Layer 14 - Training completed.
2025-09-09 09:36:03,021 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_14/state_dict.pt
2025-09-09 09:36:03,035 [INFO] Layer 14 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:03,035 [INFO] --- Processing Layer 15 ---
2025-09-09 09:36:03,297 [INFO] Layer 15 - Training completed.
2025-09-09 09:36:03,298 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_15/state_dict.pt
2025-09-09 09:36:03,312 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:03,312 [INFO] --- Processing Layer 16 ---
2025-09-09 09:36:03,577 [INFO] Layer 16 - Training completed.
2025-09-09 09:36:03,578 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_16/state_dict.pt
2025-09-09 09:36:03,591 [INFO] Layer 16 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:03,591 [INFO] --- Processing Layer 17 ---
2025-09-09 09:36:03,854 [INFO] Layer 17 - Training completed.
2025-09-09 09:36:03,855 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_17/state_dict.pt
2025-09-09 09:36:03,869 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:03,870 [INFO] --- Processing Layer 18 ---
2025-09-09 09:36:04,131 [INFO] Layer 18 - Training completed.
2025-09-09 09:36:04,133 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_18/state_dict.pt
2025-09-09 09:36:04,146 [INFO] Layer 18 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:04,146 [INFO] --- Processing Layer 19 ---
2025-09-09 09:36:04,416 [INFO] Layer 19 - Training completed.
2025-09-09 09:36:04,417 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_19/state_dict.pt
2025-09-09 09:36:04,431 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:04,431 [INFO] --- Processing Layer 20 ---
2025-09-09 09:36:04,696 [INFO] Layer 20 - Training completed.
2025-09-09 09:36:04,697 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_20/state_dict.pt
2025-09-09 09:36:04,711 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:04,711 [INFO] --- Processing Layer 21 ---
2025-09-09 09:36:04,980 [INFO] Layer 21 - Training completed.
2025-09-09 09:36:04,981 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_21/state_dict.pt
2025-09-09 09:36:04,997 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:04,997 [INFO] --- Processing Layer 22 ---
2025-09-09 09:36:05,263 [INFO] Layer 22 - Training completed.
2025-09-09 09:36:05,265 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_22/state_dict.pt
2025-09-09 09:36:05,279 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:05,280 [INFO] --- Processing Layer 23 ---
2025-09-09 09:36:05,541 [INFO] Layer 23 - Training completed.
2025-09-09 09:36:05,542 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_23/state_dict.pt
2025-09-09 09:36:05,556 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:05,557 [INFO] --- Processing Layer 24 ---
2025-09-09 09:36:05,817 [INFO] Layer 24 - Training completed.
2025-09-09 09:36:05,818 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_24/state_dict.pt
2025-09-09 09:36:05,832 [INFO] Layer 24 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:05,832 [INFO] --- Processing Layer 25 ---
2025-09-09 09:36:06,099 [INFO] Layer 25 - Training completed.
2025-09-09 09:36:06,100 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_25/state_dict.pt
2025-09-09 09:36:06,113 [INFO] Layer 25 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:06,114 [INFO] --- Processing Layer 26 ---
2025-09-09 09:36:06,379 [INFO] Layer 26 - Training completed.
2025-09-09 09:36:06,381 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_26/state_dict.pt
2025-09-09 09:36:06,394 [INFO] Layer 26 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:06,395 [INFO] --- Processing Layer 27 ---
2025-09-09 09:36:06,666 [INFO] Layer 27 - Training completed.
2025-09-09 09:36:06,667 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_27/state_dict.pt
2025-09-09 09:36:06,681 [INFO] Layer 27 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:06,681 [INFO] --- Processing Layer 28 ---
2025-09-09 09:36:06,947 [INFO] Layer 28 - Training completed.
2025-09-09 09:36:06,948 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_45/layer_28/state_dict.pt
2025-09-09 09:36:06,961 [INFO] Layer 28 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:06,962 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:36:06,962 [INFO] --- Generating OOD Datasets for Run 4 ---
2025-09-09 09:36:06,968 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:36:06,970 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:36:07,009 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:36:11,006 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:36:11,009 [INFO] [OOD 1d] Layer 1: acc=0.3233
2025-09-09 09:36:11,010 [INFO] [OOD 1d] Layer 2: acc=0.4100
2025-09-09 09:36:11,012 [INFO] [OOD 1d] Layer 3: acc=0.3500
2025-09-09 09:36:11,014 [INFO] [OOD 1d] Layer 4: acc=0.3800
2025-09-09 09:36:11,015 [INFO] [OOD 1d] Layer 5: acc=0.9333
2025-09-09 09:36:11,017 [INFO] [OOD 1d] Layer 6: acc=0.7667
2025-09-09 09:36:11,018 [INFO] [OOD 1d] Layer 7: acc=0.7233
2025-09-09 09:36:11,020 [INFO] [OOD 1d] Layer 8: acc=0.8533
2025-09-09 09:36:11,022 [INFO] [OOD 1d] Layer 9: acc=0.7633
2025-09-09 09:36:11,023 [INFO] [OOD 1d] Layer 10: acc=0.6800
2025-09-09 09:36:11,025 [INFO] [OOD 1d] Layer 11: acc=0.6733
2025-09-09 09:36:11,026 [INFO] [OOD 1d] Layer 12: acc=0.6967
2025-09-09 09:36:11,028 [INFO] [OOD 1d] Layer 13: acc=0.9133
2025-09-09 09:36:11,029 [INFO] [OOD 1d] Layer 14: acc=0.8100
2025-09-09 09:36:11,031 [INFO] [OOD 1d] Layer 15: acc=0.9067
2025-09-09 09:36:11,033 [INFO] [OOD 1d] Layer 16: acc=0.8667
2025-09-09 09:36:11,034 [INFO] [OOD 1d] Layer 17: acc=0.8600
2025-09-09 09:36:11,036 [INFO] [OOD 1d] Layer 18: acc=0.8500
2025-09-09 09:36:11,037 [INFO] [OOD 1d] Layer 19: acc=0.9733
2025-09-09 09:36:11,039 [INFO] [OOD 1d] Layer 20: acc=1.0000
2025-09-09 09:36:11,041 [INFO] [OOD 1d] Layer 21: acc=1.0000
2025-09-09 09:36:11,042 [INFO] [OOD 1d] Layer 22: acc=0.9800
2025-09-09 09:36:11,043 [INFO] [OOD 1d] Layer 23: acc=1.0000
2025-09-09 09:36:11,045 [INFO] [OOD 1d] Layer 24: acc=1.0000
2025-09-09 09:36:11,047 [INFO] [OOD 1d] Layer 25: acc=1.0000
2025-09-09 09:36:11,048 [INFO] [OOD 1d] Layer 26: acc=0.9833
2025-09-09 09:36:11,050 [INFO] [OOD 1d] Layer 27: acc=1.0000
2025-09-09 09:36:11,051 [INFO] [OOD 1d] Layer 28: acc=0.9667
2025-09-09 09:36:11,051 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:36:14,292 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:36:14,294 [INFO] [OOD 2d] Layer 1: acc=0.5000
2025-09-09 09:36:14,295 [INFO] [OOD 2d] Layer 2: acc=0.7500
2025-09-09 09:36:14,297 [INFO] [OOD 2d] Layer 3: acc=0.9350
2025-09-09 09:36:14,298 [INFO] [OOD 2d] Layer 4: acc=0.9050
2025-09-09 09:36:14,299 [INFO] [OOD 2d] Layer 5: acc=0.9800
2025-09-09 09:36:14,300 [INFO] [OOD 2d] Layer 6: acc=0.9850
2025-09-09 09:36:14,301 [INFO] [OOD 2d] Layer 7: acc=0.9900
2025-09-09 09:36:14,302 [INFO] [OOD 2d] Layer 8: acc=0.9600
2025-09-09 09:36:14,303 [INFO] [OOD 2d] Layer 9: acc=1.0000
2025-09-09 09:36:14,305 [INFO] [OOD 2d] Layer 10: acc=1.0000
2025-09-09 09:36:14,306 [INFO] [OOD 2d] Layer 11: acc=1.0000
2025-09-09 09:36:14,307 [INFO] [OOD 2d] Layer 12: acc=1.0000
2025-09-09 09:36:14,308 [INFO] [OOD 2d] Layer 13: acc=1.0000
2025-09-09 09:36:14,309 [INFO] [OOD 2d] Layer 14: acc=0.9950
2025-09-09 09:36:14,310 [INFO] [OOD 2d] Layer 15: acc=0.9950
2025-09-09 09:36:14,311 [INFO] [OOD 2d] Layer 16: acc=0.9950
2025-09-09 09:36:14,313 [INFO] [OOD 2d] Layer 17: acc=1.0000
2025-09-09 09:36:14,314 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:36:14,315 [INFO] [OOD 2d] Layer 19: acc=1.0000
2025-09-09 09:36:14,316 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:36:14,317 [INFO] [OOD 2d] Layer 21: acc=1.0000
2025-09-09 09:36:14,319 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:36:14,320 [INFO] [OOD 2d] Layer 23: acc=1.0000
2025-09-09 09:36:14,321 [INFO] [OOD 2d] Layer 24: acc=1.0000
2025-09-09 09:36:14,322 [INFO] [OOD 2d] Layer 25: acc=0.9950
2025-09-09 09:36:14,323 [INFO] [OOD 2d] Layer 26: acc=0.9950
2025-09-09 09:36:14,325 [INFO] [OOD 2d] Layer 27: acc=1.0000
2025-09-09 09:36:14,326 [INFO] [OOD 2d] Layer 28: acc=0.9950
2025-09-09 09:36:14,326 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:36:20,133 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:36:20,135 [INFO] [OOD 3d] Layer 1: acc=0.3467
2025-09-09 09:36:20,137 [INFO] [OOD 3d] Layer 2: acc=0.4067
2025-09-09 09:36:20,139 [INFO] [OOD 3d] Layer 3: acc=0.5167
2025-09-09 09:36:20,141 [INFO] [OOD 3d] Layer 4: acc=0.7633
2025-09-09 09:36:20,142 [INFO] [OOD 3d] Layer 5: acc=0.7467
2025-09-09 09:36:20,144 [INFO] [OOD 3d] Layer 6: acc=0.7100
2025-09-09 09:36:20,145 [INFO] [OOD 3d] Layer 7: acc=0.8267
2025-09-09 09:36:20,147 [INFO] [OOD 3d] Layer 8: acc=0.9200
2025-09-09 09:36:20,148 [INFO] [OOD 3d] Layer 9: acc=0.9433
2025-09-09 09:36:20,150 [INFO] [OOD 3d] Layer 10: acc=0.9767
2025-09-09 09:36:20,151 [INFO] [OOD 3d] Layer 11: acc=0.9733
2025-09-09 09:36:20,153 [INFO] [OOD 3d] Layer 12: acc=0.9667
2025-09-09 09:36:20,154 [INFO] [OOD 3d] Layer 13: acc=0.9700
2025-09-09 09:36:20,156 [INFO] [OOD 3d] Layer 14: acc=0.9667
2025-09-09 09:36:20,157 [INFO] [OOD 3d] Layer 15: acc=0.9700
2025-09-09 09:36:20,159 [INFO] [OOD 3d] Layer 16: acc=0.9500
2025-09-09 09:36:20,160 [INFO] [OOD 3d] Layer 17: acc=0.9167
2025-09-09 09:36:20,162 [INFO] [OOD 3d] Layer 18: acc=0.9433
2025-09-09 09:36:20,163 [INFO] [OOD 3d] Layer 19: acc=0.9967
2025-09-09 09:36:20,165 [INFO] [OOD 3d] Layer 20: acc=0.9867
2025-09-09 09:36:20,166 [INFO] [OOD 3d] Layer 21: acc=0.9900
2025-09-09 09:36:20,168 [INFO] [OOD 3d] Layer 22: acc=0.9900
2025-09-09 09:36:20,170 [INFO] [OOD 3d] Layer 23: acc=0.9900
2025-09-09 09:36:20,171 [INFO] [OOD 3d] Layer 24: acc=0.9900
2025-09-09 09:36:20,173 [INFO] [OOD 3d] Layer 25: acc=0.9900
2025-09-09 09:36:20,174 [INFO] [OOD 3d] Layer 26: acc=0.9833
2025-09-09 09:36:20,176 [INFO] [OOD 3d] Layer 27: acc=0.9867
2025-09-09 09:36:20,177 [INFO] [OOD 3d] Layer 28: acc=0.9867
2025-09-09 09:36:20,177 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:36:26,591 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:36:26,594 [INFO] [OOD 4d] Layer 1: acc=0.3333
2025-09-09 09:36:26,596 [INFO] [OOD 4d] Layer 2: acc=0.4233
2025-09-09 09:36:26,598 [INFO] [OOD 4d] Layer 3: acc=0.4933
2025-09-09 09:36:26,599 [INFO] [OOD 4d] Layer 4: acc=0.8100
2025-09-09 09:36:26,601 [INFO] [OOD 4d] Layer 5: acc=0.7433
2025-09-09 09:36:26,602 [INFO] [OOD 4d] Layer 6: acc=0.7100
2025-09-09 09:36:26,604 [INFO] [OOD 4d] Layer 7: acc=0.8600
2025-09-09 09:36:26,606 [INFO] [OOD 4d] Layer 8: acc=0.7567
2025-09-09 09:36:26,607 [INFO] [OOD 4d] Layer 9: acc=0.8533
2025-09-09 09:36:26,609 [INFO] [OOD 4d] Layer 10: acc=0.6667
2025-09-09 09:36:26,610 [INFO] [OOD 4d] Layer 11: acc=0.7567
2025-09-09 09:36:26,612 [INFO] [OOD 4d] Layer 12: acc=0.6867
2025-09-09 09:36:26,614 [INFO] [OOD 4d] Layer 13: acc=0.6933
2025-09-09 09:36:26,615 [INFO] [OOD 4d] Layer 14: acc=0.6667
2025-09-09 09:36:26,617 [INFO] [OOD 4d] Layer 15: acc=0.7233
2025-09-09 09:36:26,618 [INFO] [OOD 4d] Layer 16: acc=0.6667
2025-09-09 09:36:26,620 [INFO] [OOD 4d] Layer 17: acc=0.6667
2025-09-09 09:36:26,621 [INFO] [OOD 4d] Layer 18: acc=0.7033
2025-09-09 09:36:26,623 [INFO] [OOD 4d] Layer 19: acc=0.9633
2025-09-09 09:36:26,624 [INFO] [OOD 4d] Layer 20: acc=0.9967
2025-09-09 09:36:26,626 [INFO] [OOD 4d] Layer 21: acc=1.0000
2025-09-09 09:36:26,627 [INFO] [OOD 4d] Layer 22: acc=0.9967
2025-09-09 09:36:26,629 [INFO] [OOD 4d] Layer 23: acc=1.0000
2025-09-09 09:36:26,630 [INFO] [OOD 4d] Layer 24: acc=0.9967
2025-09-09 09:36:26,632 [INFO] [OOD 4d] Layer 25: acc=0.9933
2025-09-09 09:36:26,633 [INFO] [OOD 4d] Layer 26: acc=0.9967
2025-09-09 09:36:26,635 [INFO] [OOD 4d] Layer 27: acc=0.9967
2025-09-09 09:36:26,636 [INFO] [OOD 4d] Layer 28: acc=0.9833
2025-09-09 09:36:26,637 [INFO] ==================== RUN 5/5 (Seed: 46) ====================
2025-09-09 09:36:26,638 [INFO] Using device: cuda:0
2025-09-09 09:36:26,641 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:36:26,641 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:36:26,644 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:36:26,645 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:36:26,645 [INFO] [TRAIN_COMM_3WAY_Run5] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:36:50,283 [INFO] [TRAIN_COMM_3WAY_Run5] Finished extracting activations.
2025-09-09 09:36:50,311 [INFO] Per-layer classification reports -> ./outputs/AceMath/run_seed_46/probe_3way_comm_AceMath_seed_46_20250909_093650.txt
2025-09-09 09:36:50,311 [INFO] --- Starting Probe Training Loop for layers 1..28 ---
2025-09-09 09:36:50,312 [INFO] --- Processing Layer 1 ---
2025-09-09 09:36:50,579 [INFO] Layer 1 - Training completed.
2025-09-09 09:36:50,581 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_1/state_dict.pt
2025-09-09 09:36:50,595 [INFO] Layer 1 - Test Acc: 0.3900 | F1(C0,C1,C2): 0.503, 0.076, 0.357
2025-09-09 09:36:50,595 [INFO] --- Processing Layer 2 ---
2025-09-09 09:36:50,858 [INFO] Layer 2 - Training completed.
2025-09-09 09:36:50,859 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_2/state_dict.pt
2025-09-09 09:36:50,873 [INFO] Layer 2 - Test Acc: 0.6133 | F1(C0,C1,C2): 0.617, 0.681, 0.506
2025-09-09 09:36:50,873 [INFO] --- Processing Layer 3 ---
2025-09-09 09:36:51,132 [INFO] Layer 3 - Training completed.
2025-09-09 09:36:51,133 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_3/state_dict.pt
2025-09-09 09:36:51,147 [INFO] Layer 3 - Test Acc: 0.5700 | F1(C0,C1,C2): 0.305, 0.719, 0.579
2025-09-09 09:36:51,147 [INFO] --- Processing Layer 4 ---
2025-09-09 09:36:51,413 [INFO] Layer 4 - Training completed.
2025-09-09 09:36:51,414 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_4/state_dict.pt
2025-09-09 09:36:51,427 [INFO] Layer 4 - Test Acc: 0.9533 | F1(C0,C1,C2): 0.926, 0.947, 0.985
2025-09-09 09:36:51,428 [INFO] --- Processing Layer 5 ---
2025-09-09 09:36:51,697 [INFO] Layer 5 - Training completed.
2025-09-09 09:36:51,698 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_5/state_dict.pt
2025-09-09 09:36:51,711 [INFO] Layer 5 - Test Acc: 0.9733 | F1(C0,C1,C2): 0.961, 0.964, 0.995
2025-09-09 09:36:51,711 [INFO] --- Processing Layer 6 ---
2025-09-09 09:36:51,982 [INFO] Layer 6 - Training completed.
2025-09-09 09:36:51,983 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_6/state_dict.pt
2025-09-09 09:36:51,997 [INFO] Layer 6 - Test Acc: 0.9567 | F1(C0,C1,C2): 0.930, 0.943, 0.995
2025-09-09 09:36:51,997 [INFO] --- Processing Layer 7 ---
2025-09-09 09:36:52,263 [INFO] Layer 7 - Training completed.
2025-09-09 09:36:52,264 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_7/state_dict.pt
2025-09-09 09:36:52,278 [INFO] Layer 7 - Test Acc: 0.9367 | F1(C0,C1,C2): 0.895, 0.917, 0.995
2025-09-09 09:36:52,278 [INFO] --- Processing Layer 8 ---
2025-09-09 09:36:52,541 [INFO] Layer 8 - Training completed.
2025-09-09 09:36:52,542 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_8/state_dict.pt
2025-09-09 09:36:52,556 [INFO] Layer 8 - Test Acc: 0.9400 | F1(C0,C1,C2): 0.901, 0.917, 1.000
2025-09-09 09:36:52,556 [INFO] --- Processing Layer 9 ---
2025-09-09 09:36:52,822 [INFO] Layer 9 - Training completed.
2025-09-09 09:36:52,824 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_9/state_dict.pt
2025-09-09 09:36:52,838 [INFO] Layer 9 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.990, 0.995
2025-09-09 09:36:52,838 [INFO] --- Processing Layer 10 ---
2025-09-09 09:36:53,107 [INFO] Layer 10 - Training completed.
2025-09-09 09:36:53,109 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_10/state_dict.pt
2025-09-09 09:36:53,123 [INFO] Layer 10 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:53,123 [INFO] --- Processing Layer 11 ---
2025-09-09 09:36:53,401 [INFO] Layer 11 - Training completed.
2025-09-09 09:36:53,402 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_11/state_dict.pt
2025-09-09 09:36:53,416 [INFO] Layer 11 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:53,417 [INFO] --- Processing Layer 12 ---
2025-09-09 09:36:53,683 [INFO] Layer 12 - Training completed.
2025-09-09 09:36:53,685 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_12/state_dict.pt
2025-09-09 09:36:53,698 [INFO] Layer 12 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:53,698 [INFO] --- Processing Layer 13 ---
2025-09-09 09:36:53,961 [INFO] Layer 13 - Training completed.
2025-09-09 09:36:53,962 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_13/state_dict.pt
2025-09-09 09:36:53,977 [INFO] Layer 13 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:53,977 [INFO] --- Processing Layer 14 ---
2025-09-09 09:36:54,246 [INFO] Layer 14 - Training completed.
2025-09-09 09:36:54,247 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_14/state_dict.pt
2025-09-09 09:36:54,261 [INFO] Layer 14 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:54,261 [INFO] --- Processing Layer 15 ---
2025-09-09 09:36:54,526 [INFO] Layer 15 - Training completed.
2025-09-09 09:36:54,527 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_15/state_dict.pt
2025-09-09 09:36:54,541 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:54,541 [INFO] --- Processing Layer 16 ---
2025-09-09 09:36:54,850 [INFO] Layer 16 - Training completed.
2025-09-09 09:36:54,851 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_16/state_dict.pt
2025-09-09 09:36:54,866 [INFO] Layer 16 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:54,867 [INFO] --- Processing Layer 17 ---
2025-09-09 09:36:55,135 [INFO] Layer 17 - Training completed.
2025-09-09 09:36:55,137 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_17/state_dict.pt
2025-09-09 09:36:55,150 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:55,151 [INFO] --- Processing Layer 18 ---
2025-09-09 09:36:55,415 [INFO] Layer 18 - Training completed.
2025-09-09 09:36:55,417 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_18/state_dict.pt
2025-09-09 09:36:55,430 [INFO] Layer 18 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:55,430 [INFO] --- Processing Layer 19 ---
2025-09-09 09:36:55,695 [INFO] Layer 19 - Training completed.
2025-09-09 09:36:55,696 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_19/state_dict.pt
2025-09-09 09:36:55,710 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:55,710 [INFO] --- Processing Layer 20 ---
2025-09-09 09:36:55,973 [INFO] Layer 20 - Training completed.
2025-09-09 09:36:55,974 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_20/state_dict.pt
2025-09-09 09:36:55,987 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:55,988 [INFO] --- Processing Layer 21 ---
2025-09-09 09:36:56,258 [INFO] Layer 21 - Training completed.
2025-09-09 09:36:56,259 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_21/state_dict.pt
2025-09-09 09:36:56,273 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:56,273 [INFO] --- Processing Layer 22 ---
2025-09-09 09:36:56,537 [INFO] Layer 22 - Training completed.
2025-09-09 09:36:56,538 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_22/state_dict.pt
2025-09-09 09:36:56,551 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:56,551 [INFO] --- Processing Layer 23 ---
2025-09-09 09:36:56,817 [INFO] Layer 23 - Training completed.
2025-09-09 09:36:56,818 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_23/state_dict.pt
2025-09-09 09:36:56,831 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:56,831 [INFO] --- Processing Layer 24 ---
2025-09-09 09:36:57,101 [INFO] Layer 24 - Training completed.
2025-09-09 09:36:57,102 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_24/state_dict.pt
2025-09-09 09:36:57,116 [INFO] Layer 24 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:57,116 [INFO] --- Processing Layer 25 ---
2025-09-09 09:36:57,380 [INFO] Layer 25 - Training completed.
2025-09-09 09:36:57,381 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_25/state_dict.pt
2025-09-09 09:36:57,395 [INFO] Layer 25 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:57,395 [INFO] --- Processing Layer 26 ---
2025-09-09 09:36:57,658 [INFO] Layer 26 - Training completed.
2025-09-09 09:36:57,659 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_26/state_dict.pt
2025-09-09 09:36:57,673 [INFO] Layer 26 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:57,673 [INFO] --- Processing Layer 27 ---
2025-09-09 09:36:57,939 [INFO] Layer 27 - Training completed.
2025-09-09 09:36:57,940 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_27/state_dict.pt
2025-09-09 09:36:57,953 [INFO] Layer 27 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:57,954 [INFO] --- Processing Layer 28 ---
2025-09-09 09:36:58,222 [INFO] Layer 28 - Training completed.
2025-09-09 09:36:58,223 [INFO] Saved probe state_dict -> ./outputs/AceMath/run_seed_46/layer_28/state_dict.pt
2025-09-09 09:36:58,237 [INFO] Layer 28 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:36:58,238 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:36:58,238 [INFO] --- Generating OOD Datasets for Run 5 ---
2025-09-09 09:36:58,243 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:36:58,245 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:36:58,281 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:37:02,345 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:37:02,347 [INFO] [OOD 1d] Layer 1: acc=0.3233
2025-09-09 09:37:02,349 [INFO] [OOD 1d] Layer 2: acc=0.4767
2025-09-09 09:37:02,350 [INFO] [OOD 1d] Layer 3: acc=0.3767
2025-09-09 09:37:02,352 [INFO] [OOD 1d] Layer 4: acc=0.3333
2025-09-09 09:37:02,353 [INFO] [OOD 1d] Layer 5: acc=0.8333
2025-09-09 09:37:02,355 [INFO] [OOD 1d] Layer 6: acc=0.7300
2025-09-09 09:37:02,356 [INFO] [OOD 1d] Layer 7: acc=0.7367
2025-09-09 09:37:02,358 [INFO] [OOD 1d] Layer 8: acc=0.8300
2025-09-09 09:37:02,359 [INFO] [OOD 1d] Layer 9: acc=0.7267
2025-09-09 09:37:02,361 [INFO] [OOD 1d] Layer 10: acc=0.7000
2025-09-09 09:37:02,362 [INFO] [OOD 1d] Layer 11: acc=0.7133
2025-09-09 09:37:02,364 [INFO] [OOD 1d] Layer 12: acc=0.6933
2025-09-09 09:37:02,365 [INFO] [OOD 1d] Layer 13: acc=0.8767
2025-09-09 09:37:02,367 [INFO] [OOD 1d] Layer 14: acc=0.7000
2025-09-09 09:37:02,369 [INFO] [OOD 1d] Layer 15: acc=0.8600
2025-09-09 09:37:02,370 [INFO] [OOD 1d] Layer 16: acc=0.8167
2025-09-09 09:37:02,371 [INFO] [OOD 1d] Layer 17: acc=0.8900
2025-09-09 09:37:02,373 [INFO] [OOD 1d] Layer 18: acc=0.8733
2025-09-09 09:37:02,375 [INFO] [OOD 1d] Layer 19: acc=0.9733
2025-09-09 09:37:02,376 [INFO] [OOD 1d] Layer 20: acc=1.0000
2025-09-09 09:37:02,378 [INFO] [OOD 1d] Layer 21: acc=1.0000
2025-09-09 09:37:02,379 [INFO] [OOD 1d] Layer 22: acc=0.9967
2025-09-09 09:37:02,381 [INFO] [OOD 1d] Layer 23: acc=1.0000
2025-09-09 09:37:02,382 [INFO] [OOD 1d] Layer 24: acc=1.0000
2025-09-09 09:37:02,384 [INFO] [OOD 1d] Layer 25: acc=0.9700
2025-09-09 09:37:02,385 [INFO] [OOD 1d] Layer 26: acc=0.9933
2025-09-09 09:37:02,387 [INFO] [OOD 1d] Layer 27: acc=1.0000
2025-09-09 09:37:02,388 [INFO] [OOD 1d] Layer 28: acc=1.0000
2025-09-09 09:37:02,388 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:37:05,659 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:37:05,661 [INFO] [OOD 2d] Layer 1: acc=0.4250
2025-09-09 09:37:05,662 [INFO] [OOD 2d] Layer 2: acc=0.7050
2025-09-09 09:37:05,663 [INFO] [OOD 2d] Layer 3: acc=0.3950
2025-09-09 09:37:05,664 [INFO] [OOD 2d] Layer 4: acc=0.9050
2025-09-09 09:37:05,665 [INFO] [OOD 2d] Layer 5: acc=0.9650
2025-09-09 09:37:05,666 [INFO] [OOD 2d] Layer 6: acc=0.9450
2025-09-09 09:37:05,668 [INFO] [OOD 2d] Layer 7: acc=0.9350
2025-09-09 09:37:05,669 [INFO] [OOD 2d] Layer 8: acc=0.9250
2025-09-09 09:37:05,670 [INFO] [OOD 2d] Layer 9: acc=0.9850
2025-09-09 09:37:05,671 [INFO] [OOD 2d] Layer 10: acc=0.9950
2025-09-09 09:37:05,672 [INFO] [OOD 2d] Layer 11: acc=1.0000
2025-09-09 09:37:05,673 [INFO] [OOD 2d] Layer 12: acc=1.0000
2025-09-09 09:37:05,675 [INFO] [OOD 2d] Layer 13: acc=1.0000
2025-09-09 09:37:05,676 [INFO] [OOD 2d] Layer 14: acc=1.0000
2025-09-09 09:37:05,677 [INFO] [OOD 2d] Layer 15: acc=1.0000
2025-09-09 09:37:05,678 [INFO] [OOD 2d] Layer 16: acc=0.9950
2025-09-09 09:37:05,679 [INFO] [OOD 2d] Layer 17: acc=1.0000
2025-09-09 09:37:05,680 [INFO] [OOD 2d] Layer 18: acc=0.9950
2025-09-09 09:37:05,682 [INFO] [OOD 2d] Layer 19: acc=1.0000
2025-09-09 09:37:05,683 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:37:05,684 [INFO] [OOD 2d] Layer 21: acc=1.0000
2025-09-09 09:37:05,685 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:37:05,686 [INFO] [OOD 2d] Layer 23: acc=1.0000
2025-09-09 09:37:05,687 [INFO] [OOD 2d] Layer 24: acc=0.9950
2025-09-09 09:37:05,688 [INFO] [OOD 2d] Layer 25: acc=1.0000
2025-09-09 09:37:05,690 [INFO] [OOD 2d] Layer 26: acc=0.9850
2025-09-09 09:37:05,691 [INFO] [OOD 2d] Layer 27: acc=1.0000
2025-09-09 09:37:05,692 [INFO] [OOD 2d] Layer 28: acc=1.0000
2025-09-09 09:37:05,692 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:37:11,499 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:37:11,502 [INFO] [OOD 3d] Layer 1: acc=0.3367
2025-09-09 09:37:11,503 [INFO] [OOD 3d] Layer 2: acc=0.4267
2025-09-09 09:37:11,505 [INFO] [OOD 3d] Layer 3: acc=0.4533
2025-09-09 09:37:11,506 [INFO] [OOD 3d] Layer 4: acc=0.7800
2025-09-09 09:37:11,508 [INFO] [OOD 3d] Layer 5: acc=0.7233
2025-09-09 09:37:11,509 [INFO] [OOD 3d] Layer 6: acc=0.7667
2025-09-09 09:37:11,511 [INFO] [OOD 3d] Layer 7: acc=0.9300
2025-09-09 09:37:11,512 [INFO] [OOD 3d] Layer 8: acc=0.9367
2025-09-09 09:37:11,514 [INFO] [OOD 3d] Layer 9: acc=0.9500
2025-09-09 09:37:11,515 [INFO] [OOD 3d] Layer 10: acc=0.9667
2025-09-09 09:37:11,517 [INFO] [OOD 3d] Layer 11: acc=0.9567
2025-09-09 09:37:11,518 [INFO] [OOD 3d] Layer 12: acc=0.9533
2025-09-09 09:37:11,520 [INFO] [OOD 3d] Layer 13: acc=0.9767
2025-09-09 09:37:11,521 [INFO] [OOD 3d] Layer 14: acc=0.9733
2025-09-09 09:37:11,523 [INFO] [OOD 3d] Layer 15: acc=0.9767
2025-09-09 09:37:11,524 [INFO] [OOD 3d] Layer 16: acc=0.9733
2025-09-09 09:37:11,526 [INFO] [OOD 3d] Layer 17: acc=0.9767
2025-09-09 09:37:11,527 [INFO] [OOD 3d] Layer 18: acc=0.9800
2025-09-09 09:37:11,529 [INFO] [OOD 3d] Layer 19: acc=0.9900
2025-09-09 09:37:11,530 [INFO] [OOD 3d] Layer 20: acc=0.9933
2025-09-09 09:37:11,532 [INFO] [OOD 3d] Layer 21: acc=0.9933
2025-09-09 09:37:11,533 [INFO] [OOD 3d] Layer 22: acc=0.9967
2025-09-09 09:37:11,535 [INFO] [OOD 3d] Layer 23: acc=0.9967
2025-09-09 09:37:11,536 [INFO] [OOD 3d] Layer 24: acc=0.9900
2025-09-09 09:37:11,538 [INFO] [OOD 3d] Layer 25: acc=0.9900
2025-09-09 09:37:11,539 [INFO] [OOD 3d] Layer 26: acc=0.9867
2025-09-09 09:37:11,541 [INFO] [OOD 3d] Layer 27: acc=0.9900
2025-09-09 09:37:11,542 [INFO] [OOD 3d] Layer 28: acc=0.9900
2025-09-09 09:37:11,543 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]
2025-09-09 09:37:17,949 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:37:17,952 [INFO] [OOD 4d] Layer 1: acc=0.3333
2025-09-09 09:37:17,954 [INFO] [OOD 4d] Layer 2: acc=0.3567
2025-09-09 09:37:17,955 [INFO] [OOD 4d] Layer 3: acc=0.4267
2025-09-09 09:37:17,957 [INFO] [OOD 4d] Layer 4: acc=0.7733
2025-09-09 09:37:17,959 [INFO] [OOD 4d] Layer 5: acc=0.6733
2025-09-09 09:37:17,960 [INFO] [OOD 4d] Layer 6: acc=0.7300
2025-09-09 09:37:17,962 [INFO] [OOD 4d] Layer 7: acc=0.7500
2025-09-09 09:37:17,963 [INFO] [OOD 4d] Layer 8: acc=0.7233
2025-09-09 09:37:17,965 [INFO] [OOD 4d] Layer 9: acc=0.8033
2025-09-09 09:37:17,966 [INFO] [OOD 4d] Layer 10: acc=0.6900
2025-09-09 09:37:17,968 [INFO] [OOD 4d] Layer 11: acc=0.7933
2025-09-09 09:37:17,969 [INFO] [OOD 4d] Layer 12: acc=0.7700
2025-09-09 09:37:17,971 [INFO] [OOD 4d] Layer 13: acc=0.7033
2025-09-09 09:37:17,973 [INFO] [OOD 4d] Layer 14: acc=0.6967
2025-09-09 09:37:17,974 [INFO] [OOD 4d] Layer 15: acc=0.6867
2025-09-09 09:37:17,976 [INFO] [OOD 4d] Layer 16: acc=0.7333
2025-09-09 09:37:17,977 [INFO] [OOD 4d] Layer 17: acc=0.6700
2025-09-09 09:37:17,979 [INFO] [OOD 4d] Layer 18: acc=0.7100
2025-09-09 09:37:17,980 [INFO] [OOD 4d] Layer 19: acc=0.9933
2025-09-09 09:37:17,982 [INFO] [OOD 4d] Layer 20: acc=0.9933
2025-09-09 09:37:17,983 [INFO] [OOD 4d] Layer 21: acc=1.0000
2025-09-09 09:37:17,985 [INFO] [OOD 4d] Layer 22: acc=1.0000
2025-09-09 09:37:17,987 [INFO] [OOD 4d] Layer 23: acc=0.9933
2025-09-09 09:37:17,988 [INFO] [OOD 4d] Layer 24: acc=0.9967
2025-09-09 09:37:17,990 [INFO] [OOD 4d] Layer 25: acc=0.9933
2025-09-09 09:37:17,991 [INFO] [OOD 4d] Layer 26: acc=0.9800
2025-09-09 09:37:17,993 [INFO] [OOD 4d] Layer 27: acc=0.9933
2025-09-09 09:37:17,994 [INFO] [OOD 4d] Layer 28: acc=0.9933
2025-09-09 09:37:17,995 [INFO] --- Generating Final Aggregated Plots (with CI) ---
2025-09-09 09:37:18,726 [INFO] Saved aggregated per-layer line chart (PDF) -> ./outputs/AceMath/AGG_probe_comm_generalisation_line_AceMath_20250909_093717.pdf
2025-09-09 09:37:18,933 [INFO] Saved aggregated mean-accuracy bar chart (PDF) -> ./outputs/AceMath/AGG_probe_comm_generalisation_bar_AceMath_20250909_093717.pdf
2025-09-09 09:37:18,933 [INFO] --- All Runs and Aggregated Plotting Finished (this model) ---
2025-09-09 09:37:18,933 [INFO] Unified output dir (this model): ./outputs/AceMath
