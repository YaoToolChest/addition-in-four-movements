2025-09-09 09:37:19,074 [INFO] ======= Logger initialized =======
2025-09-09 09:37:19,075 [INFO] Log file: ./outputs/Mistral/run_20250909_093719.log
2025-09-09 09:37:19,076 [INFO] Using device: cuda:0
2025-09-09 09:37:19,076 [INFO] Loading model: /root/autodl-tmp/Mistral ...
2025-09-09 09:37:25,311 [INFO] Model and tokenizer loaded successfully.
2025-09-09 09:37:25,413 [INFO] [Auto] hidden_states length = 33; probing indices = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:37:25,413 [INFO] Final LAYERS_TO_PROBE for Mistral: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:37:25,413 [INFO] Determining probe input dimension...
2025-09-09 09:37:25,413 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:37:25,414 [INFO] Target: 10 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:37:25,414 [INFO] Generated final dataset with 30 samples.
2025-09-09 09:37:25,414 [INFO] Final label distribution: {0: 10, 1: 10, 2: 10}
2025-09-09 09:37:25,414 [INFO] [PLACEHOLDER] Extracting activations for 30 prompts, layers=[1]
2025-09-09 09:37:26,375 [INFO] [PLACEHOLDER] Finished extracting activations.
2025-09-09 09:37:26,376 [INFO] Determined fixed probe input dimension: 4096
2025-09-09 09:37:26,376 [INFO] ==================== RUN 1/5 (Seed: 42) ====================
2025-09-09 09:37:26,377 [INFO] Using device: cuda:0
2025-09-09 09:37:26,380 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:37:26,380 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:37:26,383 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:37:26,383 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:37:26,383 [INFO] [TRAIN_COMM_3WAY_Run1] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:37:55,150 [INFO] [TRAIN_COMM_3WAY_Run1] Finished extracting activations.
2025-09-09 09:37:55,154 [INFO] Per-layer classification reports -> ./outputs/Mistral/run_seed_42/probe_3way_comm_Mistral_seed_42_20250909_093755.txt
2025-09-09 09:37:55,154 [INFO] --- Starting Probe Training Loop for layers 1..32 ---
2025-09-09 09:37:55,154 [INFO] --- Processing Layer 1 ---
2025-09-09 09:37:55,424 [INFO] Layer 1 - Training completed.
2025-09-09 09:37:55,426 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_1/state_dict.pt
2025-09-09 09:37:55,441 [INFO] Layer 1 - Test Acc: 0.3733 | F1(C0,C1,C2): 0.517, 0.271, 0.000
2025-09-09 09:37:55,441 [INFO] --- Processing Layer 2 ---
2025-09-09 09:37:55,707 [INFO] Layer 2 - Training completed.
2025-09-09 09:37:55,708 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_2/state_dict.pt
2025-09-09 09:37:55,721 [INFO] Layer 2 - Test Acc: 0.4833 | F1(C0,C1,C2): 0.559, 0.606, 0.000
2025-09-09 09:37:55,722 [INFO] --- Processing Layer 3 ---
2025-09-09 09:37:55,987 [INFO] Layer 3 - Training completed.
2025-09-09 09:37:55,988 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_3/state_dict.pt
2025-09-09 09:37:56,001 [INFO] Layer 3 - Test Acc: 0.5967 | F1(C0,C1,C2): 0.693, 0.614, 0.427
2025-09-09 09:37:56,001 [INFO] --- Processing Layer 4 ---
2025-09-09 09:37:56,275 [INFO] Layer 4 - Training completed.
2025-09-09 09:37:56,277 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_4/state_dict.pt
2025-09-09 09:37:56,291 [INFO] Layer 4 - Test Acc: 0.8833 | F1(C0,C1,C2): 0.831, 0.823, 0.995
2025-09-09 09:37:56,291 [INFO] --- Processing Layer 5 ---
2025-09-09 09:37:56,562 [INFO] Layer 5 - Training completed.
2025-09-09 09:37:56,563 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_5/state_dict.pt
2025-09-09 09:37:56,577 [INFO] Layer 5 - Test Acc: 0.8733 | F1(C0,C1,C2): 0.820, 0.816, 0.980
2025-09-09 09:37:56,577 [INFO] --- Processing Layer 6 ---
2025-09-09 09:37:56,842 [INFO] Layer 6 - Training completed.
2025-09-09 09:37:56,843 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_6/state_dict.pt
2025-09-09 09:37:56,856 [INFO] Layer 6 - Test Acc: 0.9133 | F1(C0,C1,C2): 0.877, 0.872, 0.990
2025-09-09 09:37:56,857 [INFO] --- Processing Layer 7 ---
2025-09-09 09:37:57,123 [INFO] Layer 7 - Training completed.
2025-09-09 09:37:57,124 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_7/state_dict.pt
2025-09-09 09:37:57,138 [INFO] Layer 7 - Test Acc: 0.9033 | F1(C0,C1,C2): 0.860, 0.854, 0.995
2025-09-09 09:37:57,138 [INFO] --- Processing Layer 8 ---
2025-09-09 09:37:57,402 [INFO] Layer 8 - Training completed.
2025-09-09 09:37:57,403 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_8/state_dict.pt
2025-09-09 09:37:57,419 [INFO] Layer 8 - Test Acc: 0.9100 | F1(C0,C1,C2): 0.879, 0.847, 1.000
2025-09-09 09:37:57,419 [INFO] --- Processing Layer 9 ---
2025-09-09 09:37:57,683 [INFO] Layer 9 - Training completed.
2025-09-09 09:37:57,684 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_9/state_dict.pt
2025-09-09 09:37:57,698 [INFO] Layer 9 - Test Acc: 0.9600 | F1(C0,C1,C2): 0.942, 0.943, 0.995
2025-09-09 09:37:57,698 [INFO] --- Processing Layer 10 ---
2025-09-09 09:37:57,961 [INFO] Layer 10 - Training completed.
2025-09-09 09:37:57,962 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_10/state_dict.pt
2025-09-09 09:37:57,975 [INFO] Layer 10 - Test Acc: 0.9433 | F1(C0,C1,C2): 0.921, 0.908, 1.000
2025-09-09 09:37:57,976 [INFO] --- Processing Layer 11 ---
2025-09-09 09:37:58,241 [INFO] Layer 11 - Training completed.
2025-09-09 09:37:58,242 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_11/state_dict.pt
2025-09-09 09:37:58,255 [INFO] Layer 11 - Test Acc: 0.9700 | F1(C0,C1,C2): 0.953, 0.957, 1.000
2025-09-09 09:37:58,255 [INFO] --- Processing Layer 12 ---
2025-09-09 09:37:58,521 [INFO] Layer 12 - Training completed.
2025-09-09 09:37:58,522 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_12/state_dict.pt
2025-09-09 09:37:58,535 [INFO] Layer 12 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:37:58,536 [INFO] --- Processing Layer 13 ---
2025-09-09 09:37:58,803 [INFO] Layer 13 - Training completed.
2025-09-09 09:37:58,804 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_13/state_dict.pt
2025-09-09 09:37:58,818 [INFO] Layer 13 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:37:58,818 [INFO] --- Processing Layer 14 ---
2025-09-09 09:37:59,083 [INFO] Layer 14 - Training completed.
2025-09-09 09:37:59,084 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_14/state_dict.pt
2025-09-09 09:37:59,098 [INFO] Layer 14 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.980, 1.000
2025-09-09 09:37:59,098 [INFO] --- Processing Layer 15 ---
2025-09-09 09:37:59,360 [INFO] Layer 15 - Training completed.
2025-09-09 09:37:59,361 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_15/state_dict.pt
2025-09-09 09:37:59,374 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:37:59,375 [INFO] --- Processing Layer 16 ---
2025-09-09 09:37:59,637 [INFO] Layer 16 - Training completed.
2025-09-09 09:37:59,638 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_16/state_dict.pt
2025-09-09 09:37:59,651 [INFO] Layer 16 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:37:59,651 [INFO] --- Processing Layer 17 ---
2025-09-09 09:37:59,917 [INFO] Layer 17 - Training completed.
2025-09-09 09:37:59,918 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_17/state_dict.pt
2025-09-09 09:37:59,931 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:37:59,932 [INFO] --- Processing Layer 18 ---
2025-09-09 09:38:00,195 [INFO] Layer 18 - Training completed.
2025-09-09 09:38:00,197 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_18/state_dict.pt
2025-09-09 09:38:00,210 [INFO] Layer 18 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:38:00,211 [INFO] --- Processing Layer 19 ---
2025-09-09 09:38:00,477 [INFO] Layer 19 - Training completed.
2025-09-09 09:38:00,478 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_19/state_dict.pt
2025-09-09 09:38:00,492 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:38:00,492 [INFO] --- Processing Layer 20 ---
2025-09-09 09:38:00,763 [INFO] Layer 20 - Training completed.
2025-09-09 09:38:00,764 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_20/state_dict.pt
2025-09-09 09:38:00,778 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:38:00,778 [INFO] --- Processing Layer 21 ---
2025-09-09 09:38:01,048 [INFO] Layer 21 - Training completed.
2025-09-09 09:38:01,049 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_21/state_dict.pt
2025-09-09 09:38:01,062 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:38:01,062 [INFO] --- Processing Layer 22 ---
2025-09-09 09:38:01,327 [INFO] Layer 22 - Training completed.
2025-09-09 09:38:01,328 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_22/state_dict.pt
2025-09-09 09:38:01,341 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:38:01,342 [INFO] --- Processing Layer 23 ---
2025-09-09 09:38:01,606 [INFO] Layer 23 - Training completed.
2025-09-09 09:38:01,607 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_23/state_dict.pt
2025-09-09 09:38:01,621 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:38:01,621 [INFO] --- Processing Layer 24 ---
2025-09-09 09:38:01,889 [INFO] Layer 24 - Training completed.
2025-09-09 09:38:01,890 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_24/state_dict.pt
2025-09-09 09:38:01,904 [INFO] Layer 24 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:38:01,904 [INFO] --- Processing Layer 25 ---
2025-09-09 09:38:02,196 [INFO] Layer 25 - Training completed.
2025-09-09 09:38:02,197 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_25/state_dict.pt
2025-09-09 09:38:02,211 [INFO] Layer 25 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:38:02,211 [INFO] --- Processing Layer 26 ---
2025-09-09 09:38:02,474 [INFO] Layer 26 - Training completed.
2025-09-09 09:38:02,475 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_26/state_dict.pt
2025-09-09 09:38:02,489 [INFO] Layer 26 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:38:02,490 [INFO] --- Processing Layer 27 ---
2025-09-09 09:38:02,752 [INFO] Layer 27 - Training completed.
2025-09-09 09:38:02,753 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_27/state_dict.pt
2025-09-09 09:38:02,766 [INFO] Layer 27 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:38:02,767 [INFO] --- Processing Layer 28 ---
2025-09-09 09:38:03,034 [INFO] Layer 28 - Training completed.
2025-09-09 09:38:03,035 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_28/state_dict.pt
2025-09-09 09:38:03,049 [INFO] Layer 28 - Test Acc: 0.9967 | F1(C0,C1,C2): 1.000, 0.995, 0.995
2025-09-09 09:38:03,049 [INFO] --- Processing Layer 29 ---
2025-09-09 09:38:03,331 [INFO] Layer 29 - Training completed.
2025-09-09 09:38:03,332 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_29/state_dict.pt
2025-09-09 09:38:03,346 [INFO] Layer 29 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:38:03,346 [INFO] --- Processing Layer 30 ---
2025-09-09 09:38:03,625 [INFO] Layer 30 - Training completed.
2025-09-09 09:38:03,626 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_30/state_dict.pt
2025-09-09 09:38:03,639 [INFO] Layer 30 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:38:03,639 [INFO] --- Processing Layer 31 ---
2025-09-09 09:38:03,919 [INFO] Layer 31 - Training completed.
2025-09-09 09:38:03,920 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_31/state_dict.pt
2025-09-09 09:38:03,933 [INFO] Layer 31 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:38:03,933 [INFO] --- Processing Layer 32 ---
2025-09-09 09:38:04,214 [INFO] Layer 32 - Training completed.
2025-09-09 09:38:04,215 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_42/layer_32/state_dict.pt
2025-09-09 09:38:04,229 [INFO] Layer 32 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:38:04,229 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:38:04,229 [INFO] --- Generating OOD Datasets for Run 1 ---
2025-09-09 09:38:04,235 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:38:04,237 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:38:04,277 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:38:08,710 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:38:08,713 [INFO] [OOD 1d] Layer 1: acc=0.3333
2025-09-09 09:38:08,714 [INFO] [OOD 1d] Layer 2: acc=0.3333
2025-09-09 09:38:08,716 [INFO] [OOD 1d] Layer 3: acc=0.4333
2025-09-09 09:38:08,718 [INFO] [OOD 1d] Layer 4: acc=0.3333
2025-09-09 09:38:08,719 [INFO] [OOD 1d] Layer 5: acc=0.3333
2025-09-09 09:38:08,721 [INFO] [OOD 1d] Layer 6: acc=0.3367
2025-09-09 09:38:08,723 [INFO] [OOD 1d] Layer 7: acc=0.4167
2025-09-09 09:38:08,725 [INFO] [OOD 1d] Layer 8: acc=0.4800
2025-09-09 09:38:08,726 [INFO] [OOD 1d] Layer 9: acc=0.4933
2025-09-09 09:38:08,728 [INFO] [OOD 1d] Layer 10: acc=0.6867
2025-09-09 09:38:08,729 [INFO] [OOD 1d] Layer 11: acc=0.7900
2025-09-09 09:38:08,731 [INFO] [OOD 1d] Layer 12: acc=0.7600
2025-09-09 09:38:08,733 [INFO] [OOD 1d] Layer 13: acc=0.6833
2025-09-09 09:38:08,734 [INFO] [OOD 1d] Layer 14: acc=0.8067
2025-09-09 09:38:08,736 [INFO] [OOD 1d] Layer 15: acc=0.9533
2025-09-09 09:38:08,737 [INFO] [OOD 1d] Layer 16: acc=1.0000
2025-09-09 09:38:08,739 [INFO] [OOD 1d] Layer 17: acc=1.0000
2025-09-09 09:38:08,741 [INFO] [OOD 1d] Layer 18: acc=1.0000
2025-09-09 09:38:08,742 [INFO] [OOD 1d] Layer 19: acc=0.9867
2025-09-09 09:38:08,744 [INFO] [OOD 1d] Layer 20: acc=0.9900
2025-09-09 09:38:08,745 [INFO] [OOD 1d] Layer 21: acc=1.0000
2025-09-09 09:38:08,747 [INFO] [OOD 1d] Layer 22: acc=1.0000
2025-09-09 09:38:08,749 [INFO] [OOD 1d] Layer 23: acc=0.9633
2025-09-09 09:38:08,750 [INFO] [OOD 1d] Layer 24: acc=0.9500
2025-09-09 09:38:08,752 [INFO] [OOD 1d] Layer 25: acc=0.9467
2025-09-09 09:38:08,753 [INFO] [OOD 1d] Layer 26: acc=1.0000
2025-09-09 09:38:08,755 [INFO] [OOD 1d] Layer 27: acc=1.0000
2025-09-09 09:38:08,756 [INFO] [OOD 1d] Layer 28: acc=0.9900
2025-09-09 09:38:08,758 [INFO] [OOD 1d] Layer 29: acc=0.9733
2025-09-09 09:38:08,759 [INFO] [OOD 1d] Layer 30: acc=0.9300
2025-09-09 09:38:08,761 [INFO] [OOD 1d] Layer 31: acc=0.9433
2025-09-09 09:38:08,763 [INFO] [OOD 1d] Layer 32: acc=0.9000
2025-09-09 09:38:08,763 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:38:12,647 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:38:12,649 [INFO] [OOD 2d] Layer 1: acc=0.6000
2025-09-09 09:38:12,650 [INFO] [OOD 2d] Layer 2: acc=0.7650
2025-09-09 09:38:12,652 [INFO] [OOD 2d] Layer 3: acc=0.8100
2025-09-09 09:38:12,653 [INFO] [OOD 2d] Layer 4: acc=0.9000
2025-09-09 09:38:12,655 [INFO] [OOD 2d] Layer 5: acc=0.8650
2025-09-09 09:38:12,656 [INFO] [OOD 2d] Layer 6: acc=0.8700
2025-09-09 09:38:12,657 [INFO] [OOD 2d] Layer 7: acc=0.8750
2025-09-09 09:38:12,658 [INFO] [OOD 2d] Layer 8: acc=0.8850
2025-09-09 09:38:12,660 [INFO] [OOD 2d] Layer 9: acc=0.9200
2025-09-09 09:38:12,661 [INFO] [OOD 2d] Layer 10: acc=0.9200
2025-09-09 09:38:12,662 [INFO] [OOD 2d] Layer 11: acc=0.9350
2025-09-09 09:38:12,663 [INFO] [OOD 2d] Layer 12: acc=1.0000
2025-09-09 09:38:12,665 [INFO] [OOD 2d] Layer 13: acc=0.9950
2025-09-09 09:38:12,666 [INFO] [OOD 2d] Layer 14: acc=0.9900
2025-09-09 09:38:12,667 [INFO] [OOD 2d] Layer 15: acc=1.0000
2025-09-09 09:38:12,669 [INFO] [OOD 2d] Layer 16: acc=1.0000
2025-09-09 09:38:12,670 [INFO] [OOD 2d] Layer 17: acc=1.0000
2025-09-09 09:38:12,671 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:38:12,673 [INFO] [OOD 2d] Layer 19: acc=1.0000
2025-09-09 09:38:12,674 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:38:12,675 [INFO] [OOD 2d] Layer 21: acc=1.0000
2025-09-09 09:38:12,677 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:38:12,678 [INFO] [OOD 2d] Layer 23: acc=1.0000
2025-09-09 09:38:12,679 [INFO] [OOD 2d] Layer 24: acc=1.0000
2025-09-09 09:38:12,681 [INFO] [OOD 2d] Layer 25: acc=1.0000
2025-09-09 09:38:12,682 [INFO] [OOD 2d] Layer 26: acc=1.0000
2025-09-09 09:38:12,683 [INFO] [OOD 2d] Layer 27: acc=1.0000
2025-09-09 09:38:12,685 [INFO] [OOD 2d] Layer 28: acc=1.0000
2025-09-09 09:38:12,686 [INFO] [OOD 2d] Layer 29: acc=0.9950
2025-09-09 09:38:12,687 [INFO] [OOD 2d] Layer 30: acc=1.0000
2025-09-09 09:38:12,689 [INFO] [OOD 2d] Layer 31: acc=0.9900
2025-09-09 09:38:12,690 [INFO] [OOD 2d] Layer 32: acc=0.9950
2025-09-09 09:38:12,690 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:38:18,855 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:38:18,858 [INFO] [OOD 3d] Layer 1: acc=0.3400
2025-09-09 09:38:18,860 [INFO] [OOD 3d] Layer 2: acc=0.4000
2025-09-09 09:38:18,862 [INFO] [OOD 3d] Layer 3: acc=0.4700
2025-09-09 09:38:18,863 [INFO] [OOD 3d] Layer 4: acc=0.7767
2025-09-09 09:38:18,865 [INFO] [OOD 3d] Layer 5: acc=0.7667
2025-09-09 09:38:18,867 [INFO] [OOD 3d] Layer 6: acc=0.7233
2025-09-09 09:38:18,869 [INFO] [OOD 3d] Layer 7: acc=0.6700
2025-09-09 09:38:18,870 [INFO] [OOD 3d] Layer 8: acc=0.6700
2025-09-09 09:38:18,872 [INFO] [OOD 3d] Layer 9: acc=0.7033
2025-09-09 09:38:18,873 [INFO] [OOD 3d] Layer 10: acc=0.6933
2025-09-09 09:38:18,875 [INFO] [OOD 3d] Layer 11: acc=0.9400
2025-09-09 09:38:18,877 [INFO] [OOD 3d] Layer 12: acc=0.9733
2025-09-09 09:38:18,878 [INFO] [OOD 3d] Layer 13: acc=0.8467
2025-09-09 09:38:18,880 [INFO] [OOD 3d] Layer 14: acc=0.9800
2025-09-09 09:38:18,882 [INFO] [OOD 3d] Layer 15: acc=1.0000
2025-09-09 09:38:18,883 [INFO] [OOD 3d] Layer 16: acc=1.0000
2025-09-09 09:38:18,885 [INFO] [OOD 3d] Layer 17: acc=1.0000
2025-09-09 09:38:18,886 [INFO] [OOD 3d] Layer 18: acc=1.0000
2025-09-09 09:38:18,888 [INFO] [OOD 3d] Layer 19: acc=0.9933
2025-09-09 09:38:18,890 [INFO] [OOD 3d] Layer 20: acc=1.0000
2025-09-09 09:38:18,891 [INFO] [OOD 3d] Layer 21: acc=1.0000
2025-09-09 09:38:18,893 [INFO] [OOD 3d] Layer 22: acc=1.0000
2025-09-09 09:38:18,895 [INFO] [OOD 3d] Layer 23: acc=0.9900
2025-09-09 09:38:18,897 [INFO] [OOD 3d] Layer 24: acc=0.9733
2025-09-09 09:38:18,898 [INFO] [OOD 3d] Layer 25: acc=0.9267
2025-09-09 09:38:18,900 [INFO] [OOD 3d] Layer 26: acc=0.9333
2025-09-09 09:38:18,901 [INFO] [OOD 3d] Layer 27: acc=0.9600
2025-09-09 09:38:18,903 [INFO] [OOD 3d] Layer 28: acc=0.9400
2025-09-09 09:38:18,905 [INFO] [OOD 3d] Layer 29: acc=0.9667
2025-09-09 09:38:18,906 [INFO] [OOD 3d] Layer 30: acc=0.9300
2025-09-09 09:38:18,908 [INFO] [OOD 3d] Layer 31: acc=0.9733
2025-09-09 09:38:18,910 [INFO] [OOD 3d] Layer 32: acc=0.9767
2025-09-09 09:38:18,910 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:38:26,255 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:38:26,258 [INFO] [OOD 4d] Layer 1: acc=0.3700
2025-09-09 09:38:26,259 [INFO] [OOD 4d] Layer 2: acc=0.3933
2025-09-09 09:38:26,261 [INFO] [OOD 4d] Layer 3: acc=0.3767
2025-09-09 09:38:26,263 [INFO] [OOD 4d] Layer 4: acc=0.7100
2025-09-09 09:38:26,265 [INFO] [OOD 4d] Layer 5: acc=0.5933
2025-09-09 09:38:26,266 [INFO] [OOD 4d] Layer 6: acc=0.7100
2025-09-09 09:38:26,268 [INFO] [OOD 4d] Layer 7: acc=0.6667
2025-09-09 09:38:26,270 [INFO] [OOD 4d] Layer 8: acc=0.6667
2025-09-09 09:38:26,271 [INFO] [OOD 4d] Layer 9: acc=0.7033
2025-09-09 09:38:26,273 [INFO] [OOD 4d] Layer 10: acc=0.6867
2025-09-09 09:38:26,274 [INFO] [OOD 4d] Layer 11: acc=0.9100
2025-09-09 09:38:26,276 [INFO] [OOD 4d] Layer 12: acc=0.8600
2025-09-09 09:38:26,278 [INFO] [OOD 4d] Layer 13: acc=0.7000
2025-09-09 09:38:26,279 [INFO] [OOD 4d] Layer 14: acc=0.9333
2025-09-09 09:38:26,281 [INFO] [OOD 4d] Layer 15: acc=0.9933
2025-09-09 09:38:26,282 [INFO] [OOD 4d] Layer 16: acc=0.9967
2025-09-09 09:38:26,284 [INFO] [OOD 4d] Layer 17: acc=0.9967
2025-09-09 09:38:26,286 [INFO] [OOD 4d] Layer 18: acc=0.9967
2025-09-09 09:38:26,287 [INFO] [OOD 4d] Layer 19: acc=1.0000
2025-09-09 09:38:26,289 [INFO] [OOD 4d] Layer 20: acc=1.0000
2025-09-09 09:38:26,291 [INFO] [OOD 4d] Layer 21: acc=0.9967
2025-09-09 09:38:26,293 [INFO] [OOD 4d] Layer 22: acc=0.9967
2025-09-09 09:38:26,294 [INFO] [OOD 4d] Layer 23: acc=0.9900
2025-09-09 09:38:26,296 [INFO] [OOD 4d] Layer 24: acc=0.9467
2025-09-09 09:38:26,298 [INFO] [OOD 4d] Layer 25: acc=0.9567
2025-09-09 09:38:26,299 [INFO] [OOD 4d] Layer 26: acc=0.9967
2025-09-09 09:38:26,301 [INFO] [OOD 4d] Layer 27: acc=1.0000
2025-09-09 09:38:26,303 [INFO] [OOD 4d] Layer 28: acc=0.9833
2025-09-09 09:38:26,304 [INFO] [OOD 4d] Layer 29: acc=0.9933
2025-09-09 09:38:26,306 [INFO] [OOD 4d] Layer 30: acc=0.9433
2025-09-09 09:38:26,307 [INFO] [OOD 4d] Layer 31: acc=0.9933
2025-09-09 09:38:26,309 [INFO] [OOD 4d] Layer 32: acc=0.9833
2025-09-09 09:38:26,310 [INFO] ==================== RUN 2/5 (Seed: 43) ====================
2025-09-09 09:38:26,311 [INFO] Using device: cuda:0
2025-09-09 09:38:26,314 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:38:26,314 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:38:26,316 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:38:26,317 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:38:26,317 [INFO] [TRAIN_COMM_3WAY_Run2] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:38:54,995 [INFO] [TRAIN_COMM_3WAY_Run2] Finished extracting activations.
2025-09-09 09:38:54,999 [INFO] Per-layer classification reports -> ./outputs/Mistral/run_seed_43/probe_3way_comm_Mistral_seed_43_20250909_093854.txt
2025-09-09 09:38:54,999 [INFO] --- Starting Probe Training Loop for layers 1..32 ---
2025-09-09 09:38:54,999 [INFO] --- Processing Layer 1 ---
2025-09-09 09:38:55,274 [INFO] Layer 1 - Training completed.
2025-09-09 09:38:55,275 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_1/state_dict.pt
2025-09-09 09:38:55,290 [INFO] Layer 1 - Test Acc: 0.3533 | F1(C0,C1,C2): 0.510, 0.000, 0.138
2025-09-09 09:38:55,290 [INFO] --- Processing Layer 2 ---
2025-09-09 09:38:55,561 [INFO] Layer 2 - Training completed.
2025-09-09 09:38:55,562 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_2/state_dict.pt
2025-09-09 09:38:55,576 [INFO] Layer 2 - Test Acc: 0.4900 | F1(C0,C1,C2): 0.587, 0.556, 0.204
2025-09-09 09:38:55,576 [INFO] --- Processing Layer 3 ---
2025-09-09 09:38:55,847 [INFO] Layer 3 - Training completed.
2025-09-09 09:38:55,848 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_3/state_dict.pt
2025-09-09 09:38:55,862 [INFO] Layer 3 - Test Acc: 0.5700 | F1(C0,C1,C2): 0.627, 0.753, 0.058
2025-09-09 09:38:55,862 [INFO] --- Processing Layer 4 ---
2025-09-09 09:38:56,131 [INFO] Layer 4 - Training completed.
2025-09-09 09:38:56,132 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_4/state_dict.pt
2025-09-09 09:38:56,145 [INFO] Layer 4 - Test Acc: 0.8867 | F1(C0,C1,C2): 0.802, 0.851, 1.000
2025-09-09 09:38:56,146 [INFO] --- Processing Layer 5 ---
2025-09-09 09:38:56,414 [INFO] Layer 5 - Training completed.
2025-09-09 09:38:56,415 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_5/state_dict.pt
2025-09-09 09:38:56,428 [INFO] Layer 5 - Test Acc: 0.8833 | F1(C0,C1,C2): 0.831, 0.819, 1.000
2025-09-09 09:38:56,429 [INFO] --- Processing Layer 6 ---
2025-09-09 09:38:56,698 [INFO] Layer 6 - Training completed.
2025-09-09 09:38:56,699 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_6/state_dict.pt
2025-09-09 09:38:56,713 [INFO] Layer 6 - Test Acc: 0.8900 | F1(C0,C1,C2): 0.837, 0.832, 1.000
2025-09-09 09:38:56,713 [INFO] --- Processing Layer 7 ---
2025-09-09 09:38:56,983 [INFO] Layer 7 - Training completed.
2025-09-09 09:38:56,984 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_7/state_dict.pt
2025-09-09 09:38:56,998 [INFO] Layer 7 - Test Acc: 0.8933 | F1(C0,C1,C2): 0.853, 0.834, 0.990
2025-09-09 09:38:56,998 [INFO] --- Processing Layer 8 ---
2025-09-09 09:38:57,264 [INFO] Layer 8 - Training completed.
2025-09-09 09:38:57,265 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_8/state_dict.pt
2025-09-09 09:38:57,279 [INFO] Layer 8 - Test Acc: 0.9100 | F1(C0,C1,C2): 0.877, 0.856, 0.995
2025-09-09 09:38:57,279 [INFO] --- Processing Layer 9 ---
2025-09-09 09:38:57,549 [INFO] Layer 9 - Training completed.
2025-09-09 09:38:57,550 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_9/state_dict.pt
2025-09-09 09:38:57,564 [INFO] Layer 9 - Test Acc: 0.9333 | F1(C0,C1,C2): 0.890, 0.912, 0.995
2025-09-09 09:38:57,564 [INFO] --- Processing Layer 10 ---
2025-09-09 09:38:57,845 [INFO] Layer 10 - Training completed.
2025-09-09 09:38:57,846 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_10/state_dict.pt
2025-09-09 09:38:57,862 [INFO] Layer 10 - Test Acc: 0.9500 | F1(C0,C1,C2): 0.930, 0.920, 1.000
2025-09-09 09:38:57,862 [INFO] --- Processing Layer 11 ---
2025-09-09 09:38:58,167 [INFO] Layer 11 - Training completed.
2025-09-09 09:38:58,168 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_11/state_dict.pt
2025-09-09 09:38:58,183 [INFO] Layer 11 - Test Acc: 0.9767 | F1(C0,C1,C2): 0.964, 0.966, 1.000
2025-09-09 09:38:58,183 [INFO] --- Processing Layer 12 ---
2025-09-09 09:38:58,455 [INFO] Layer 12 - Training completed.
2025-09-09 09:38:58,456 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_12/state_dict.pt
2025-09-09 09:38:58,471 [INFO] Layer 12 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:38:58,471 [INFO] --- Processing Layer 13 ---
2025-09-09 09:38:58,755 [INFO] Layer 13 - Training completed.
2025-09-09 09:38:58,757 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_13/state_dict.pt
2025-09-09 09:38:58,778 [INFO] Layer 13 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:38:58,778 [INFO] --- Processing Layer 14 ---
2025-09-09 09:38:59,061 [INFO] Layer 14 - Training completed.
2025-09-09 09:38:59,062 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_14/state_dict.pt
2025-09-09 09:38:59,076 [INFO] Layer 14 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:38:59,076 [INFO] --- Processing Layer 15 ---
2025-09-09 09:38:59,353 [INFO] Layer 15 - Training completed.
2025-09-09 09:38:59,354 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_15/state_dict.pt
2025-09-09 09:38:59,369 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:38:59,369 [INFO] --- Processing Layer 16 ---
2025-09-09 09:38:59,641 [INFO] Layer 16 - Training completed.
2025-09-09 09:38:59,642 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_16/state_dict.pt
2025-09-09 09:38:59,655 [INFO] Layer 16 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:38:59,656 [INFO] --- Processing Layer 17 ---
2025-09-09 09:38:59,934 [INFO] Layer 17 - Training completed.
2025-09-09 09:38:59,935 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_17/state_dict.pt
2025-09-09 09:38:59,948 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:38:59,949 [INFO] --- Processing Layer 18 ---
2025-09-09 09:39:00,234 [INFO] Layer 18 - Training completed.
2025-09-09 09:39:00,236 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_18/state_dict.pt
2025-09-09 09:39:00,250 [INFO] Layer 18 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:39:00,250 [INFO] --- Processing Layer 19 ---
2025-09-09 09:39:00,529 [INFO] Layer 19 - Training completed.
2025-09-09 09:39:00,530 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_19/state_dict.pt
2025-09-09 09:39:00,543 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:39:00,544 [INFO] --- Processing Layer 20 ---
2025-09-09 09:39:00,813 [INFO] Layer 20 - Training completed.
2025-09-09 09:39:00,814 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_20/state_dict.pt
2025-09-09 09:39:00,827 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:39:00,827 [INFO] --- Processing Layer 21 ---
2025-09-09 09:39:01,098 [INFO] Layer 21 - Training completed.
2025-09-09 09:39:01,099 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_21/state_dict.pt
2025-09-09 09:39:01,113 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:39:01,113 [INFO] --- Processing Layer 22 ---
2025-09-09 09:39:01,382 [INFO] Layer 22 - Training completed.
2025-09-09 09:39:01,383 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_22/state_dict.pt
2025-09-09 09:39:01,397 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:39:01,397 [INFO] --- Processing Layer 23 ---
2025-09-09 09:39:01,666 [INFO] Layer 23 - Training completed.
2025-09-09 09:39:01,667 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_23/state_dict.pt
2025-09-09 09:39:01,681 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:39:01,681 [INFO] --- Processing Layer 24 ---
2025-09-09 09:39:01,950 [INFO] Layer 24 - Training completed.
2025-09-09 09:39:01,951 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_24/state_dict.pt
2025-09-09 09:39:01,965 [INFO] Layer 24 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:39:01,966 [INFO] --- Processing Layer 25 ---
2025-09-09 09:39:02,245 [INFO] Layer 25 - Training completed.
2025-09-09 09:39:02,246 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_25/state_dict.pt
2025-09-09 09:39:02,260 [INFO] Layer 25 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:39:02,260 [INFO] --- Processing Layer 26 ---
2025-09-09 09:39:02,547 [INFO] Layer 26 - Training completed.
2025-09-09 09:39:02,548 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_26/state_dict.pt
2025-09-09 09:39:02,562 [INFO] Layer 26 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:39:02,562 [INFO] --- Processing Layer 27 ---
2025-09-09 09:39:02,831 [INFO] Layer 27 - Training completed.
2025-09-09 09:39:02,833 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_27/state_dict.pt
2025-09-09 09:39:02,847 [INFO] Layer 27 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:39:02,847 [INFO] --- Processing Layer 28 ---
2025-09-09 09:39:03,122 [INFO] Layer 28 - Training completed.
2025-09-09 09:39:03,124 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_28/state_dict.pt
2025-09-09 09:39:03,138 [INFO] Layer 28 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:39:03,138 [INFO] --- Processing Layer 29 ---
2025-09-09 09:39:03,408 [INFO] Layer 29 - Training completed.
2025-09-09 09:39:03,409 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_29/state_dict.pt
2025-09-09 09:39:03,423 [INFO] Layer 29 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:39:03,423 [INFO] --- Processing Layer 30 ---
2025-09-09 09:39:03,703 [INFO] Layer 30 - Training completed.
2025-09-09 09:39:03,705 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_30/state_dict.pt
2025-09-09 09:39:03,719 [INFO] Layer 30 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:39:03,719 [INFO] --- Processing Layer 31 ---
2025-09-09 09:39:03,989 [INFO] Layer 31 - Training completed.
2025-09-09 09:39:03,990 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_31/state_dict.pt
2025-09-09 09:39:04,003 [INFO] Layer 31 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:39:04,004 [INFO] --- Processing Layer 32 ---
2025-09-09 09:39:04,273 [INFO] Layer 32 - Training completed.
2025-09-09 09:39:04,274 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_43/layer_32/state_dict.pt
2025-09-09 09:39:04,288 [INFO] Layer 32 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:39:04,288 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:39:04,289 [INFO] --- Generating OOD Datasets for Run 2 ---
2025-09-09 09:39:04,295 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:39:04,297 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:39:04,338 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:39:08,826 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:39:08,829 [INFO] [OOD 1d] Layer 1: acc=0.3333
2025-09-09 09:39:08,831 [INFO] [OOD 1d] Layer 2: acc=0.3333
2025-09-09 09:39:08,833 [INFO] [OOD 1d] Layer 3: acc=0.4700
2025-09-09 09:39:08,835 [INFO] [OOD 1d] Layer 4: acc=0.5767
2025-09-09 09:39:08,836 [INFO] [OOD 1d] Layer 5: acc=0.3600
2025-09-09 09:39:08,838 [INFO] [OOD 1d] Layer 6: acc=0.4733
2025-09-09 09:39:08,839 [INFO] [OOD 1d] Layer 7: acc=0.4700
2025-09-09 09:39:08,841 [INFO] [OOD 1d] Layer 8: acc=0.5700
2025-09-09 09:39:08,843 [INFO] [OOD 1d] Layer 9: acc=0.6300
2025-09-09 09:39:08,845 [INFO] [OOD 1d] Layer 10: acc=0.7367
2025-09-09 09:39:08,846 [INFO] [OOD 1d] Layer 11: acc=0.9033
2025-09-09 09:39:08,848 [INFO] [OOD 1d] Layer 12: acc=0.9033
2025-09-09 09:39:08,850 [INFO] [OOD 1d] Layer 13: acc=0.8233
2025-09-09 09:39:08,851 [INFO] [OOD 1d] Layer 14: acc=0.8233
2025-09-09 09:39:08,853 [INFO] [OOD 1d] Layer 15: acc=0.9300
2025-09-09 09:39:08,854 [INFO] [OOD 1d] Layer 16: acc=1.0000
2025-09-09 09:39:08,856 [INFO] [OOD 1d] Layer 17: acc=1.0000
2025-09-09 09:39:08,857 [INFO] [OOD 1d] Layer 18: acc=1.0000
2025-09-09 09:39:08,859 [INFO] [OOD 1d] Layer 19: acc=0.9700
2025-09-09 09:39:08,861 [INFO] [OOD 1d] Layer 20: acc=0.9733
2025-09-09 09:39:08,862 [INFO] [OOD 1d] Layer 21: acc=1.0000
2025-09-09 09:39:08,864 [INFO] [OOD 1d] Layer 22: acc=0.9900
2025-09-09 09:39:08,866 [INFO] [OOD 1d] Layer 23: acc=0.9700
2025-09-09 09:39:08,867 [INFO] [OOD 1d] Layer 24: acc=0.9600
2025-09-09 09:39:08,869 [INFO] [OOD 1d] Layer 25: acc=0.9533
2025-09-09 09:39:08,870 [INFO] [OOD 1d] Layer 26: acc=0.9800
2025-09-09 09:39:08,872 [INFO] [OOD 1d] Layer 27: acc=0.9900
2025-09-09 09:39:08,874 [INFO] [OOD 1d] Layer 28: acc=0.9800
2025-09-09 09:39:08,875 [INFO] [OOD 1d] Layer 29: acc=0.9733
2025-09-09 09:39:08,877 [INFO] [OOD 1d] Layer 30: acc=0.9733
2025-09-09 09:39:08,878 [INFO] [OOD 1d] Layer 31: acc=0.9467
2025-09-09 09:39:08,880 [INFO] [OOD 1d] Layer 32: acc=0.9867
2025-09-09 09:39:08,880 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:39:12,776 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:39:12,778 [INFO] [OOD 2d] Layer 1: acc=0.4800
2025-09-09 09:39:12,779 [INFO] [OOD 2d] Layer 2: acc=0.7300
2025-09-09 09:39:12,781 [INFO] [OOD 2d] Layer 3: acc=0.8700
2025-09-09 09:39:12,782 [INFO] [OOD 2d] Layer 4: acc=0.8600
2025-09-09 09:39:12,784 [INFO] [OOD 2d] Layer 5: acc=0.8800
2025-09-09 09:39:12,785 [INFO] [OOD 2d] Layer 6: acc=0.8900
2025-09-09 09:39:12,786 [INFO] [OOD 2d] Layer 7: acc=0.8750
2025-09-09 09:39:12,787 [INFO] [OOD 2d] Layer 8: acc=0.9250
2025-09-09 09:39:12,789 [INFO] [OOD 2d] Layer 9: acc=0.9250
2025-09-09 09:39:12,790 [INFO] [OOD 2d] Layer 10: acc=0.9450
2025-09-09 09:39:12,791 [INFO] [OOD 2d] Layer 11: acc=0.9750
2025-09-09 09:39:12,793 [INFO] [OOD 2d] Layer 12: acc=0.9950
2025-09-09 09:39:12,794 [INFO] [OOD 2d] Layer 13: acc=0.9900
2025-09-09 09:39:12,795 [INFO] [OOD 2d] Layer 14: acc=0.9750
2025-09-09 09:39:12,797 [INFO] [OOD 2d] Layer 15: acc=1.0000
2025-09-09 09:39:12,798 [INFO] [OOD 2d] Layer 16: acc=1.0000
2025-09-09 09:39:12,799 [INFO] [OOD 2d] Layer 17: acc=1.0000
2025-09-09 09:39:12,800 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:39:12,802 [INFO] [OOD 2d] Layer 19: acc=1.0000
2025-09-09 09:39:12,803 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:39:12,804 [INFO] [OOD 2d] Layer 21: acc=1.0000
2025-09-09 09:39:12,806 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:39:12,807 [INFO] [OOD 2d] Layer 23: acc=1.0000
2025-09-09 09:39:12,808 [INFO] [OOD 2d] Layer 24: acc=1.0000
2025-09-09 09:39:12,809 [INFO] [OOD 2d] Layer 25: acc=0.9950
2025-09-09 09:39:12,811 [INFO] [OOD 2d] Layer 26: acc=0.9950
2025-09-09 09:39:12,812 [INFO] [OOD 2d] Layer 27: acc=0.9950
2025-09-09 09:39:12,813 [INFO] [OOD 2d] Layer 28: acc=0.9950
2025-09-09 09:39:12,814 [INFO] [OOD 2d] Layer 29: acc=0.9950
2025-09-09 09:39:12,816 [INFO] [OOD 2d] Layer 30: acc=1.0000
2025-09-09 09:39:12,817 [INFO] [OOD 2d] Layer 31: acc=0.9950
2025-09-09 09:39:12,818 [INFO] [OOD 2d] Layer 32: acc=0.9900
2025-09-09 09:39:12,819 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:39:18,993 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:39:18,996 [INFO] [OOD 3d] Layer 1: acc=0.3700
2025-09-09 09:39:18,998 [INFO] [OOD 3d] Layer 2: acc=0.3833
2025-09-09 09:39:18,999 [INFO] [OOD 3d] Layer 3: acc=0.4200
2025-09-09 09:39:19,001 [INFO] [OOD 3d] Layer 4: acc=0.8533
2025-09-09 09:39:19,003 [INFO] [OOD 3d] Layer 5: acc=0.7567
2025-09-09 09:39:19,004 [INFO] [OOD 3d] Layer 6: acc=0.7267
2025-09-09 09:39:19,006 [INFO] [OOD 3d] Layer 7: acc=0.6700
2025-09-09 09:39:19,008 [INFO] [OOD 3d] Layer 8: acc=0.6733
2025-09-09 09:39:19,009 [INFO] [OOD 3d] Layer 9: acc=0.8300
2025-09-09 09:39:19,011 [INFO] [OOD 3d] Layer 10: acc=0.7333
2025-09-09 09:39:19,013 [INFO] [OOD 3d] Layer 11: acc=0.8833
2025-09-09 09:39:19,014 [INFO] [OOD 3d] Layer 12: acc=0.8733
2025-09-09 09:39:19,016 [INFO] [OOD 3d] Layer 13: acc=0.9400
2025-09-09 09:39:19,017 [INFO] [OOD 3d] Layer 14: acc=0.9467
2025-09-09 09:39:19,019 [INFO] [OOD 3d] Layer 15: acc=1.0000
2025-09-09 09:39:19,021 [INFO] [OOD 3d] Layer 16: acc=1.0000
2025-09-09 09:39:19,022 [INFO] [OOD 3d] Layer 17: acc=1.0000
2025-09-09 09:39:19,024 [INFO] [OOD 3d] Layer 18: acc=1.0000
2025-09-09 09:39:19,026 [INFO] [OOD 3d] Layer 19: acc=0.9967
2025-09-09 09:39:19,027 [INFO] [OOD 3d] Layer 20: acc=0.9967
2025-09-09 09:39:19,029 [INFO] [OOD 3d] Layer 21: acc=1.0000
2025-09-09 09:39:19,030 [INFO] [OOD 3d] Layer 22: acc=0.9933
2025-09-09 09:39:19,032 [INFO] [OOD 3d] Layer 23: acc=0.9933
2025-09-09 09:39:19,034 [INFO] [OOD 3d] Layer 24: acc=0.9800
2025-09-09 09:39:19,035 [INFO] [OOD 3d] Layer 25: acc=0.9367
2025-09-09 09:39:19,037 [INFO] [OOD 3d] Layer 26: acc=0.9367
2025-09-09 09:39:19,039 [INFO] [OOD 3d] Layer 27: acc=0.9733
2025-09-09 09:39:19,041 [INFO] [OOD 3d] Layer 28: acc=0.9700
2025-09-09 09:39:19,042 [INFO] [OOD 3d] Layer 29: acc=0.9733
2025-09-09 09:39:19,044 [INFO] [OOD 3d] Layer 30: acc=0.9867
2025-09-09 09:39:19,045 [INFO] [OOD 3d] Layer 31: acc=0.9767
2025-09-09 09:39:19,047 [INFO] [OOD 3d] Layer 32: acc=0.9667
2025-09-09 09:39:19,047 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:39:26,405 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:39:26,408 [INFO] [OOD 4d] Layer 1: acc=0.3433
2025-09-09 09:39:26,410 [INFO] [OOD 4d] Layer 2: acc=0.4000
2025-09-09 09:39:26,412 [INFO] [OOD 4d] Layer 3: acc=0.3700
2025-09-09 09:39:26,413 [INFO] [OOD 4d] Layer 4: acc=0.7733
2025-09-09 09:39:26,415 [INFO] [OOD 4d] Layer 5: acc=0.6200
2025-09-09 09:39:26,417 [INFO] [OOD 4d] Layer 6: acc=0.7300
2025-09-09 09:39:26,418 [INFO] [OOD 4d] Layer 7: acc=0.6667
2025-09-09 09:39:26,420 [INFO] [OOD 4d] Layer 8: acc=0.6633
2025-09-09 09:39:26,422 [INFO] [OOD 4d] Layer 9: acc=0.8367
2025-09-09 09:39:26,423 [INFO] [OOD 4d] Layer 10: acc=0.7067
2025-09-09 09:39:26,425 [INFO] [OOD 4d] Layer 11: acc=0.8467
2025-09-09 09:39:26,427 [INFO] [OOD 4d] Layer 12: acc=0.7267
2025-09-09 09:39:26,428 [INFO] [OOD 4d] Layer 13: acc=0.7867
2025-09-09 09:39:26,430 [INFO] [OOD 4d] Layer 14: acc=0.8967
2025-09-09 09:39:26,431 [INFO] [OOD 4d] Layer 15: acc=1.0000
2025-09-09 09:39:26,433 [INFO] [OOD 4d] Layer 16: acc=1.0000
2025-09-09 09:39:26,435 [INFO] [OOD 4d] Layer 17: acc=1.0000
2025-09-09 09:39:26,437 [INFO] [OOD 4d] Layer 18: acc=1.0000
2025-09-09 09:39:26,438 [INFO] [OOD 4d] Layer 19: acc=1.0000
2025-09-09 09:39:26,440 [INFO] [OOD 4d] Layer 20: acc=1.0000
2025-09-09 09:39:26,442 [INFO] [OOD 4d] Layer 21: acc=0.9967
2025-09-09 09:39:26,443 [INFO] [OOD 4d] Layer 22: acc=0.9933
2025-09-09 09:39:26,445 [INFO] [OOD 4d] Layer 23: acc=0.9833
2025-09-09 09:39:26,447 [INFO] [OOD 4d] Layer 24: acc=0.9733
2025-09-09 09:39:26,449 [INFO] [OOD 4d] Layer 25: acc=0.9500
2025-09-09 09:39:26,450 [INFO] [OOD 4d] Layer 26: acc=0.9833
2025-09-09 09:39:26,452 [INFO] [OOD 4d] Layer 27: acc=1.0000
2025-09-09 09:39:26,453 [INFO] [OOD 4d] Layer 28: acc=0.9867
2025-09-09 09:39:26,455 [INFO] [OOD 4d] Layer 29: acc=0.9833
2025-09-09 09:39:26,457 [INFO] [OOD 4d] Layer 30: acc=0.9800
2025-09-09 09:39:26,458 [INFO] [OOD 4d] Layer 31: acc=0.9700
2025-09-09 09:39:26,460 [INFO] [OOD 4d] Layer 32: acc=0.9767
2025-09-09 09:39:26,461 [INFO] ==================== RUN 3/5 (Seed: 44) ====================
2025-09-09 09:39:26,461 [INFO] Using device: cuda:0
2025-09-09 09:39:26,465 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:39:26,465 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:39:26,467 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:39:26,467 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:39:26,468 [INFO] [TRAIN_COMM_3WAY_Run3] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:39:54,973 [INFO] [TRAIN_COMM_3WAY_Run3] Finished extracting activations.
2025-09-09 09:39:55,007 [INFO] Per-layer classification reports -> ./outputs/Mistral/run_seed_44/probe_3way_comm_Mistral_seed_44_20250909_093955.txt
2025-09-09 09:39:55,008 [INFO] --- Starting Probe Training Loop for layers 1..32 ---
2025-09-09 09:39:55,008 [INFO] --- Processing Layer 1 ---
2025-09-09 09:39:55,304 [INFO] Layer 1 - Training completed.
2025-09-09 09:39:55,305 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_1/state_dict.pt
2025-09-09 09:39:55,319 [INFO] Layer 1 - Test Acc: 0.3767 | F1(C0,C1,C2): 0.441, 0.463, 0.000
2025-09-09 09:39:55,320 [INFO] --- Processing Layer 2 ---
2025-09-09 09:39:55,603 [INFO] Layer 2 - Training completed.
2025-09-09 09:39:55,605 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_2/state_dict.pt
2025-09-09 09:39:55,619 [INFO] Layer 2 - Test Acc: 0.4767 | F1(C0,C1,C2): 0.558, 0.569, 0.058
2025-09-09 09:39:55,619 [INFO] --- Processing Layer 3 ---
2025-09-09 09:39:55,889 [INFO] Layer 3 - Training completed.
2025-09-09 09:39:55,890 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_3/state_dict.pt
2025-09-09 09:39:55,904 [INFO] Layer 3 - Test Acc: 0.6933 | F1(C0,C1,C2): 0.736, 0.675, 0.664
2025-09-09 09:39:55,905 [INFO] --- Processing Layer 4 ---
2025-09-09 09:39:56,179 [INFO] Layer 4 - Training completed.
2025-09-09 09:39:56,180 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_4/state_dict.pt
2025-09-09 09:39:56,194 [INFO] Layer 4 - Test Acc: 0.8867 | F1(C0,C1,C2): 0.841, 0.817, 1.000
2025-09-09 09:39:56,194 [INFO] --- Processing Layer 5 ---
2025-09-09 09:39:56,463 [INFO] Layer 5 - Training completed.
2025-09-09 09:39:56,464 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_5/state_dict.pt
2025-09-09 09:39:56,477 [INFO] Layer 5 - Test Acc: 0.8833 | F1(C0,C1,C2): 0.828, 0.822, 1.000
2025-09-09 09:39:56,478 [INFO] --- Processing Layer 6 ---
2025-09-09 09:39:56,745 [INFO] Layer 6 - Training completed.
2025-09-09 09:39:56,746 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_6/state_dict.pt
2025-09-09 09:39:56,759 [INFO] Layer 6 - Test Acc: 0.8600 | F1(C0,C1,C2): 0.821, 0.747, 1.000
2025-09-09 09:39:56,759 [INFO] --- Processing Layer 7 ---
2025-09-09 09:39:57,027 [INFO] Layer 7 - Training completed.
2025-09-09 09:39:57,028 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_7/state_dict.pt
2025-09-09 09:39:57,042 [INFO] Layer 7 - Test Acc: 0.8933 | F1(C0,C1,C2): 0.821, 0.858, 0.995
2025-09-09 09:39:57,042 [INFO] --- Processing Layer 8 ---
2025-09-09 09:39:57,312 [INFO] Layer 8 - Training completed.
2025-09-09 09:39:57,313 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_8/state_dict.pt
2025-09-09 09:39:57,327 [INFO] Layer 8 - Test Acc: 0.9333 | F1(C0,C1,C2): 0.910, 0.904, 0.985
2025-09-09 09:39:57,327 [INFO] --- Processing Layer 9 ---
2025-09-09 09:39:57,600 [INFO] Layer 9 - Training completed.
2025-09-09 09:39:57,602 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_9/state_dict.pt
2025-09-09 09:39:57,615 [INFO] Layer 9 - Test Acc: 0.9467 | F1(C0,C1,C2): 0.925, 0.920, 0.995
2025-09-09 09:39:57,615 [INFO] --- Processing Layer 10 ---
2025-09-09 09:39:57,884 [INFO] Layer 10 - Training completed.
2025-09-09 09:39:57,885 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_10/state_dict.pt
2025-09-09 09:39:57,899 [INFO] Layer 10 - Test Acc: 0.9633 | F1(C0,C1,C2): 0.942, 0.947, 1.000
2025-09-09 09:39:57,899 [INFO] --- Processing Layer 11 ---
2025-09-09 09:39:58,172 [INFO] Layer 11 - Training completed.
2025-09-09 09:39:58,174 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_11/state_dict.pt
2025-09-09 09:39:58,189 [INFO] Layer 11 - Test Acc: 0.9200 | F1(C0,C1,C2): 0.864, 0.893, 1.000
2025-09-09 09:39:58,189 [INFO] --- Processing Layer 12 ---
2025-09-09 09:39:58,458 [INFO] Layer 12 - Training completed.
2025-09-09 09:39:58,459 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_12/state_dict.pt
2025-09-09 09:39:58,473 [INFO] Layer 12 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.990, 1.000
2025-09-09 09:39:58,474 [INFO] --- Processing Layer 13 ---
2025-09-09 09:39:58,743 [INFO] Layer 13 - Training completed.
2025-09-09 09:39:58,744 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_13/state_dict.pt
2025-09-09 09:39:58,758 [INFO] Layer 13 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.980, 1.000
2025-09-09 09:39:58,758 [INFO] --- Processing Layer 14 ---
2025-09-09 09:39:59,029 [INFO] Layer 14 - Training completed.
2025-09-09 09:39:59,030 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_14/state_dict.pt
2025-09-09 09:39:59,043 [INFO] Layer 14 - Test Acc: 0.9833 | F1(C0,C1,C2): 0.975, 0.975, 1.000
2025-09-09 09:39:59,043 [INFO] --- Processing Layer 15 ---
2025-09-09 09:39:59,313 [INFO] Layer 15 - Training completed.
2025-09-09 09:39:59,314 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_15/state_dict.pt
2025-09-09 09:39:59,328 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:39:59,328 [INFO] --- Processing Layer 16 ---
2025-09-09 09:39:59,604 [INFO] Layer 16 - Training completed.
2025-09-09 09:39:59,605 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_16/state_dict.pt
2025-09-09 09:39:59,619 [INFO] Layer 16 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:39:59,619 [INFO] --- Processing Layer 17 ---
2025-09-09 09:39:59,891 [INFO] Layer 17 - Training completed.
2025-09-09 09:39:59,893 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_17/state_dict.pt
2025-09-09 09:39:59,906 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:39:59,907 [INFO] --- Processing Layer 18 ---
2025-09-09 09:40:00,217 [INFO] Layer 18 - Training completed.
2025-09-09 09:40:00,218 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_18/state_dict.pt
2025-09-09 09:40:00,233 [INFO] Layer 18 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:40:00,233 [INFO] --- Processing Layer 19 ---
2025-09-09 09:40:00,523 [INFO] Layer 19 - Training completed.
2025-09-09 09:40:00,525 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_19/state_dict.pt
2025-09-09 09:40:00,539 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:40:00,539 [INFO] --- Processing Layer 20 ---
2025-09-09 09:40:00,814 [INFO] Layer 20 - Training completed.
2025-09-09 09:40:00,815 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_20/state_dict.pt
2025-09-09 09:40:00,829 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:40:00,829 [INFO] --- Processing Layer 21 ---
2025-09-09 09:40:01,105 [INFO] Layer 21 - Training completed.
2025-09-09 09:40:01,106 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_21/state_dict.pt
2025-09-09 09:40:01,119 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:40:01,119 [INFO] --- Processing Layer 22 ---
2025-09-09 09:40:01,393 [INFO] Layer 22 - Training completed.
2025-09-09 09:40:01,394 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_22/state_dict.pt
2025-09-09 09:40:01,407 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:40:01,408 [INFO] --- Processing Layer 23 ---
2025-09-09 09:40:01,680 [INFO] Layer 23 - Training completed.
2025-09-09 09:40:01,681 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_23/state_dict.pt
2025-09-09 09:40:01,695 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:40:01,695 [INFO] --- Processing Layer 24 ---
2025-09-09 09:40:01,970 [INFO] Layer 24 - Training completed.
2025-09-09 09:40:01,971 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_24/state_dict.pt
2025-09-09 09:40:01,985 [INFO] Layer 24 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:40:01,985 [INFO] --- Processing Layer 25 ---
2025-09-09 09:40:02,279 [INFO] Layer 25 - Training completed.
2025-09-09 09:40:02,280 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_25/state_dict.pt
2025-09-09 09:40:02,294 [INFO] Layer 25 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:40:02,294 [INFO] --- Processing Layer 26 ---
2025-09-09 09:40:02,566 [INFO] Layer 26 - Training completed.
2025-09-09 09:40:02,567 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_26/state_dict.pt
2025-09-09 09:40:02,581 [INFO] Layer 26 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:40:02,581 [INFO] --- Processing Layer 27 ---
2025-09-09 09:40:02,854 [INFO] Layer 27 - Training completed.
2025-09-09 09:40:02,855 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_27/state_dict.pt
2025-09-09 09:40:02,869 [INFO] Layer 27 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:40:02,869 [INFO] --- Processing Layer 28 ---
2025-09-09 09:40:03,149 [INFO] Layer 28 - Training completed.
2025-09-09 09:40:03,150 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_28/state_dict.pt
2025-09-09 09:40:03,165 [INFO] Layer 28 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:40:03,165 [INFO] --- Processing Layer 29 ---
2025-09-09 09:40:03,435 [INFO] Layer 29 - Training completed.
2025-09-09 09:40:03,437 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_29/state_dict.pt
2025-09-09 09:40:03,450 [INFO] Layer 29 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:40:03,450 [INFO] --- Processing Layer 30 ---
2025-09-09 09:40:03,723 [INFO] Layer 30 - Training completed.
2025-09-09 09:40:03,724 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_30/state_dict.pt
2025-09-09 09:40:03,738 [INFO] Layer 30 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:40:03,738 [INFO] --- Processing Layer 31 ---
2025-09-09 09:40:04,011 [INFO] Layer 31 - Training completed.
2025-09-09 09:40:04,013 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_31/state_dict.pt
2025-09-09 09:40:04,027 [INFO] Layer 31 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:40:04,027 [INFO] --- Processing Layer 32 ---
2025-09-09 09:40:04,302 [INFO] Layer 32 - Training completed.
2025-09-09 09:40:04,303 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_44/layer_32/state_dict.pt
2025-09-09 09:40:04,318 [INFO] Layer 32 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:40:04,318 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:40:04,318 [INFO] --- Generating OOD Datasets for Run 3 ---
2025-09-09 09:40:04,325 [WARNING] [WARN] OOD Class-2 (2-digit): Got 1/100
2025-09-09 09:40:04,327 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:40:04,370 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:40:08,805 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:40:08,808 [INFO] [OOD 1d] Layer 1: acc=0.3733
2025-09-09 09:40:08,810 [INFO] [OOD 1d] Layer 2: acc=0.3967
2025-09-09 09:40:08,811 [INFO] [OOD 1d] Layer 3: acc=0.5000
2025-09-09 09:40:08,813 [INFO] [OOD 1d] Layer 4: acc=0.4300
2025-09-09 09:40:08,814 [INFO] [OOD 1d] Layer 5: acc=0.3533
2025-09-09 09:40:08,816 [INFO] [OOD 1d] Layer 6: acc=0.4233
2025-09-09 09:40:08,818 [INFO] [OOD 1d] Layer 7: acc=0.5300
2025-09-09 09:40:08,819 [INFO] [OOD 1d] Layer 8: acc=0.5233
2025-09-09 09:40:08,821 [INFO] [OOD 1d] Layer 9: acc=0.5333
2025-09-09 09:40:08,823 [INFO] [OOD 1d] Layer 10: acc=0.5867
2025-09-09 09:40:08,825 [INFO] [OOD 1d] Layer 11: acc=0.8100
2025-09-09 09:40:08,826 [INFO] [OOD 1d] Layer 12: acc=0.8900
2025-09-09 09:40:08,828 [INFO] [OOD 1d] Layer 13: acc=0.6667
2025-09-09 09:40:08,830 [INFO] [OOD 1d] Layer 14: acc=0.8233
2025-09-09 09:40:08,831 [INFO] [OOD 1d] Layer 15: acc=0.9300
2025-09-09 09:40:08,833 [INFO] [OOD 1d] Layer 16: acc=1.0000
2025-09-09 09:40:08,834 [INFO] [OOD 1d] Layer 17: acc=1.0000
2025-09-09 09:40:08,836 [INFO] [OOD 1d] Layer 18: acc=1.0000
2025-09-09 09:40:08,838 [INFO] [OOD 1d] Layer 19: acc=1.0000
2025-09-09 09:40:08,839 [INFO] [OOD 1d] Layer 20: acc=0.9667
2025-09-09 09:40:08,841 [INFO] [OOD 1d] Layer 21: acc=0.9900
2025-09-09 09:40:08,842 [INFO] [OOD 1d] Layer 22: acc=1.0000
2025-09-09 09:40:08,844 [INFO] [OOD 1d] Layer 23: acc=0.9733
2025-09-09 09:40:08,846 [INFO] [OOD 1d] Layer 24: acc=0.9900
2025-09-09 09:40:08,847 [INFO] [OOD 1d] Layer 25: acc=0.9600
2025-09-09 09:40:08,849 [INFO] [OOD 1d] Layer 26: acc=0.9867
2025-09-09 09:40:08,851 [INFO] [OOD 1d] Layer 27: acc=0.9867
2025-09-09 09:40:08,852 [INFO] [OOD 1d] Layer 28: acc=0.9800
2025-09-09 09:40:08,854 [INFO] [OOD 1d] Layer 29: acc=0.9533
2025-09-09 09:40:08,855 [INFO] [OOD 1d] Layer 30: acc=0.9700
2025-09-09 09:40:08,857 [INFO] [OOD 1d] Layer 31: acc=0.9700
2025-09-09 09:40:08,859 [INFO] [OOD 1d] Layer 32: acc=0.9700
2025-09-09 09:40:08,859 [INFO] [OOD_2d_ALL] Extracting activations for 201 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:40:12,750 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:40:12,752 [INFO] [OOD 2d] Layer 1: acc=0.6318
2025-09-09 09:40:12,753 [INFO] [OOD 2d] Layer 2: acc=0.7413
2025-09-09 09:40:12,755 [INFO] [OOD 2d] Layer 3: acc=0.7313
2025-09-09 09:40:12,756 [INFO] [OOD 2d] Layer 4: acc=0.8607
2025-09-09 09:40:12,757 [INFO] [OOD 2d] Layer 5: acc=0.8806
2025-09-09 09:40:12,758 [INFO] [OOD 2d] Layer 6: acc=0.8209
2025-09-09 09:40:12,760 [INFO] [OOD 2d] Layer 7: acc=0.8706
2025-09-09 09:40:12,761 [INFO] [OOD 2d] Layer 8: acc=0.9204
2025-09-09 09:40:12,762 [INFO] [OOD 2d] Layer 9: acc=0.9104
2025-09-09 09:40:12,764 [INFO] [OOD 2d] Layer 10: acc=0.9204
2025-09-09 09:40:12,765 [INFO] [OOD 2d] Layer 11: acc=0.8507
2025-09-09 09:40:12,766 [INFO] [OOD 2d] Layer 12: acc=0.9751
2025-09-09 09:40:12,767 [INFO] [OOD 2d] Layer 13: acc=0.9552
2025-09-09 09:40:12,769 [INFO] [OOD 2d] Layer 14: acc=0.9552
2025-09-09 09:40:12,770 [INFO] [OOD 2d] Layer 15: acc=0.9950
2025-09-09 09:40:12,771 [INFO] [OOD 2d] Layer 16: acc=1.0000
2025-09-09 09:40:12,773 [INFO] [OOD 2d] Layer 17: acc=1.0000
2025-09-09 09:40:12,774 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:40:12,775 [INFO] [OOD 2d] Layer 19: acc=1.0000
2025-09-09 09:40:12,777 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:40:12,778 [INFO] [OOD 2d] Layer 21: acc=1.0000
2025-09-09 09:40:12,779 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:40:12,780 [INFO] [OOD 2d] Layer 23: acc=1.0000
2025-09-09 09:40:12,782 [INFO] [OOD 2d] Layer 24: acc=1.0000
2025-09-09 09:40:12,783 [INFO] [OOD 2d] Layer 25: acc=1.0000
2025-09-09 09:40:12,784 [INFO] [OOD 2d] Layer 26: acc=1.0000
2025-09-09 09:40:12,785 [INFO] [OOD 2d] Layer 27: acc=1.0000
2025-09-09 09:40:12,787 [INFO] [OOD 2d] Layer 28: acc=1.0000
2025-09-09 09:40:12,788 [INFO] [OOD 2d] Layer 29: acc=0.9950
2025-09-09 09:40:12,789 [INFO] [OOD 2d] Layer 30: acc=1.0000
2025-09-09 09:40:12,790 [INFO] [OOD 2d] Layer 31: acc=0.9950
2025-09-09 09:40:12,792 [INFO] [OOD 2d] Layer 32: acc=1.0000
2025-09-09 09:40:12,792 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:40:18,974 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:40:18,977 [INFO] [OOD 3d] Layer 1: acc=0.3600
2025-09-09 09:40:18,978 [INFO] [OOD 3d] Layer 2: acc=0.3333
2025-09-09 09:40:18,980 [INFO] [OOD 3d] Layer 3: acc=0.4933
2025-09-09 09:40:18,981 [INFO] [OOD 3d] Layer 4: acc=0.7733
2025-09-09 09:40:18,983 [INFO] [OOD 3d] Layer 5: acc=0.7367
2025-09-09 09:40:18,985 [INFO] [OOD 3d] Layer 6: acc=0.6733
2025-09-09 09:40:18,986 [INFO] [OOD 3d] Layer 7: acc=0.7033
2025-09-09 09:40:18,988 [INFO] [OOD 3d] Layer 8: acc=0.7467
2025-09-09 09:40:18,989 [INFO] [OOD 3d] Layer 9: acc=0.7533
2025-09-09 09:40:18,991 [INFO] [OOD 3d] Layer 10: acc=0.8700
2025-09-09 09:40:18,993 [INFO] [OOD 3d] Layer 11: acc=0.9633
2025-09-09 09:40:18,994 [INFO] [OOD 3d] Layer 12: acc=0.9567
2025-09-09 09:40:18,996 [INFO] [OOD 3d] Layer 13: acc=0.9567
2025-09-09 09:40:18,998 [INFO] [OOD 3d] Layer 14: acc=0.9200
2025-09-09 09:40:18,999 [INFO] [OOD 3d] Layer 15: acc=1.0000
2025-09-09 09:40:19,001 [INFO] [OOD 3d] Layer 16: acc=1.0000
2025-09-09 09:40:19,002 [INFO] [OOD 3d] Layer 17: acc=1.0000
2025-09-09 09:40:19,004 [INFO] [OOD 3d] Layer 18: acc=1.0000
2025-09-09 09:40:19,006 [INFO] [OOD 3d] Layer 19: acc=0.9967
2025-09-09 09:40:19,007 [INFO] [OOD 3d] Layer 20: acc=0.9967
2025-09-09 09:40:19,009 [INFO] [OOD 3d] Layer 21: acc=1.0000
2025-09-09 09:40:19,010 [INFO] [OOD 3d] Layer 22: acc=0.9967
2025-09-09 09:40:19,012 [INFO] [OOD 3d] Layer 23: acc=0.9933
2025-09-09 09:40:19,013 [INFO] [OOD 3d] Layer 24: acc=0.9833
2025-09-09 09:40:19,015 [INFO] [OOD 3d] Layer 25: acc=0.9367
2025-09-09 09:40:19,017 [INFO] [OOD 3d] Layer 26: acc=0.9133
2025-09-09 09:40:19,018 [INFO] [OOD 3d] Layer 27: acc=0.9567
2025-09-09 09:40:19,020 [INFO] [OOD 3d] Layer 28: acc=0.9800
2025-09-09 09:40:19,021 [INFO] [OOD 3d] Layer 29: acc=0.9967
2025-09-09 09:40:19,023 [INFO] [OOD 3d] Layer 30: acc=0.9667
2025-09-09 09:40:19,024 [INFO] [OOD 3d] Layer 31: acc=0.9633
2025-09-09 09:40:19,026 [INFO] [OOD 3d] Layer 32: acc=0.9667
2025-09-09 09:40:19,026 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:40:26,408 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:40:26,411 [INFO] [OOD 4d] Layer 1: acc=0.3733
2025-09-09 09:40:26,413 [INFO] [OOD 4d] Layer 2: acc=0.3333
2025-09-09 09:40:26,414 [INFO] [OOD 4d] Layer 3: acc=0.4567
2025-09-09 09:40:26,416 [INFO] [OOD 4d] Layer 4: acc=0.7267
2025-09-09 09:40:26,418 [INFO] [OOD 4d] Layer 5: acc=0.5133
2025-09-09 09:40:26,419 [INFO] [OOD 4d] Layer 6: acc=0.5900
2025-09-09 09:40:26,421 [INFO] [OOD 4d] Layer 7: acc=0.7167
2025-09-09 09:40:26,422 [INFO] [OOD 4d] Layer 8: acc=0.7267
2025-09-09 09:40:26,424 [INFO] [OOD 4d] Layer 9: acc=0.7500
2025-09-09 09:40:26,426 [INFO] [OOD 4d] Layer 10: acc=0.8767
2025-09-09 09:40:26,427 [INFO] [OOD 4d] Layer 11: acc=0.9367
2025-09-09 09:40:26,429 [INFO] [OOD 4d] Layer 12: acc=0.8733
2025-09-09 09:40:26,430 [INFO] [OOD 4d] Layer 13: acc=0.8367
2025-09-09 09:40:26,432 [INFO] [OOD 4d] Layer 14: acc=0.8767
2025-09-09 09:40:26,433 [INFO] [OOD 4d] Layer 15: acc=0.9933
2025-09-09 09:40:26,435 [INFO] [OOD 4d] Layer 16: acc=0.9967
2025-09-09 09:40:26,437 [INFO] [OOD 4d] Layer 17: acc=1.0000
2025-09-09 09:40:26,438 [INFO] [OOD 4d] Layer 18: acc=1.0000
2025-09-09 09:40:26,440 [INFO] [OOD 4d] Layer 19: acc=0.9933
2025-09-09 09:40:26,441 [INFO] [OOD 4d] Layer 20: acc=0.9933
2025-09-09 09:40:26,443 [INFO] [OOD 4d] Layer 21: acc=0.9867
2025-09-09 09:40:26,445 [INFO] [OOD 4d] Layer 22: acc=0.9700
2025-09-09 09:40:26,446 [INFO] [OOD 4d] Layer 23: acc=0.9667
2025-09-09 09:40:26,448 [INFO] [OOD 4d] Layer 24: acc=0.9633
2025-09-09 09:40:26,449 [INFO] [OOD 4d] Layer 25: acc=0.9467
2025-09-09 09:40:26,451 [INFO] [OOD 4d] Layer 26: acc=0.9767
2025-09-09 09:40:26,453 [INFO] [OOD 4d] Layer 27: acc=0.9833
2025-09-09 09:40:26,454 [INFO] [OOD 4d] Layer 28: acc=0.9867
2025-09-09 09:40:26,455 [INFO] [OOD 4d] Layer 29: acc=1.0000
2025-09-09 09:40:26,457 [INFO] [OOD 4d] Layer 30: acc=0.9467
2025-09-09 09:40:26,459 [INFO] [OOD 4d] Layer 31: acc=0.9433
2025-09-09 09:40:26,461 [INFO] [OOD 4d] Layer 32: acc=0.9333
2025-09-09 09:40:26,461 [INFO] ==================== RUN 4/5 (Seed: 45) ====================
2025-09-09 09:40:26,462 [INFO] Using device: cuda:0
2025-09-09 09:40:26,465 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:40:26,465 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:40:26,467 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:40:26,468 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:40:26,469 [INFO] [TRAIN_COMM_3WAY_Run4] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:40:55,183 [INFO] [TRAIN_COMM_3WAY_Run4] Finished extracting activations.
2025-09-09 09:40:55,186 [INFO] Per-layer classification reports -> ./outputs/Mistral/run_seed_45/probe_3way_comm_Mistral_seed_45_20250909_094055.txt
2025-09-09 09:40:55,187 [INFO] --- Starting Probe Training Loop for layers 1..32 ---
2025-09-09 09:40:55,187 [INFO] --- Processing Layer 1 ---
2025-09-09 09:40:55,462 [INFO] Layer 1 - Training completed.
2025-09-09 09:40:55,463 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_1/state_dict.pt
2025-09-09 09:40:55,478 [INFO] Layer 1 - Test Acc: 0.3367 | F1(C0,C1,C2): 0.508, 0.019, 0.000
2025-09-09 09:40:55,479 [INFO] --- Processing Layer 2 ---
2025-09-09 09:40:55,748 [INFO] Layer 2 - Training completed.
2025-09-09 09:40:55,749 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_2/state_dict.pt
2025-09-09 09:40:55,763 [INFO] Layer 2 - Test Acc: 0.4567 | F1(C0,C1,C2): 0.597, 0.324, 0.282
2025-09-09 09:40:55,763 [INFO] --- Processing Layer 3 ---
2025-09-09 09:40:56,039 [INFO] Layer 3 - Training completed.
2025-09-09 09:40:56,041 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_3/state_dict.pt
2025-09-09 09:40:56,054 [INFO] Layer 3 - Test Acc: 0.7867 | F1(C0,C1,C2): 0.828, 0.802, 0.742
2025-09-09 09:40:56,055 [INFO] --- Processing Layer 4 ---
2025-09-09 09:40:56,325 [INFO] Layer 4 - Training completed.
2025-09-09 09:40:56,326 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_4/state_dict.pt
2025-09-09 09:40:56,340 [INFO] Layer 4 - Test Acc: 0.9233 | F1(C0,C1,C2): 0.901, 0.885, 0.980
2025-09-09 09:40:56,340 [INFO] --- Processing Layer 5 ---
2025-09-09 09:40:56,610 [INFO] Layer 5 - Training completed.
2025-09-09 09:40:56,611 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_5/state_dict.pt
2025-09-09 09:40:56,626 [INFO] Layer 5 - Test Acc: 0.8700 | F1(C0,C1,C2): 0.825, 0.784, 0.995
2025-09-09 09:40:56,626 [INFO] --- Processing Layer 6 ---
2025-09-09 09:40:56,898 [INFO] Layer 6 - Training completed.
2025-09-09 09:40:56,899 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_6/state_dict.pt
2025-09-09 09:40:56,913 [INFO] Layer 6 - Test Acc: 0.9233 | F1(C0,C1,C2): 0.884, 0.886, 1.000
2025-09-09 09:40:56,913 [INFO] --- Processing Layer 7 ---
2025-09-09 09:40:57,182 [INFO] Layer 7 - Training completed.
2025-09-09 09:40:57,183 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_7/state_dict.pt
2025-09-09 09:40:57,197 [INFO] Layer 7 - Test Acc: 0.8967 | F1(C0,C1,C2): 0.853, 0.836, 1.000
2025-09-09 09:40:57,197 [INFO] --- Processing Layer 8 ---
2025-09-09 09:40:57,463 [INFO] Layer 8 - Training completed.
2025-09-09 09:40:57,464 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_8/state_dict.pt
2025-09-09 09:40:57,478 [INFO] Layer 8 - Test Acc: 0.8700 | F1(C0,C1,C2): 0.834, 0.764, 1.000
2025-09-09 09:40:57,478 [INFO] --- Processing Layer 9 ---
2025-09-09 09:40:57,750 [INFO] Layer 9 - Training completed.
2025-09-09 09:40:57,751 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_9/state_dict.pt
2025-09-09 09:40:57,765 [INFO] Layer 9 - Test Acc: 0.9667 | F1(C0,C1,C2): 0.950, 0.949, 1.000
2025-09-09 09:40:57,765 [INFO] --- Processing Layer 10 ---
2025-09-09 09:40:58,037 [INFO] Layer 10 - Training completed.
2025-09-09 09:40:58,038 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_10/state_dict.pt
2025-09-09 09:40:58,052 [INFO] Layer 10 - Test Acc: 0.9633 | F1(C0,C1,C2): 0.942, 0.948, 1.000
2025-09-09 09:40:58,053 [INFO] --- Processing Layer 11 ---
2025-09-09 09:40:58,321 [INFO] Layer 11 - Training completed.
2025-09-09 09:40:58,322 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_11/state_dict.pt
2025-09-09 09:40:58,337 [INFO] Layer 11 - Test Acc: 0.9367 | F1(C0,C1,C2): 0.895, 0.913, 1.000
2025-09-09 09:40:58,337 [INFO] --- Processing Layer 12 ---
2025-09-09 09:40:58,601 [INFO] Layer 12 - Training completed.
2025-09-09 09:40:58,602 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_12/state_dict.pt
2025-09-09 09:40:58,615 [INFO] Layer 12 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:40:58,615 [INFO] --- Processing Layer 13 ---
2025-09-09 09:40:58,878 [INFO] Layer 13 - Training completed.
2025-09-09 09:40:58,879 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_13/state_dict.pt
2025-09-09 09:40:58,893 [INFO] Layer 13 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:40:58,893 [INFO] --- Processing Layer 14 ---
2025-09-09 09:40:59,160 [INFO] Layer 14 - Training completed.
2025-09-09 09:40:59,161 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_14/state_dict.pt
2025-09-09 09:40:59,175 [INFO] Layer 14 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:40:59,175 [INFO] --- Processing Layer 15 ---
2025-09-09 09:40:59,460 [INFO] Layer 15 - Training completed.
2025-09-09 09:40:59,462 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_15/state_dict.pt
2025-09-09 09:40:59,482 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:40:59,483 [INFO] --- Processing Layer 16 ---
2025-09-09 09:40:59,780 [INFO] Layer 16 - Training completed.
2025-09-09 09:40:59,781 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_16/state_dict.pt
2025-09-09 09:40:59,797 [INFO] Layer 16 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:40:59,797 [INFO] --- Processing Layer 17 ---
2025-09-09 09:41:00,067 [INFO] Layer 17 - Training completed.
2025-09-09 09:41:00,069 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_17/state_dict.pt
2025-09-09 09:41:00,082 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:41:00,082 [INFO] --- Processing Layer 18 ---
2025-09-09 09:41:00,377 [INFO] Layer 18 - Training completed.
2025-09-09 09:41:00,378 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_18/state_dict.pt
2025-09-09 09:41:00,391 [INFO] Layer 18 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:41:00,392 [INFO] --- Processing Layer 19 ---
2025-09-09 09:41:00,658 [INFO] Layer 19 - Training completed.
2025-09-09 09:41:00,659 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_19/state_dict.pt
2025-09-09 09:41:00,673 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:41:00,673 [INFO] --- Processing Layer 20 ---
2025-09-09 09:41:00,942 [INFO] Layer 20 - Training completed.
2025-09-09 09:41:00,943 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_20/state_dict.pt
2025-09-09 09:41:00,957 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:41:00,957 [INFO] --- Processing Layer 21 ---
2025-09-09 09:41:01,244 [INFO] Layer 21 - Training completed.
2025-09-09 09:41:01,245 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_21/state_dict.pt
2025-09-09 09:41:01,260 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:41:01,260 [INFO] --- Processing Layer 22 ---
2025-09-09 09:41:01,561 [INFO] Layer 22 - Training completed.
2025-09-09 09:41:01,562 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_22/state_dict.pt
2025-09-09 09:41:01,575 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:41:01,576 [INFO] --- Processing Layer 23 ---
2025-09-09 09:41:01,859 [INFO] Layer 23 - Training completed.
2025-09-09 09:41:01,861 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_23/state_dict.pt
2025-09-09 09:41:01,874 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:41:01,875 [INFO] --- Processing Layer 24 ---
2025-09-09 09:41:02,145 [INFO] Layer 24 - Training completed.
2025-09-09 09:41:02,146 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_24/state_dict.pt
2025-09-09 09:41:02,160 [INFO] Layer 24 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:41:02,160 [INFO] --- Processing Layer 25 ---
2025-09-09 09:41:02,435 [INFO] Layer 25 - Training completed.
2025-09-09 09:41:02,436 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_25/state_dict.pt
2025-09-09 09:41:02,450 [INFO] Layer 25 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:41:02,450 [INFO] --- Processing Layer 26 ---
2025-09-09 09:41:02,726 [INFO] Layer 26 - Training completed.
2025-09-09 09:41:02,727 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_26/state_dict.pt
2025-09-09 09:41:02,741 [INFO] Layer 26 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:41:02,741 [INFO] --- Processing Layer 27 ---
2025-09-09 09:41:03,016 [INFO] Layer 27 - Training completed.
2025-09-09 09:41:03,018 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_27/state_dict.pt
2025-09-09 09:41:03,032 [INFO] Layer 27 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:41:03,033 [INFO] --- Processing Layer 28 ---
2025-09-09 09:41:03,333 [INFO] Layer 28 - Training completed.
2025-09-09 09:41:03,334 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_28/state_dict.pt
2025-09-09 09:41:03,348 [INFO] Layer 28 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:41:03,349 [INFO] --- Processing Layer 29 ---
2025-09-09 09:41:03,666 [INFO] Layer 29 - Training completed.
2025-09-09 09:41:03,667 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_29/state_dict.pt
2025-09-09 09:41:03,681 [INFO] Layer 29 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:41:03,681 [INFO] --- Processing Layer 30 ---
2025-09-09 09:41:03,949 [INFO] Layer 30 - Training completed.
2025-09-09 09:41:03,950 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_30/state_dict.pt
2025-09-09 09:41:03,965 [INFO] Layer 30 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:41:03,966 [INFO] --- Processing Layer 31 ---
2025-09-09 09:41:04,230 [INFO] Layer 31 - Training completed.
2025-09-09 09:41:04,231 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_31/state_dict.pt
2025-09-09 09:41:04,246 [INFO] Layer 31 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:41:04,247 [INFO] --- Processing Layer 32 ---
2025-09-09 09:41:04,514 [INFO] Layer 32 - Training completed.
2025-09-09 09:41:04,515 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_45/layer_32/state_dict.pt
2025-09-09 09:41:04,529 [INFO] Layer 32 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:41:04,529 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:41:04,530 [INFO] --- Generating OOD Datasets for Run 4 ---
2025-09-09 09:41:04,535 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:41:04,537 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:41:04,580 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:41:09,025 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:41:09,029 [INFO] [OOD 1d] Layer 1: acc=0.3333
2025-09-09 09:41:09,030 [INFO] [OOD 1d] Layer 2: acc=0.3333
2025-09-09 09:41:09,032 [INFO] [OOD 1d] Layer 3: acc=0.5300
2025-09-09 09:41:09,034 [INFO] [OOD 1d] Layer 4: acc=0.3333
2025-09-09 09:41:09,035 [INFO] [OOD 1d] Layer 5: acc=0.3367
2025-09-09 09:41:09,037 [INFO] [OOD 1d] Layer 6: acc=0.4833
2025-09-09 09:41:09,038 [INFO] [OOD 1d] Layer 7: acc=0.5033
2025-09-09 09:41:09,040 [INFO] [OOD 1d] Layer 8: acc=0.5367
2025-09-09 09:41:09,042 [INFO] [OOD 1d] Layer 9: acc=0.5500
2025-09-09 09:41:09,043 [INFO] [OOD 1d] Layer 10: acc=0.6567
2025-09-09 09:41:09,045 [INFO] [OOD 1d] Layer 11: acc=0.7733
2025-09-09 09:41:09,046 [INFO] [OOD 1d] Layer 12: acc=0.9433
2025-09-09 09:41:09,048 [INFO] [OOD 1d] Layer 13: acc=0.7633
2025-09-09 09:41:09,050 [INFO] [OOD 1d] Layer 14: acc=0.8833
2025-09-09 09:41:09,051 [INFO] [OOD 1d] Layer 15: acc=0.9567
2025-09-09 09:41:09,053 [INFO] [OOD 1d] Layer 16: acc=1.0000
2025-09-09 09:41:09,054 [INFO] [OOD 1d] Layer 17: acc=1.0000
2025-09-09 09:41:09,056 [INFO] [OOD 1d] Layer 18: acc=1.0000
2025-09-09 09:41:09,058 [INFO] [OOD 1d] Layer 19: acc=1.0000
2025-09-09 09:41:09,059 [INFO] [OOD 1d] Layer 20: acc=0.9433
2025-09-09 09:41:09,061 [INFO] [OOD 1d] Layer 21: acc=1.0000
2025-09-09 09:41:09,062 [INFO] [OOD 1d] Layer 22: acc=0.9967
2025-09-09 09:41:09,064 [INFO] [OOD 1d] Layer 23: acc=0.9633
2025-09-09 09:41:09,065 [INFO] [OOD 1d] Layer 24: acc=1.0000
2025-09-09 09:41:09,067 [INFO] [OOD 1d] Layer 25: acc=0.9967
2025-09-09 09:41:09,069 [INFO] [OOD 1d] Layer 26: acc=0.9867
2025-09-09 09:41:09,070 [INFO] [OOD 1d] Layer 27: acc=0.9867
2025-09-09 09:41:09,072 [INFO] [OOD 1d] Layer 28: acc=0.9633
2025-09-09 09:41:09,074 [INFO] [OOD 1d] Layer 29: acc=0.9600
2025-09-09 09:41:09,075 [INFO] [OOD 1d] Layer 30: acc=0.9467
2025-09-09 09:41:09,077 [INFO] [OOD 1d] Layer 31: acc=0.9600
2025-09-09 09:41:09,078 [INFO] [OOD 1d] Layer 32: acc=0.9867
2025-09-09 09:41:09,079 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:41:12,956 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:41:12,958 [INFO] [OOD 2d] Layer 1: acc=0.5000
2025-09-09 09:41:12,960 [INFO] [OOD 2d] Layer 2: acc=0.5700
2025-09-09 09:41:12,961 [INFO] [OOD 2d] Layer 3: acc=0.7050
2025-09-09 09:41:12,962 [INFO] [OOD 2d] Layer 4: acc=0.8200
2025-09-09 09:41:12,964 [INFO] [OOD 2d] Layer 5: acc=0.8050
2025-09-09 09:41:12,965 [INFO] [OOD 2d] Layer 6: acc=0.8450
2025-09-09 09:41:12,966 [INFO] [OOD 2d] Layer 7: acc=0.8650
2025-09-09 09:41:12,967 [INFO] [OOD 2d] Layer 8: acc=0.8400
2025-09-09 09:41:12,969 [INFO] [OOD 2d] Layer 9: acc=0.9300
2025-09-09 09:41:12,970 [INFO] [OOD 2d] Layer 10: acc=0.9400
2025-09-09 09:41:12,971 [INFO] [OOD 2d] Layer 11: acc=0.8950
2025-09-09 09:41:12,973 [INFO] [OOD 2d] Layer 12: acc=0.9950
2025-09-09 09:41:12,974 [INFO] [OOD 2d] Layer 13: acc=0.9950
2025-09-09 09:41:12,975 [INFO] [OOD 2d] Layer 14: acc=0.9850
2025-09-09 09:41:12,977 [INFO] [OOD 2d] Layer 15: acc=0.9950
2025-09-09 09:41:12,978 [INFO] [OOD 2d] Layer 16: acc=1.0000
2025-09-09 09:41:12,979 [INFO] [OOD 2d] Layer 17: acc=1.0000
2025-09-09 09:41:12,981 [INFO] [OOD 2d] Layer 18: acc=1.0000
2025-09-09 09:41:12,982 [INFO] [OOD 2d] Layer 19: acc=1.0000
2025-09-09 09:41:12,983 [INFO] [OOD 2d] Layer 20: acc=1.0000
2025-09-09 09:41:12,985 [INFO] [OOD 2d] Layer 21: acc=1.0000
2025-09-09 09:41:12,986 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:41:12,987 [INFO] [OOD 2d] Layer 23: acc=1.0000
2025-09-09 09:41:12,989 [INFO] [OOD 2d] Layer 24: acc=1.0000
2025-09-09 09:41:12,990 [INFO] [OOD 2d] Layer 25: acc=1.0000
2025-09-09 09:41:12,991 [INFO] [OOD 2d] Layer 26: acc=1.0000
2025-09-09 09:41:12,992 [INFO] [OOD 2d] Layer 27: acc=1.0000
2025-09-09 09:41:12,994 [INFO] [OOD 2d] Layer 28: acc=1.0000
2025-09-09 09:41:12,995 [INFO] [OOD 2d] Layer 29: acc=1.0000
2025-09-09 09:41:12,996 [INFO] [OOD 2d] Layer 30: acc=1.0000
2025-09-09 09:41:12,998 [INFO] [OOD 2d] Layer 31: acc=1.0000
2025-09-09 09:41:12,999 [INFO] [OOD 2d] Layer 32: acc=1.0000
2025-09-09 09:41:12,999 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:41:19,179 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:41:19,182 [INFO] [OOD 3d] Layer 1: acc=0.3400
2025-09-09 09:41:19,183 [INFO] [OOD 3d] Layer 2: acc=0.3833
2025-09-09 09:41:19,185 [INFO] [OOD 3d] Layer 3: acc=0.4700
2025-09-09 09:41:19,187 [INFO] [OOD 3d] Layer 4: acc=0.6967
2025-09-09 09:41:19,189 [INFO] [OOD 3d] Layer 5: acc=0.6967
2025-09-09 09:41:19,190 [INFO] [OOD 3d] Layer 6: acc=0.7133
2025-09-09 09:41:19,192 [INFO] [OOD 3d] Layer 7: acc=0.6633
2025-09-09 09:41:19,194 [INFO] [OOD 3d] Layer 8: acc=0.6633
2025-09-09 09:41:19,195 [INFO] [OOD 3d] Layer 9: acc=0.7000
2025-09-09 09:41:19,197 [INFO] [OOD 3d] Layer 10: acc=0.8300
2025-09-09 09:41:19,199 [INFO] [OOD 3d] Layer 11: acc=0.9300
2025-09-09 09:41:19,201 [INFO] [OOD 3d] Layer 12: acc=0.8567
2025-09-09 09:41:19,202 [INFO] [OOD 3d] Layer 13: acc=0.8033
2025-09-09 09:41:19,204 [INFO] [OOD 3d] Layer 14: acc=0.8867
2025-09-09 09:41:19,205 [INFO] [OOD 3d] Layer 15: acc=0.9933
2025-09-09 09:41:19,207 [INFO] [OOD 3d] Layer 16: acc=1.0000
2025-09-09 09:41:19,209 [INFO] [OOD 3d] Layer 17: acc=0.9933
2025-09-09 09:41:19,210 [INFO] [OOD 3d] Layer 18: acc=0.9933
2025-09-09 09:41:19,212 [INFO] [OOD 3d] Layer 19: acc=0.9933
2025-09-09 09:41:19,213 [INFO] [OOD 3d] Layer 20: acc=0.9900
2025-09-09 09:41:19,215 [INFO] [OOD 3d] Layer 21: acc=0.9900
2025-09-09 09:41:19,217 [INFO] [OOD 3d] Layer 22: acc=0.9933
2025-09-09 09:41:19,218 [INFO] [OOD 3d] Layer 23: acc=0.9833
2025-09-09 09:41:19,220 [INFO] [OOD 3d] Layer 24: acc=0.9833
2025-09-09 09:41:19,222 [INFO] [OOD 3d] Layer 25: acc=0.9567
2025-09-09 09:41:19,223 [INFO] [OOD 3d] Layer 26: acc=0.9367
2025-09-09 09:41:19,225 [INFO] [OOD 3d] Layer 27: acc=0.9633
2025-09-09 09:41:19,226 [INFO] [OOD 3d] Layer 28: acc=0.9500
2025-09-09 09:41:19,228 [INFO] [OOD 3d] Layer 29: acc=0.9667
2025-09-09 09:41:19,230 [INFO] [OOD 3d] Layer 30: acc=0.9467
2025-09-09 09:41:19,231 [INFO] [OOD 3d] Layer 31: acc=0.9700
2025-09-09 09:41:19,233 [INFO] [OOD 3d] Layer 32: acc=0.9667
2025-09-09 09:41:19,233 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:41:26,633 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:41:26,636 [INFO] [OOD 4d] Layer 1: acc=0.3400
2025-09-09 09:41:26,638 [INFO] [OOD 4d] Layer 2: acc=0.3833
2025-09-09 09:41:26,640 [INFO] [OOD 4d] Layer 3: acc=0.4767
2025-09-09 09:41:26,642 [INFO] [OOD 4d] Layer 4: acc=0.6733
2025-09-09 09:41:26,643 [INFO] [OOD 4d] Layer 5: acc=0.6633
2025-09-09 09:41:26,645 [INFO] [OOD 4d] Layer 6: acc=0.7033
2025-09-09 09:41:26,646 [INFO] [OOD 4d] Layer 7: acc=0.6633
2025-09-09 09:41:26,648 [INFO] [OOD 4d] Layer 8: acc=0.6667
2025-09-09 09:41:26,650 [INFO] [OOD 4d] Layer 9: acc=0.6800
2025-09-09 09:41:26,651 [INFO] [OOD 4d] Layer 10: acc=0.8633
2025-09-09 09:41:26,653 [INFO] [OOD 4d] Layer 11: acc=0.9133
2025-09-09 09:41:26,654 [INFO] [OOD 4d] Layer 12: acc=0.7567
2025-09-09 09:41:26,656 [INFO] [OOD 4d] Layer 13: acc=0.6767
2025-09-09 09:41:26,657 [INFO] [OOD 4d] Layer 14: acc=0.8400
2025-09-09 09:41:26,659 [INFO] [OOD 4d] Layer 15: acc=0.9867
2025-09-09 09:41:26,661 [INFO] [OOD 4d] Layer 16: acc=0.9967
2025-09-09 09:41:26,662 [INFO] [OOD 4d] Layer 17: acc=0.9967
2025-09-09 09:41:26,664 [INFO] [OOD 4d] Layer 18: acc=0.9933
2025-09-09 09:41:26,666 [INFO] [OOD 4d] Layer 19: acc=0.9900
2025-09-09 09:41:26,667 [INFO] [OOD 4d] Layer 20: acc=0.9933
2025-09-09 09:41:26,669 [INFO] [OOD 4d] Layer 21: acc=0.9933
2025-09-09 09:41:26,670 [INFO] [OOD 4d] Layer 22: acc=0.9900
2025-09-09 09:41:26,672 [INFO] [OOD 4d] Layer 23: acc=0.9833
2025-09-09 09:41:26,674 [INFO] [OOD 4d] Layer 24: acc=0.9833
2025-09-09 09:41:26,675 [INFO] [OOD 4d] Layer 25: acc=0.9900
2025-09-09 09:41:26,677 [INFO] [OOD 4d] Layer 26: acc=0.9833
2025-09-09 09:41:26,679 [INFO] [OOD 4d] Layer 27: acc=0.9933
2025-09-09 09:41:26,680 [INFO] [OOD 4d] Layer 28: acc=0.9833
2025-09-09 09:41:26,682 [INFO] [OOD 4d] Layer 29: acc=0.9933
2025-09-09 09:41:26,683 [INFO] [OOD 4d] Layer 30: acc=0.9333
2025-09-09 09:41:26,685 [INFO] [OOD 4d] Layer 31: acc=0.9700
2025-09-09 09:41:26,686 [INFO] [OOD 4d] Layer 32: acc=0.9200
2025-09-09 09:41:26,687 [INFO] ==================== RUN 5/5 (Seed: 46) ====================
2025-09-09 09:41:26,688 [INFO] Using device: cuda:0
2025-09-09 09:41:26,691 [INFO] --- Generating 3-Way Commutativity Data ---
2025-09-09 09:41:26,691 [INFO] Target: 500 samples per class (a+b (a>b), b+a (a>b), a+a)
2025-09-09 09:41:26,694 [INFO] Generated final dataset with 1500 samples.
2025-09-09 09:41:26,694 [INFO] Final label distribution: {0: 500, 1: 500, 2: 500}
2025-09-09 09:41:26,695 [INFO] [TRAIN_COMM_3WAY_Run5] Extracting activations for 1500 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:41:55,277 [INFO] [TRAIN_COMM_3WAY_Run5] Finished extracting activations.
2025-09-09 09:41:55,314 [INFO] Per-layer classification reports -> ./outputs/Mistral/run_seed_46/probe_3way_comm_Mistral_seed_46_20250909_094155.txt
2025-09-09 09:41:55,315 [INFO] --- Starting Probe Training Loop for layers 1..32 ---
2025-09-09 09:41:55,315 [INFO] --- Processing Layer 1 ---
2025-09-09 09:41:55,586 [INFO] Layer 1 - Training completed.
2025-09-09 09:41:55,587 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_1/state_dict.pt
2025-09-09 09:41:55,601 [INFO] Layer 1 - Test Acc: 0.3767 | F1(C0,C1,C2): 0.340, 0.502, 0.055
2025-09-09 09:41:55,601 [INFO] --- Processing Layer 2 ---
2025-09-09 09:41:55,873 [INFO] Layer 2 - Training completed.
2025-09-09 09:41:55,874 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_2/state_dict.pt
2025-09-09 09:41:55,888 [INFO] Layer 2 - Test Acc: 0.4700 | F1(C0,C1,C2): 0.560, 0.556, 0.039
2025-09-09 09:41:55,888 [INFO] --- Processing Layer 3 ---
2025-09-09 09:41:56,163 [INFO] Layer 3 - Training completed.
2025-09-09 09:41:56,165 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_3/state_dict.pt
2025-09-09 09:41:56,178 [INFO] Layer 3 - Test Acc: 0.6500 | F1(C0,C1,C2): 0.597, 0.687, 0.639
2025-09-09 09:41:56,179 [INFO] --- Processing Layer 4 ---
2025-09-09 09:41:56,449 [INFO] Layer 4 - Training completed.
2025-09-09 09:41:56,451 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_4/state_dict.pt
2025-09-09 09:41:56,465 [INFO] Layer 4 - Test Acc: 0.8600 | F1(C0,C1,C2): 0.796, 0.796, 0.985
2025-09-09 09:41:56,465 [INFO] --- Processing Layer 5 ---
2025-09-09 09:41:56,735 [INFO] Layer 5 - Training completed.
2025-09-09 09:41:56,737 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_5/state_dict.pt
2025-09-09 09:41:56,751 [INFO] Layer 5 - Test Acc: 0.9033 | F1(C0,C1,C2): 0.838, 0.873, 0.995
2025-09-09 09:41:56,751 [INFO] --- Processing Layer 6 ---
2025-09-09 09:41:57,022 [INFO] Layer 6 - Training completed.
2025-09-09 09:41:57,023 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_6/state_dict.pt
2025-09-09 09:41:57,037 [INFO] Layer 6 - Test Acc: 0.9033 | F1(C0,C1,C2): 0.854, 0.860, 0.995
2025-09-09 09:41:57,037 [INFO] --- Processing Layer 7 ---
2025-09-09 09:41:57,309 [INFO] Layer 7 - Training completed.
2025-09-09 09:41:57,310 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_7/state_dict.pt
2025-09-09 09:41:57,324 [INFO] Layer 7 - Test Acc: 0.8733 | F1(C0,C1,C2): 0.832, 0.786, 0.995
2025-09-09 09:41:57,325 [INFO] --- Processing Layer 8 ---
2025-09-09 09:41:57,597 [INFO] Layer 8 - Training completed.
2025-09-09 09:41:57,598 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_8/state_dict.pt
2025-09-09 09:41:57,613 [INFO] Layer 8 - Test Acc: 0.9100 | F1(C0,C1,C2): 0.846, 0.884, 0.995
2025-09-09 09:41:57,614 [INFO] --- Processing Layer 9 ---
2025-09-09 09:41:57,884 [INFO] Layer 9 - Training completed.
2025-09-09 09:41:57,885 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_9/state_dict.pt
2025-09-09 09:41:57,899 [INFO] Layer 9 - Test Acc: 0.9233 | F1(C0,C1,C2): 0.872, 0.900, 0.995
2025-09-09 09:41:57,899 [INFO] --- Processing Layer 10 ---
2025-09-09 09:41:58,169 [INFO] Layer 10 - Training completed.
2025-09-09 09:41:58,170 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_10/state_dict.pt
2025-09-09 09:41:58,184 [INFO] Layer 10 - Test Acc: 0.9700 | F1(C0,C1,C2): 0.954, 0.960, 0.995
2025-09-09 09:41:58,184 [INFO] --- Processing Layer 11 ---
2025-09-09 09:41:58,454 [INFO] Layer 11 - Training completed.
2025-09-09 09:41:58,455 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_11/state_dict.pt
2025-09-09 09:41:58,469 [INFO] Layer 11 - Test Acc: 0.9533 | F1(C0,C1,C2): 0.925, 0.939, 0.995
2025-09-09 09:41:58,469 [INFO] --- Processing Layer 12 ---
2025-09-09 09:41:58,741 [INFO] Layer 12 - Training completed.
2025-09-09 09:41:58,742 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_12/state_dict.pt
2025-09-09 09:41:58,756 [INFO] Layer 12 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 1.000, 0.995
2025-09-09 09:41:58,756 [INFO] --- Processing Layer 13 ---
2025-09-09 09:41:59,024 [INFO] Layer 13 - Training completed.
2025-09-09 09:41:59,025 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_13/state_dict.pt
2025-09-09 09:41:59,039 [INFO] Layer 13 - Test Acc: 0.9567 | F1(C0,C1,C2): 0.930, 0.943, 0.995
2025-09-09 09:41:59,039 [INFO] --- Processing Layer 14 ---
2025-09-09 09:41:59,311 [INFO] Layer 14 - Training completed.
2025-09-09 09:41:59,312 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_14/state_dict.pt
2025-09-09 09:41:59,326 [INFO] Layer 14 - Test Acc: 0.9933 | F1(C0,C1,C2): 0.990, 0.995, 0.995
2025-09-09 09:41:59,326 [INFO] --- Processing Layer 15 ---
2025-09-09 09:41:59,597 [INFO] Layer 15 - Training completed.
2025-09-09 09:41:59,598 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_15/state_dict.pt
2025-09-09 09:41:59,612 [INFO] Layer 15 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:41:59,612 [INFO] --- Processing Layer 16 ---
2025-09-09 09:41:59,883 [INFO] Layer 16 - Training completed.
2025-09-09 09:41:59,885 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_16/state_dict.pt
2025-09-09 09:41:59,899 [INFO] Layer 16 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:41:59,899 [INFO] --- Processing Layer 17 ---
2025-09-09 09:42:00,170 [INFO] Layer 17 - Training completed.
2025-09-09 09:42:00,171 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_17/state_dict.pt
2025-09-09 09:42:00,185 [INFO] Layer 17 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:42:00,185 [INFO] --- Processing Layer 18 ---
2025-09-09 09:42:00,457 [INFO] Layer 18 - Training completed.
2025-09-09 09:42:00,458 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_18/state_dict.pt
2025-09-09 09:42:00,472 [INFO] Layer 18 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:42:00,472 [INFO] --- Processing Layer 19 ---
2025-09-09 09:42:00,744 [INFO] Layer 19 - Training completed.
2025-09-09 09:42:00,745 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_19/state_dict.pt
2025-09-09 09:42:00,759 [INFO] Layer 19 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:42:00,759 [INFO] --- Processing Layer 20 ---
2025-09-09 09:42:01,032 [INFO] Layer 20 - Training completed.
2025-09-09 09:42:01,033 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_20/state_dict.pt
2025-09-09 09:42:01,047 [INFO] Layer 20 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:42:01,047 [INFO] --- Processing Layer 21 ---
2025-09-09 09:42:01,321 [INFO] Layer 21 - Training completed.
2025-09-09 09:42:01,323 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_21/state_dict.pt
2025-09-09 09:42:01,338 [INFO] Layer 21 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:42:01,338 [INFO] --- Processing Layer 22 ---
2025-09-09 09:42:01,612 [INFO] Layer 22 - Training completed.
2025-09-09 09:42:01,613 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_22/state_dict.pt
2025-09-09 09:42:01,627 [INFO] Layer 22 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:42:01,627 [INFO] --- Processing Layer 23 ---
2025-09-09 09:42:01,900 [INFO] Layer 23 - Training completed.
2025-09-09 09:42:01,901 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_23/state_dict.pt
2025-09-09 09:42:01,915 [INFO] Layer 23 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:42:01,915 [INFO] --- Processing Layer 24 ---
2025-09-09 09:42:02,183 [INFO] Layer 24 - Training completed.
2025-09-09 09:42:02,184 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_24/state_dict.pt
2025-09-09 09:42:02,198 [INFO] Layer 24 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:42:02,198 [INFO] --- Processing Layer 25 ---
2025-09-09 09:42:02,466 [INFO] Layer 25 - Training completed.
2025-09-09 09:42:02,467 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_25/state_dict.pt
2025-09-09 09:42:02,481 [INFO] Layer 25 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:42:02,481 [INFO] --- Processing Layer 26 ---
2025-09-09 09:42:02,751 [INFO] Layer 26 - Training completed.
2025-09-09 09:42:02,752 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_26/state_dict.pt
2025-09-09 09:42:02,766 [INFO] Layer 26 - Test Acc: 0.9967 | F1(C0,C1,C2): 0.995, 0.995, 1.000
2025-09-09 09:42:02,766 [INFO] --- Processing Layer 27 ---
2025-09-09 09:42:03,031 [INFO] Layer 27 - Training completed.
2025-09-09 09:42:03,033 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_27/state_dict.pt
2025-09-09 09:42:03,046 [INFO] Layer 27 - Test Acc: 1.0000 | F1(C0,C1,C2): 1.000, 1.000, 1.000
2025-09-09 09:42:03,047 [INFO] --- Processing Layer 28 ---
2025-09-09 09:42:03,313 [INFO] Layer 28 - Training completed.
2025-09-09 09:42:03,314 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_28/state_dict.pt
2025-09-09 09:42:03,327 [INFO] Layer 28 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:42:03,327 [INFO] --- Processing Layer 29 ---
2025-09-09 09:42:03,601 [INFO] Layer 29 - Training completed.
2025-09-09 09:42:03,602 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_29/state_dict.pt
2025-09-09 09:42:03,615 [INFO] Layer 29 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.980, 1.000
2025-09-09 09:42:03,616 [INFO] --- Processing Layer 30 ---
2025-09-09 09:42:03,880 [INFO] Layer 30 - Training completed.
2025-09-09 09:42:03,881 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_30/state_dict.pt
2025-09-09 09:42:03,895 [INFO] Layer 30 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.980, 1.000
2025-09-09 09:42:03,895 [INFO] --- Processing Layer 31 ---
2025-09-09 09:42:04,159 [INFO] Layer 31 - Training completed.
2025-09-09 09:42:04,161 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_31/state_dict.pt
2025-09-09 09:42:04,174 [INFO] Layer 31 - Test Acc: 0.9867 | F1(C0,C1,C2): 0.980, 0.980, 1.000
2025-09-09 09:42:04,174 [INFO] --- Processing Layer 32 ---
2025-09-09 09:42:04,441 [INFO] Layer 32 - Training completed.
2025-09-09 09:42:04,442 [INFO] Saved probe state_dict -> ./outputs/Mistral/run_seed_46/layer_32/state_dict.pt
2025-09-09 09:42:04,456 [INFO] Layer 32 - Test Acc: 0.9900 | F1(C0,C1,C2): 0.985, 0.985, 1.000
2025-09-09 09:42:04,457 [INFO] --- Probe Training Loop Finished ---
2025-09-09 09:42:04,457 [INFO] --- Generating OOD Datasets for Run 5 ---
2025-09-09 09:42:04,463 [WARNING] [WARN] OOD Class-2 (2-digit): Got 0/100
2025-09-09 09:42:04,464 [INFO] --- Evaluating Probes on OOD Datasets (one pass per dataset) ---
2025-09-09 09:42:04,505 [INFO] [OOD_1d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:42:08,956 [INFO] [OOD_1d_ALL] Finished extracting activations.
2025-09-09 09:42:08,959 [INFO] [OOD 1d] Layer 1: acc=0.4367
2025-09-09 09:42:08,961 [INFO] [OOD 1d] Layer 2: acc=0.3333
2025-09-09 09:42:08,962 [INFO] [OOD 1d] Layer 3: acc=0.4500
2025-09-09 09:42:08,964 [INFO] [OOD 1d] Layer 4: acc=0.3333
2025-09-09 09:42:08,966 [INFO] [OOD 1d] Layer 5: acc=0.3600
2025-09-09 09:42:08,967 [INFO] [OOD 1d] Layer 6: acc=0.4733
2025-09-09 09:42:08,969 [INFO] [OOD 1d] Layer 7: acc=0.4833
2025-09-09 09:42:08,971 [INFO] [OOD 1d] Layer 8: acc=0.5700
2025-09-09 09:42:08,972 [INFO] [OOD 1d] Layer 9: acc=0.5267
2025-09-09 09:42:08,974 [INFO] [OOD 1d] Layer 10: acc=0.6667
2025-09-09 09:42:08,975 [INFO] [OOD 1d] Layer 11: acc=0.9433
2025-09-09 09:42:08,977 [INFO] [OOD 1d] Layer 12: acc=0.8833
2025-09-09 09:42:08,979 [INFO] [OOD 1d] Layer 13: acc=0.7733
2025-09-09 09:42:08,981 [INFO] [OOD 1d] Layer 14: acc=0.7433
2025-09-09 09:42:08,982 [INFO] [OOD 1d] Layer 15: acc=0.9467
2025-09-09 09:42:08,984 [INFO] [OOD 1d] Layer 16: acc=1.0000
2025-09-09 09:42:08,985 [INFO] [OOD 1d] Layer 17: acc=1.0000
2025-09-09 09:42:08,987 [INFO] [OOD 1d] Layer 18: acc=1.0000
2025-09-09 09:42:08,989 [INFO] [OOD 1d] Layer 19: acc=1.0000
2025-09-09 09:42:08,990 [INFO] [OOD 1d] Layer 20: acc=1.0000
2025-09-09 09:42:08,992 [INFO] [OOD 1d] Layer 21: acc=1.0000
2025-09-09 09:42:08,994 [INFO] [OOD 1d] Layer 22: acc=1.0000
2025-09-09 09:42:08,995 [INFO] [OOD 1d] Layer 23: acc=0.9967
2025-09-09 09:42:08,997 [INFO] [OOD 1d] Layer 24: acc=1.0000
2025-09-09 09:42:08,999 [INFO] [OOD 1d] Layer 25: acc=0.9900
2025-09-09 09:42:09,001 [INFO] [OOD 1d] Layer 26: acc=0.9867
2025-09-09 09:42:09,002 [INFO] [OOD 1d] Layer 27: acc=1.0000
2025-09-09 09:42:09,004 [INFO] [OOD 1d] Layer 28: acc=0.9900
2025-09-09 09:42:09,005 [INFO] [OOD 1d] Layer 29: acc=0.9833
2025-09-09 09:42:09,007 [INFO] [OOD 1d] Layer 30: acc=0.9700
2025-09-09 09:42:09,009 [INFO] [OOD 1d] Layer 31: acc=0.9833
2025-09-09 09:42:09,010 [INFO] [OOD 1d] Layer 32: acc=0.9533
2025-09-09 09:42:09,011 [INFO] [OOD_2d_ALL] Extracting activations for 200 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:42:12,920 [INFO] [OOD_2d_ALL] Finished extracting activations.
2025-09-09 09:42:12,922 [INFO] [OOD 2d] Layer 1: acc=0.5750
2025-09-09 09:42:12,924 [INFO] [OOD 2d] Layer 2: acc=0.7250
2025-09-09 09:42:12,925 [INFO] [OOD 2d] Layer 3: acc=0.6400
2025-09-09 09:42:12,926 [INFO] [OOD 2d] Layer 4: acc=0.8550
2025-09-09 09:42:12,928 [INFO] [OOD 2d] Layer 5: acc=0.8400
2025-09-09 09:42:12,929 [INFO] [OOD 2d] Layer 6: acc=0.8500
2025-09-09 09:42:12,930 [INFO] [OOD 2d] Layer 7: acc=0.8300
2025-09-09 09:42:12,932 [INFO] [OOD 2d] Layer 8: acc=0.8750
2025-09-09 09:42:12,933 [INFO] [OOD 2d] Layer 9: acc=0.9050
2025-09-09 09:42:12,934 [INFO] [OOD 2d] Layer 10: acc=0.9600
2025-09-09 09:42:12,935 [INFO] [OOD 2d] Layer 11: acc=0.9400
2025-09-09 09:42:12,937 [INFO] [OOD 2d] Layer 12: acc=0.9850
2025-09-09 09:42:12,938 [INFO] [OOD 2d] Layer 13: acc=0.9400
2025-09-09 09:42:12,939 [INFO] [OOD 2d] Layer 14: acc=0.9700
2025-09-09 09:42:12,941 [INFO] [OOD 2d] Layer 15: acc=0.9950
2025-09-09 09:42:12,942 [INFO] [OOD 2d] Layer 16: acc=0.9950
2025-09-09 09:42:12,943 [INFO] [OOD 2d] Layer 17: acc=0.9950
2025-09-09 09:42:12,944 [INFO] [OOD 2d] Layer 18: acc=0.9950
2025-09-09 09:42:12,946 [INFO] [OOD 2d] Layer 19: acc=0.9900
2025-09-09 09:42:12,947 [INFO] [OOD 2d] Layer 20: acc=0.9950
2025-09-09 09:42:12,948 [INFO] [OOD 2d] Layer 21: acc=0.9900
2025-09-09 09:42:12,949 [INFO] [OOD 2d] Layer 22: acc=1.0000
2025-09-09 09:42:12,951 [INFO] [OOD 2d] Layer 23: acc=0.9900
2025-09-09 09:42:12,952 [INFO] [OOD 2d] Layer 24: acc=0.9950
2025-09-09 09:42:12,953 [INFO] [OOD 2d] Layer 25: acc=0.9850
2025-09-09 09:42:12,955 [INFO] [OOD 2d] Layer 26: acc=0.9950
2025-09-09 09:42:12,956 [INFO] [OOD 2d] Layer 27: acc=0.9850
2025-09-09 09:42:12,957 [INFO] [OOD 2d] Layer 28: acc=0.9750
2025-09-09 09:42:12,958 [INFO] [OOD 2d] Layer 29: acc=0.9700
2025-09-09 09:42:12,960 [INFO] [OOD 2d] Layer 30: acc=0.9800
2025-09-09 09:42:12,961 [INFO] [OOD 2d] Layer 31: acc=0.9950
2025-09-09 09:42:12,962 [INFO] [OOD 2d] Layer 32: acc=1.0000
2025-09-09 09:42:12,963 [INFO] [OOD_3d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:42:19,139 [INFO] [OOD_3d_ALL] Finished extracting activations.
2025-09-09 09:42:19,142 [INFO] [OOD 3d] Layer 1: acc=0.3400
2025-09-09 09:42:19,144 [INFO] [OOD 3d] Layer 2: acc=0.4167
2025-09-09 09:42:19,145 [INFO] [OOD 3d] Layer 3: acc=0.6067
2025-09-09 09:42:19,147 [INFO] [OOD 3d] Layer 4: acc=0.7633
2025-09-09 09:42:19,149 [INFO] [OOD 3d] Layer 5: acc=0.7533
2025-09-09 09:42:19,150 [INFO] [OOD 3d] Layer 6: acc=0.7100
2025-09-09 09:42:19,152 [INFO] [OOD 3d] Layer 7: acc=0.6600
2025-09-09 09:42:19,153 [INFO] [OOD 3d] Layer 8: acc=0.7367
2025-09-09 09:42:19,155 [INFO] [OOD 3d] Layer 9: acc=0.7800
2025-09-09 09:42:19,157 [INFO] [OOD 3d] Layer 10: acc=0.7800
2025-09-09 09:42:19,158 [INFO] [OOD 3d] Layer 11: acc=0.8667
2025-09-09 09:42:19,160 [INFO] [OOD 3d] Layer 12: acc=0.8533
2025-09-09 09:42:19,162 [INFO] [OOD 3d] Layer 13: acc=0.9633
2025-09-09 09:42:19,163 [INFO] [OOD 3d] Layer 14: acc=0.8933
2025-09-09 09:42:19,165 [INFO] [OOD 3d] Layer 15: acc=0.9967
2025-09-09 09:42:19,166 [INFO] [OOD 3d] Layer 16: acc=1.0000
2025-09-09 09:42:19,168 [INFO] [OOD 3d] Layer 17: acc=0.9967
2025-09-09 09:42:19,170 [INFO] [OOD 3d] Layer 18: acc=1.0000
2025-09-09 09:42:19,171 [INFO] [OOD 3d] Layer 19: acc=0.9967
2025-09-09 09:42:19,173 [INFO] [OOD 3d] Layer 20: acc=0.9933
2025-09-09 09:42:19,175 [INFO] [OOD 3d] Layer 21: acc=0.9933
2025-09-09 09:42:19,176 [INFO] [OOD 3d] Layer 22: acc=0.9933
2025-09-09 09:42:19,178 [INFO] [OOD 3d] Layer 23: acc=0.9933
2025-09-09 09:42:19,179 [INFO] [OOD 3d] Layer 24: acc=0.9900
2025-09-09 09:42:19,181 [INFO] [OOD 3d] Layer 25: acc=0.9367
2025-09-09 09:42:19,183 [INFO] [OOD 3d] Layer 26: acc=0.9200
2025-09-09 09:42:19,185 [INFO] [OOD 3d] Layer 27: acc=0.9600
2025-09-09 09:42:19,186 [INFO] [OOD 3d] Layer 28: acc=0.9667
2025-09-09 09:42:19,188 [INFO] [OOD 3d] Layer 29: acc=0.9833
2025-09-09 09:42:19,189 [INFO] [OOD 3d] Layer 30: acc=0.9633
2025-09-09 09:42:19,191 [INFO] [OOD 3d] Layer 31: acc=0.9400
2025-09-09 09:42:19,193 [INFO] [OOD 3d] Layer 32: acc=0.9467
2025-09-09 09:42:19,193 [INFO] [OOD_4d_ALL] Extracting activations for 300 prompts, layers=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
2025-09-09 09:42:26,548 [INFO] [OOD_4d_ALL] Finished extracting activations.
2025-09-09 09:42:26,551 [INFO] [OOD 4d] Layer 1: acc=0.3400
2025-09-09 09:42:26,553 [INFO] [OOD 4d] Layer 2: acc=0.3567
2025-09-09 09:42:26,555 [INFO] [OOD 4d] Layer 3: acc=0.5333
2025-09-09 09:42:26,556 [INFO] [OOD 4d] Layer 4: acc=0.6967
2025-09-09 09:42:26,558 [INFO] [OOD 4d] Layer 5: acc=0.5533
2025-09-09 09:42:26,560 [INFO] [OOD 4d] Layer 6: acc=0.6867
2025-09-09 09:42:26,562 [INFO] [OOD 4d] Layer 7: acc=0.5567
2025-09-09 09:42:26,563 [INFO] [OOD 4d] Layer 8: acc=0.7133
2025-09-09 09:42:26,565 [INFO] [OOD 4d] Layer 9: acc=0.7933
2025-09-09 09:42:26,567 [INFO] [OOD 4d] Layer 10: acc=0.7633
2025-09-09 09:42:26,568 [INFO] [OOD 4d] Layer 11: acc=0.8167
2025-09-09 09:42:26,570 [INFO] [OOD 4d] Layer 12: acc=0.6900
2025-09-09 09:42:26,572 [INFO] [OOD 4d] Layer 13: acc=0.8467
2025-09-09 09:42:26,573 [INFO] [OOD 4d] Layer 14: acc=0.7767
2025-09-09 09:42:26,575 [INFO] [OOD 4d] Layer 15: acc=1.0000
2025-09-09 09:42:26,577 [INFO] [OOD 4d] Layer 16: acc=0.9967
2025-09-09 09:42:26,578 [INFO] [OOD 4d] Layer 17: acc=1.0000
2025-09-09 09:42:26,580 [INFO] [OOD 4d] Layer 18: acc=1.0000
2025-09-09 09:42:26,581 [INFO] [OOD 4d] Layer 19: acc=1.0000
2025-09-09 09:42:26,583 [INFO] [OOD 4d] Layer 20: acc=1.0000
2025-09-09 09:42:26,585 [INFO] [OOD 4d] Layer 21: acc=0.9967
2025-09-09 09:42:26,586 [INFO] [OOD 4d] Layer 22: acc=0.9967
2025-09-09 09:42:26,588 [INFO] [OOD 4d] Layer 23: acc=0.9933
2025-09-09 09:42:26,590 [INFO] [OOD 4d] Layer 24: acc=0.9833
2025-09-09 09:42:26,591 [INFO] [OOD 4d] Layer 25: acc=0.9833
2025-09-09 09:42:26,593 [INFO] [OOD 4d] Layer 26: acc=0.9967
2025-09-09 09:42:26,595 [INFO] [OOD 4d] Layer 27: acc=1.0000
2025-09-09 09:42:26,597 [INFO] [OOD 4d] Layer 28: acc=0.9967
2025-09-09 09:42:26,598 [INFO] [OOD 4d] Layer 29: acc=0.9933
2025-09-09 09:42:26,600 [INFO] [OOD 4d] Layer 30: acc=0.9767
2025-09-09 09:42:26,602 [INFO] [OOD 4d] Layer 31: acc=0.9633
2025-09-09 09:42:26,603 [INFO] [OOD 4d] Layer 32: acc=0.9433
2025-09-09 09:42:26,604 [INFO] --- Generating Final Aggregated Plots (with CI) ---
2025-09-09 09:42:27,403 [INFO] Saved aggregated per-layer line chart (PDF) -> ./outputs/Mistral/AGG_probe_comm_generalisation_line_Mistral_20250909_094226.pdf
2025-09-09 09:42:27,609 [INFO] Saved aggregated mean-accuracy bar chart (PDF) -> ./outputs/Mistral/AGG_probe_comm_generalisation_bar_Mistral_20250909_094226.pdf
2025-09-09 09:42:27,609 [INFO] --- All Runs and Aggregated Plotting Finished (this model) ---
2025-09-09 09:42:27,609 [INFO] Unified output dir (this model): ./outputs/Mistral
